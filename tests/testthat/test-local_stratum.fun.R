if (interactive()) devtools::load_all()
if (FALSE) {
    dump("result")
    debugonce(Totholz.klass.stratum.fun)
}
testthat::context("stratum.fun.R")
test_that("stratum.fun", {
  result <- stratum.fun(list(Wa = c(1:5)), get_data("ecken.3"))

  reference <- structure(list(TNr = c(10083, 10174, 10176, 10197, 10451, 11551, 
12205, 12214, 12214, 12500, 12645, 1271, 12771, 1285, 12931, 
13026, 13046, 13185, 1331, 13438, 13725, 13842, 14001, 14014, 
14470, 14855, 155, 163, 1683, 1821, 1921, 1934, 2077, 2256, 2459, 
2519, 259, 2618, 2618, 2738, 280, 282, 2950, 2998, 3208, 3241, 
3329, 3515, 3739, 4026, 4061, 4111, 4321, 4506, 4575, 4710, 4722, 
4813, 5224, 5265, 5383, 5530, 5582, 5741, 5764, 6231, 6234, 6238, 
6287, 6858, 6864, 6881, 7059, 736, 7401, 7456, 754, 7540, 7799, 
7812, 7813, 7962, 806, 8060, 8122, 8151, 8205, 8313, 8414, 8560, 
8602, 8699, 8825, 8828, 8856, 8914, 9104, 9332, 9538, 9911), 
    ENr = c(1, 3, 3, 3, 2, 2, 4, 3, 4, 4, 3, 1, 4, 3, 1, 1, 2, 
    3, 3, 4, 2, 1, 1, 4, 3, 2, 2, 4, 4, 4, 2, 1, 2, 4, 3, 4, 
    3, 2, 3, 4, 3, 2, 1, 2, 3, 2, 2, 3, 4, 3, 4, 2, 3, 4, 2, 
    2, 3, 2, 2, 1, 4, 2, 2, 3, 4, 4, 3, 2, 3, 4, 1, 3, 3, 3, 
    4, 2, 2, 2, 2, 3, 1, 4, 4, 4, 3, 2, 1, 2, 4, 2, 1, 3, 2, 
    1, 3, 2, 2, 4, 1, 1), Wa = c(5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
    5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
    5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
    5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
    5, 5, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 4, 5, 5, 5, 5, 
    5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5)), class = "data.frame", row.names = c(NA, 
-100L))

  testthat::expect_equal(result, reference)
})
test_that("no match found", {
  result <- stratum.fun(list(Kreis = "kreis_is_a_numeric_id"), get_data("ecken.3"))

  reference <- structure(list(TNr = integer(0), 
                              ENr = integer(0), 
                              Kreis = integer(0)), 
                         .Names = c("TNr", "ENr", "Kreis"), 
                         row.names = integer(0), 
                         class = "data.frame")

  testthat::expect_equal(result, reference)
})
