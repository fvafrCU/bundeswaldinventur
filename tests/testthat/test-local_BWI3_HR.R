#' Testing of BWI3_HR_Funktionen_v3.r
#'
#' Tests the outputs of the functions of the file BWI3_HR_Funktionen_v3.r.
#'
#' @author Franziska Berg
#' @section Version: 15.09.2015
#' @name A Header for
NULL

if (interactive()) devtools::load_all()
if (FALSE) {
    dump("result")
}
context("Examples of existing scripts")


test_that("FVBN.bagrupp.akl.dkl.stratum.fun.2e", {
  FVBN <- FVBN.bagrupp.akl.dkl.stratum.fun.2e
  result <- FVBN(
    get_data("baeume.3")[1:10, TRUE], get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    list(A.ob = 200, A.b = 60),
    list(
      D.unt = 0, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(Wa = c(3, 5), Begehbar = 1)
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042091.28927, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1), .Names = c("Wa", "Begehbar")), nTE = 97L, 
    HBF = 902724.87, se.HBF = 23749.5302613181, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = c("1-60", "61-120", "121-180", 
    ">200", "Alle AKl"), DKL = c("0-6.9", "0-24.9", ">=50", "Alle DKl"
    ), T.FVBN.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 94340.6067294845, 28450121.8057453, 
    0, 0, 0, 0, 0, 94340.6067294845, 28450121.8057453, 0, 0, 
    0, 0, 0, 94340.6067294845, 28450121.8057453, 0, 0, 0, 0, 
    0, 94340.6067294845, 28450121.8057453, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 6544.308414, 890454.936067471, 
    890454.936067471, 821302.940164437, 17315119.6925016, 17315119.6925016, 
    17315119.6925016, 6544.308414, 890454.936067471, 890454.936067471, 
    821302.940164437, 17315119.6925016, 17315119.6925016, 17315119.6925016, 
    6544.308414, 890454.936067471, 890454.936067471, 821302.940164437, 
    17315119.6925016, 17315119.6925016, 17315119.6925016, 6544.308414, 
    890454.936067471, 890454.936067471, 821302.940164437, 17315119.6925016, 
    17315119.6925016, 17315119.6925016, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2393.561586, 1703037.63076889, 
    1703037.63076889, 1173242.97147497, 688454.265570117, 688454.265570117, 
    688454.265570117, 2393.561586, 1703037.63076889, 1703037.63076889, 
    1173242.97147497, 688454.265570117, 688454.265570117, 688454.265570117, 
    2393.561586, 1703037.63076889, 1703037.63076889, 1173242.97147497, 
    688454.265570117, 688454.265570117, 688454.265570117, 2393.561586, 
    1703037.63076889, 1703037.63076889, 1173242.97147497, 688454.265570117, 
    688454.265570117, 688454.265570117, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 6544.308414, 890454.936067471, 890454.936067471, 915643.546893922, 
    45765241.498247, 17315119.6925016, 17315119.6925016, 6544.308414, 
    890454.936067471, 890454.936067471, 915643.546893922, 45765241.498247, 
    17315119.6925016, 17315119.6925016, 6544.308414, 890454.936067471, 
    890454.936067471, 915643.546893922, 45765241.498247, 17315119.6925016, 
    17315119.6925016, 6544.308414, 890454.936067471, 890454.936067471, 
    915643.546893922, 45765241.498247, 17315119.6925016, 17315119.6925016, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2393.561586, 
    1703037.63076889, 1703037.63076889, 1173242.97147497, 688454.265570117, 
    688454.265570117, 688454.265570117, 2393.561586, 1703037.63076889, 
    1703037.63076889, 1173242.97147497, 688454.265570117, 688454.265570117, 
    688454.265570117, 2393.561586, 1703037.63076889, 1703037.63076889, 
    1173242.97147497, 688454.265570117, 688454.265570117, 688454.265570117, 
    2393.561586, 1703037.63076889, 1703037.63076889, 1173242.97147497, 
    688454.265570117, 688454.265570117, 688454.265570117, 0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA), .Dim = c(7L, 
    2L, 3L, 5L, 4L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NaN, NaN, 
    Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 0, NaN, 
    NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0.724950495049505, 136.065551886667, 
    136.065551886667, 125.498813351683, 2645.82880223983, 2645.82880223983, 
    2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, NaN, NaN, NaN, 0.724950495049505, 
    136.065551886667, 136.065551886667, 125.498813351683, 2645.82880223983, 
    2645.82880223983, 2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.265148514851485, 
    711.507755108539, 711.507755108539, 490.166193482254, 287.627554518297, 
    287.627554518297, 287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0.265148514851485, 711.507755108539, 
    711.507755108539, 490.166193482254, 287.627554518297, 287.627554518297, 
    287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0.724950495049505, 136.065551886667, 136.065551886667, 
    139.914485835527, 6993.13641764545, 2645.82880223983, 2645.82880223983, 
    0.725273811922906, 2.03132467589353e-06, 2.03132467589353e-06, 
    NaN, 7.49859175719016e-05, NaN, NaN, 0.724950495049505, 136.065551886667, 
    136.065551886667, 139.914485835527, 6993.13641764545, 2645.82880223983, 
    2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, 7.49859175719016e-05, NaN, NaN, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.265148514851485, 
    711.507755108539, 711.507755108539, 490.166193482254, 287.627554518297, 
    287.627554518297, 287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0.265148514851485, 711.507755108539, 
    711.507755108539, 490.166193482254, 287.627554518297, 287.627554518297, 
    287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA), .Dim = c(7L, 2L, 3L, 5L, 4L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 
    0, 0), .Dim = c(3L, 5L, 4L))), .Names = c("Log", "Stratum", 
"nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", "LK", 
"se.LK", "Attribute1", "Attribute2", "Größen", "BAGR", "AKL", 
"DKL", "T.FVBN.Bagr.Akl.Dkl", "FVBN.ha.Bagr.Akl.Dkl", "nT.Bagr.Akl.Dkl"
))

  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

  # FIXME: Es geht um unbesetzte
  # Klassen.
  A.klass <- list(A.ob = 100, A.b = 50)
  result <- FVBN(
    get_data("baeume.3")[1:10, ], get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    A.klass,
    list(
      D.unt = 10, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(
      Wa = c(3, 5), Begehbar = 1,
      BTyp = c(
        110, 117, 170, 171, 410, 417, 470,
        471
      )
    )
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042226.82537, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1, BTyp = c(110, 117, 170, 171, 410, 417, 470, 
    471)), .Names = c("Wa", "Begehbar", "BTyp")), nTE = 22L, 
    HBF = 196633.14, se.HBF = 37211.3201732967, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = c("1-50", "51-100", ">100", "Alle AKl"
    ), DKL = c("0-6.9", ">=50", "25-49.9", "Alle DKl"), T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA
    ), .Dim = c(7L, 2L, 3L, 4L, 3L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA), .Dim = c(7L, 2L, 3L, 4L, 3L)), 
    nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(3L, 4L, 3L))), .Names = c("Log", 
"Stratum", "nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", 
"LK", "se.LK", "Attribute1", "Attribute2", "Größen", "BAGR", 
"AKL", "DKL", "T.FVBN.Bagr.Akl.Dkl", "FVBN.ha.Bagr.Akl.Dkl", 
"nT.Bagr.Akl.Dkl"))
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  expect_equal(result, reference)



  result <- FVBN(
    get_data("baeume.3"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    list(A.ob = 100, A.b = 100),
    list(
      D.unt = 0, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(
      Wa = c(3, 5), Begehbar = 1,
      BTyp = c(
        110, 117, 170, 171, 410, 417, 470,
        471
      )
    )
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042413.70462, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1, BTyp = c(110, 117, 170, 171, 410, 417, 470, 
    471)), .Names = c("Wa", "Begehbar", "BTyp")), nTE = 22L, 
    HBF = 196633.14, se.HBF = 37211.3201732967, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = "0-100", DKL = c("0-6.9", "7-24.9", 
    "25-49.9", ">=50", "Alle DKl"), T.FVBN.Bagr.Akl.Dkl = structure(c(25001.009964, 
    0, 0, 715989.970671322, 839278583.491457, 0, 0, 12501.0781241518, 
    0, 0, 351532.984159414, 327950143.98932, 0, 0, 3512.58291, 
    0, 0, 823254.064346614, 896178836.076569, 0, 0, 2810.02761350344, 
    0, 0, 528856.666696164, 385828828.697263, 0, 0, 28513.592874, 
    0, 0, 1539244.03501794, 1735457419.56803, 0, 0, 14436.4072398458, 
    0, 0, 690909.970989775, 525423573.80515, 0, 0, 20111.101287, 
    6638810.86985571, 5353046.08500619, 3615089.85626865, 80250165.2907245, 
    80250165.2907245, 60564896.5303032, 8365.41269657964, 2307015.91345702, 
    2066306.61221709, 1213930.06616078, 29611155.3021901, 29611155.3021901, 
    26931453.0544488, 19389.815178, 3157189.9894304, 2260034.0376805, 
    2335000.59415371, 36816865.9553439, 36816865.9553439, 29091519.1617808, 
    10599.4502352793, 1242070.10691958, 1126831.12954274, 895243.121567699, 
    16341130.8701344, 16341130.8701344, 15781669.9720207, 39500.916465, 
    9796000.85928611, 7613080.12268669, 5950090.45042236, 117067031.246068, 
    117067031.246068, 89656415.692084, 14659.5684825652, 2770643.53772336, 
    2371272.95042685, 1634100.00153254, 38715820.8259585, 38715820.8259585, 
    36414432.5631145, 66460.213746, 35948052.8939664, 35948052.8939664, 
    16262001.6151415, 27513706.2979703, 27513706.2979703, 27513706.2979703, 
    18502.4203501686, 9978916.98914107, 9978916.98914107, 4475642.33681386, 
    7970713.00588864, 7970713.00588864, 7970713.00588864, 31935.00951, 
    13343894.8947869, 13343894.8947869, 8640833.87300603, 9823755.01215105, 
    9823755.01215105, 9823755.01215105, 10740.7723651134, 4677937.07847827, 
    4677937.07847827, 2994825.03307891, 3695470.85804881, 3695470.85804881, 
    3695470.85804881, 98395.223256, 49291947.7887534, 49291947.7887534, 
    24902835.4881475, 37337461.3101213, 37337461.3101213, 37337461.3101213, 
    23594.6975131845, 12466881.8683522, 12466881.8683522, 6214717.30884693, 
    9957956.00115923, 9957956.00115923, 9957956.00115923, 20953.942428, 
    12620457.0036651, 12620457.0036651, 5944126.47123023, 3512306.92948902, 
    3512306.92948902, 3512306.92948902, 7731.51595120872, 4765102.07350757, 
    4765102.07350757, 2211769.08375672, 1264725.59655637, 1264725.59655637, 
    1264725.59655637, 9269.464977, 7090855.16092761, 7090855.16092761, 
    4540011.39858352, 1597384.70335881, 1597384.70335881, 1597384.70335881, 
    4904.33277558503, 4006460.34649492, 4006460.34649492, 2652654.88712891, 
    1042737.69297755, 1042737.69297755, 1042737.69297755, 30223.407405, 
    19711312.1645927, 19711312.1645927, 10484137.8698138, 5109691.63284783, 
    5109691.63284783, 5109691.63284783, 10457.5597881809, 7237623.05327174, 
    7237623.05327174, 4030638.312509, 1914001.3904722, 1914001.3904722, 
    1914001.3904722, 132526.267425, 55207320.7674873, 53921555.9826377, 
    26537207.9133117, 950554762.009641, 111276178.518184, 91590909.7577625, 
    28611.4332734361, 14072202.4791532, 13989631.5417179, 6422717.04284627, 
    340972264.320483, 31791942.5113843, 28849467.5623885, 64106.872575, 
    23591940.0451449, 22694784.093395, 16339099.9300899, 944416841.747423, 
    48238005.6708538, 40512658.8772907, 18352.3185620041, 8754253.25461518, 
    8666880.43334075, 5745492.42193943, 400856361.801671, 17708382.5807943, 
    17086063.3619495, 196633.14, 78799260.8126322, 76616340.0760328, 
    42876307.8434015, 1894971603.75706, 159514184.189038, 132103568.635053, 
    37211.3201732967, 19282537.879301, 18876034.2951277, 10226746.104066, 
    553719945.322517, 42361746.7699505, 38906261.3827475), .Dim = c(7L, 
    2L, 3L, 1L, 5L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(12.7145454545455, 
    0, 0, 28.6384418750405, 33569.7871685972, 0, 0, 5.88465445002426, 
    0, 0, 6.08257687011909, 13084.9280380629, 0, 0, 1.78636363636364, 
    0, 0, 234.372849108525, 255133.859908397, 0, 0, 1.38851104150071, 
    0, 0, 224.392237962522, 222493.635530821, 0, 0, 14.5009090909091, 
    0, 0, 53.9828159088814, 60864.2140342298, 0, 0, 6.80965741711948, 
    0, 0, 24.0750234015063, 28233.8183979682, 0, 0, 10.2277272727273, 
    330.106779092555, 266.17369226152, 179.755937016014, 3990.34165983734, 
    3990.34165983734, 3011.51566321497, 3.78854137080018, 79.9405287733648, 
    55.5433251720864, 39.43904270818, 1066.90977674431, 1066.90977674431, 
    897.643121383423, 9.86090909090909, 162.827234836802, 116.557791651607, 
    120.424076904201, 1898.77343426754, 1898.77343426754, 1500.35051364433, 
    5.05715632361018, 83.35533382529, 60.7709367886397, 61.2627682940482, 
    926.459475998935, 926.459475998935, 767.300381486929, 20.0886363636364, 
    247.994267878972, 192.731733944257, 150.631706373053, 2963.65354838783, 
    2963.65354838783, 2269.73001427763, 6.41319022056744, 74.5715267281013, 
    54.8924918596767, 43.3898918765314, 838.758539799309, 838.758539799309, 
    723.989106517375, 33.7990909090909, 540.895836287166, 540.895836287166, 
    244.687771804228, 413.987628795826, 413.987628795826, 413.987628795826, 
    6.90139229959304, 64.794735338115, 64.794735338115, 28.6017636378615, 
    70.1914635566295, 70.1914635566295, 70.1914635566295, 16.2409090909091, 
    417.845339629802, 417.845339629802, 270.575584776334, 307.617099944025, 
    307.617099944025, 307.617099944025, 4.51563528890422, 62.2232360649459, 
    62.2232360649459, 38.0078945247886, 50.9526931148652, 50.9526931148652, 
    50.9526931148652, 50.04, 500.958747362237, 500.958747362237, 
    253.089882456555, 379.464165785553, 379.464165785553, 379.464165785553, 
    7.36949100657352, 54.177678764847, 54.177678764847, 27.3159647121912, 
    55.6499771068279, 55.6499771068279, 55.6499771068279, 10.6563636363636, 
    602.295107330296, 602.295107330296, 283.675804286229, 167.620338824433, 
    167.620338824433, 167.620338824433, 3.37541243552276, 109.455221264039, 
    109.455221264039, 48.0456910062958, 24.3959763663359, 24.3959763663359, 
    24.3959763663359, 4.71409090909091, 764.969194934324, 764.969194934324, 
    489.781385424994, 172.327605457526, 172.327605457526, 172.327605457526, 
    2.32915224651573, 122.734247441296, 122.734247441296, 90.3393112304059, 
    55.379769302317, 55.379769302317, 55.379769302317, 15.3704545454545, 
    652.186958950624, 652.186958950624, 346.888017268341, 169.064049078811, 
    169.064049078811, 169.064049078811, 4.45237524566247, 102.769248131593, 
    102.769248131593, 63.6990536213772, 27.8214740607843, 27.8214740607843, 
    27.8214740607843, 67.3977272727273, 416.576440581717, 406.874478775714, 
    200.241117696382, 7172.57627849199, 839.653758309897, 691.115139190019, 
    7.00317820268531, 68.0061956152618, 67.0967727037605, 28.5588016848545, 
    1962.44913155955, 177.588736869332, 154.771241078858, 32.6022727272727, 
    368.00952998517, 354.014837751505, 254.872828353534, 14731.9125674479, 
    752.462313840362, 631.955003418613, 7.00317820268532, 88.5572302601882, 
    88.2309311530625, 55.8553458280702, 5639.23239718849, 231.947584885477, 
    225.08739278241, 100, 400.74252393382, 389.641034446344, 
    218.052297000402, 9637.09171178909, 811.227365789091, 671.82759038, 
    0, 62.17019600073, 61.466948220954, 31.6573225582124, 2145.65509367677, 
    151.143880330936, 151.609067001973), .Dim = c(7L, 2L, 3L, 
    1L, 5L)), nT.Bagr.Akl.Dkl = structure(c(12L, 14L, 18L, 10L, 
    9L, 15L, 16L, 11L, 17L, 9L, 4L, 10L, 21L, 17L, 22L), .Dim = c(3L, 
    1L, 5L))), .Names = c("Log", "Stratum", "nTE", "HBF", "se.HBF", 
"BL", "se.BL", "iBL", "se.iBL", "LK", "se.LK", "Attribute1", 
"Attribute2", "Größen", "BAGR", "AKL", "DKL", "T.FVBN.Bagr.Akl.Dkl", 
"FVBN.ha.Bagr.Akl.Dkl", "nT.Bagr.Akl.Dkl"))

  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fvbn.kreis.fun.1", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  result <- fvbn.kreis.fun.1(316, eig.list = ("GW"), c(3), bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524119010.50474, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316), nTE = 1L, HBF = 8937.87, 
    se.HBF = 8937.87, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "GW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)

  # 
  result <- fvbn.kreis.fun.1(316, eig.list = ("oew"), c(3), bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524119438.17643, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316, EigArt = c("BW", 
    "StW", "KW")), nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "OEW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)
  # 
  result <- fvbn.kreis.fun.1(kreiscode = 316, eig.list =  c("KW"), bwi.list = c(1,2,3), bagr = bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524121804.40586, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1, Kreis = 316, EigArt = "KW"), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 0, 
    0, 1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0), .Dim = c(7L, 2L, 10L, 1L, 1L)), 
    FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 16.17, 0, 0, 167.639749253353, 103347.358181818, 0, 0, 
    NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 29.4, 0, 0, 53.6408969374879, 56841.047, 
    0, 0, 0, 0, 0, NaN, 0, 0, 0, 54.43, 0, 0, 48.8934310456017, 
    57018.5773690979, 0, 0, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 0, 0, 69.4904656720095, 
    64457.747298, 0, 0, 0, 0, 0, NaN, NaN, 0, 0), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 1), list(Log = list(Datum = structure(1524121804.52388, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1, Kreis = 316, EigArt = "KW"), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1995.83474475, 233565.905141122, 233565.905141122, 385906.375875682, 
    48162660.8611504, 1713289.50560511, 1713289.50560511, 1995.83474475, 
    233565.905141122, 233565.905141122, 385906.375875682, 48162660.8611504, 
    1713289.50560511, 1713289.50560511, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 4173.10901175, 114127.147714695, 114127.147714695, 
    190744.356201362, 24734479.0237019, 6154729.6234446, 6154729.6234446, 
    4173.10901175, 114127.147714695, 114127.147714695, 190744.356201362, 
    24734479.0237019, 6154729.6234446, 6154729.6234446, 2768.9637435, 
    217211.536915238, 217211.536915238, 158858.272170474, 2497689.08951981, 
    2497689.08951981, 2497689.08951981, 2768.9637435, 217211.536915238, 
    217211.536915238, 158858.272170474, 2497689.08951981, 2497689.08951981, 
    2497689.08951981, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.9075, 564904.589771055, 564904.589771055, 735509.004247517, 
    75394828.9743721, 10365708.2185695, 10365708.2185695, 8937.9075, 
    564904.589771055, 564904.589771055, 735509.004247517, 75394828.9743721, 
    10365708.2185695, 10365708.2185695), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 22.33, 117.02667555794, 117.02667555794, 
    193.355876227128, 24131.5875414241, 858.432548141514, 858.432548141514, 
    1.07607059257956e-07, 0, 0, NaN, 0.000277104569367169, NaN, 
    NaN, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 46.69, 
    27.3482306341276, 27.3482306341276, 45.707973519094, 5927.11068751339, 
    1474.85474405654, 1474.85474405654, 0, 5.07631858224566e-07, 
    5.07631858224566e-07, 7.37181051620592e-07, NaN, NaN, NaN, 
    30.98, 78.445063582046, 78.445063582046, 57.3710192281807, 
    902.030261459006, 902.030261459006, 902.030261459006, NaN, 
    8.38334274432894e-07, 8.38334274432894e-07, 1.07087652248254e-06, 
    1.13711649026579e-05, 1.13711649026579e-05, 1.13711649026579e-05, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 63.20322623288, 
    63.20322623288, 82.290961754473, 8435.400453, 1159.746643, 
    1159.746643, 0, 8.37673426785977e-07, 8.37673426785977e-07, 
    0, 0.000107895932187889, 1.34869915234861e-05, 1.34869915234861e-05
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 2), list(Log = list(Datum = structure(1524121804.64467, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316, EigArt = "KW"), 
    nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 3))

    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  # 
  result <- fvbn.kreis.fun.1(kreiscode = 225, eig.list =  c("GPW"), bwi.list = c(3), bagr = bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524121567.63566, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 225, EigArt2 = "GPW"), 
    nTE = 2L, HBF = 17875.74, se.HBF = 12576.0562730192, BL = 0, 
    se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(8937.87, 
    2820395.55567093, 2820395.55567093, 1249295.44292603, 15019542.5702785, 
    794481.649530066, 794481.649530066, 8937.87, 2820395.55567093, 
    2820395.55567093, 1249295.44292603, 15019542.5702785, 794481.649530066, 
    794481.649530066, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 270.276148279905, 7112530.44249846, 0, 0, 0, 0, 0, 270.276148279905, 
    7112530.44249846, 0, 0, 17875.74, 5586244.34607582, 5586244.34607582, 
    2820817.69198567, 24531174.3755127, 3193583.01226583, 3193583.01226583, 
    12576.0562730192, 3930261.94450396, 3930261.94450396, 1997644.35115118, 
    22237618.4600987, 2519599.67871247, 2519599.67871247), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(50, 
    315.555669938243, 315.555669938243, 139.775521788304, 1680.4386918, 
    88.8893718, 88.8893718, 35.5334527259351, 3.37174788087152e-06, 
    3.37174788087152e-06, 0, 0, 9.93413444728961e-07, 9.93413444728961e-07, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 11.94, 
    490.320515575746, 490.320515575746, 246.52909254077, 158.082117252931, 
    158.082117252931, 158.082117252931, 8.4853885109533, 0, 0, 
    NaN, NaN, NaN, NaN, 29.685, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    21.0962108833876, NaN, NaN, NaN, NaN, NaN, NaN, 8.375, 268.823781574257, 
    268.823781574257, 189.566552846588, 438.923212537313, 438.923212537313, 
    438.923212537313, 5.95185333159413, NaN, NaN, 2.50647609960353e-06, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NaN, NaN, 
    Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 100, 
    312.504228976021, 312.504228976021, 157.8014500091, 1372.31657965, 
    178.65459065, 178.65459065, 0, 2.16856466354402, 2.16856466354402, 
    12.7889791340691, 784.505273928749, 63.7933632087938, 63.7933632087938
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(1, 
    0, 2, 1, 1, 0, 0, 0, 1, 2), .Dim = c(10L, 1L, 1L)), Kreis = "Neckar-Odenwald-Kreis", 
    Eigentumsart = "GPW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fvbn.stratum.fun.1", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1, Kreis = 316, WGNr_BW = 1),
                               c("GW"), c(1,2, 3), bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524123186.61608, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = 1:3), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 0, 
    0, 1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0), .Dim = c(7L, 2L, 10L, 1L, 1L)), 
    FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 16.17, 0, 0, 167.639749253353, 103347.358181818, 0, 0, 
    NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 29.4, 0, 0, 53.6408969374879, 56841.047, 
    0, 0, 0, 0, 0, NaN, 0, 0, 0, 54.43, 0, 0, 48.8934310456017, 
    57018.5773690979, 0, 0, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 0, 0, 69.4904656720095, 
    64457.747298, 0, 0, 0, 0, 0, NaN, NaN, 0, 0), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 1), list(Log = list(Datum = structure(1524123186.73225, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = 1:3), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1995.83474475, 233565.905141122, 233565.905141122, 385906.375875682, 
    48162660.8611504, 1713289.50560511, 1713289.50560511, 1995.83474475, 
    233565.905141122, 233565.905141122, 385906.375875682, 48162660.8611504, 
    1713289.50560511, 1713289.50560511, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 4173.10901175, 114127.147714695, 114127.147714695, 
    190744.356201362, 24734479.0237019, 6154729.6234446, 6154729.6234446, 
    4173.10901175, 114127.147714695, 114127.147714695, 190744.356201362, 
    24734479.0237019, 6154729.6234446, 6154729.6234446, 2768.9637435, 
    217211.536915238, 217211.536915238, 158858.272170474, 2497689.08951981, 
    2497689.08951981, 2497689.08951981, 2768.9637435, 217211.536915238, 
    217211.536915238, 158858.272170474, 2497689.08951981, 2497689.08951981, 
    2497689.08951981, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.9075, 564904.589771055, 564904.589771055, 735509.004247517, 
    75394828.9743721, 10365708.2185695, 10365708.2185695, 8937.9075, 
    564904.589771055, 564904.589771055, 735509.004247517, 75394828.9743721, 
    10365708.2185695, 10365708.2185695), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 22.33, 117.02667555794, 117.02667555794, 
    193.355876227128, 24131.5875414241, 858.432548141514, 858.432548141514, 
    1.07607059257956e-07, 0, 0, NaN, 0.000277104569367169, NaN, 
    NaN, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 46.69, 
    27.3482306341276, 27.3482306341276, 45.707973519094, 5927.11068751339, 
    1474.85474405654, 1474.85474405654, 0, 5.07631858224566e-07, 
    5.07631858224566e-07, 7.37181051620592e-07, NaN, NaN, NaN, 
    30.98, 78.445063582046, 78.445063582046, 57.3710192281807, 
    902.030261459006, 902.030261459006, 902.030261459006, NaN, 
    8.38334274432894e-07, 8.38334274432894e-07, 1.07087652248254e-06, 
    1.13711649026579e-05, 1.13711649026579e-05, 1.13711649026579e-05, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 63.20322623288, 
    63.20322623288, 82.290961754473, 8435.400453, 1159.746643, 
    1159.746643, 0, 8.37673426785977e-07, 8.37673426785977e-07, 
    0, 0.000107895932187889, 1.34869915234861e-05, 1.34869915234861e-05
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 2), list(Log = list(Datum = structure(1524123186.85304, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = c(3, 5)), nTE = 1L, 
    HBF = 8937.87, se.HBF = 8937.87, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 3))
    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1, Kreis = 316),
                               eig.list = c("OEW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524123786.15925, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, EigArt = c("BW", "StW", "KW"), 
    Wa = c(3, 5)), nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "OEW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1),
                               eig.list = c("GPW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524124117.38309, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt2 = "GPW", Wa = c(3, 5)), nTE = 6L, HBF = 53627.22, 
    se.HBF = 21333.1991845241, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(39874.519431, 
    18127497.1104581, 18127497.1104581, 8538774.79785192, 391831605.967679, 
    21980022.7790017, 21980022.7790017, 17996.6821212237, 9612640.35504385, 
    9612640.35504385, 4389033.69165976, 343759649.519323, 12123185.9637436, 
    12123185.9637436, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 4814.830569, 355634.585665191, 
    355634.585665191, 313000.43594746, 13006336.1642741, 13006336.1642741, 
    13006336.1642741, 4814.830569, 355634.585665191, 355634.585665191, 
    313000.43594746, 13006336.1642741, 13006336.1642741, 13006336.1642741, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 89703.2322167132, 
    56900243.5399877, 0, 0, 0, 0, 0, 89703.2322167132, 56900243.5399877, 
    0, 0, 0, 134472.514861265, 0, 549471.874259159, 238544850.720191, 
    3831343.93690191, 0, 0, 134472.514861265, 0, 442862.095283705, 
    220688717.181538, 3831343.93690191, 0, 53627.22, 21383453.0013894, 
    21248980.4865282, 11062202.3131866, 702682137.754868, 41216804.2429135, 
    37385460.3060116, 21333.1991845241, 10069946.1317884, 9965264.60374343, 
    4829439.93192113, 458538130.874455, 24619774.9882662, 23874547.5936278
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(74.355, 
    454.613556956503, 454.613556956503, 214.141133728963, 9826.616384574, 
    551.22978515231, 551.22978515231, 15.8521337522922, 109.209508681063, 
    109.209508681063, 44.8627988446531, 7295.8235427284, 235.960221917379, 
    235.960221917379, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 3.98, 490.320515575746, 490.320515575746, 246.52909254077, 
    158.082117252931, 158.082117252931, 158.082117252931, 3.65152982100243, 
    0, 0, NaN, NaN, NaN, NaN, 9.895, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    9.07836371327111, NaN, NaN, NaN, NaN, NaN, NaN, 2.79166666666667, 
    268.823781574257, 268.823781574257, 189.566552846588, 438.923212537313, 
    438.923212537313, 438.923212537313, 2.56126987025924, NaN, 
    NaN, 2.50647609960353e-06, 0, 0, 0, 8.97833333333333, 73.8623261127657, 
    73.8623261127657, 65.0075701443566, 2701.30713384073, 2701.30713384073, 
    2701.30713384073, 8.23734972602181, 0, 0, 8.18462142054601e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, 
    NaN, 0, Inf, NaN, Inf, Inf, Inf, NaN, 0, NaN, NaN, NaN, NaN, 
    NaN, NaN, 100, 398.742522946172, 396.234980790132, 206.279615336887, 
    13103.087159, 768.579916, 697.1359005, 0, 100.494753004501, 
    98.4143131739766, 37.0989933067113, 6777.95397726179, 342.4680961761, 
    348.266226831989), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(5, 
    0, 2, 1, 1, 1, 0, 1, 3, 6), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GPW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1),
                               eig.list = c("STW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524124197.12304, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = "StW", Wa = c(3, 5)), nTE = 22L, HBF = 223446.75, 
    se.HBF = 42845.6895644946, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(93526.765467, 
    35791985.3847305, 30352424.6672482, 17115335.9548203, 608809685.26172, 
    39807256.2792336, 37847940.9355765, 25909.3109510919, 12240990.2802847, 
    11769974.6212068, 5613700.92575079, 279423683.673827, 16614855.9875758, 
    16602754.9429665, 1123.490259, 0, 0, 2119.53405846176, 42675182.6907422, 
    0, 0, 1123.490259, 0, 0, 1803.79620083324, 30023120.6726591, 
    0, 0, 6285.110184, 2465501.14664696, 2465501.14664696, 1394251.74335744, 
    14477099.0249684, 252038.104219953, 252038.104219953, 6285.110184, 
    2465501.14664696, 2465501.14664696, 1362045.53435845, 14224747.869921, 
    252038.104219953, 252038.104219953, 9771.773271, 3134004.96785197, 
    3134004.96785197, 1739353.39134915, 18576648.2891592, 18576648.2891592, 
    18576648.2891592, 5867.39709559324, 1781231.26204829, 1781231.26204829, 
    957899.312133893, 11795699.437277, 11795699.437277, 11795699.437277, 
    44424.789048, 15910499.5853375, 13227454.4682965, 11719117.3768543, 
    366337898.075028, 32048967.188222, 28696738.0032671, 16053.8794627622, 
    6331508.10070777, 5050925.39005954, 4650934.0865651, 149900194.30754, 
    14881495.7434152, 14306161.7638617, 17873.058639, 8950011.52740006, 
    8950011.52740006, 5188001.00973616, 76692590.7215723, 5567286.2965877, 
    5567286.2965877, 9833.73296472472, 6205638.65416471, 6205638.65416471, 
    3567386.27972677, 33786263.2721981, 3695451.60093428, 3695451.60093428, 
    29177.676615, 5045431.53859164, 5045431.53859164, 3782219.77828842, 
    132156819.8823, 18356332.730822, 18356332.730822, 12526.8878314269, 
    4240518.45107686, 4240518.45107686, 2831313.02904606, 55478531.6365285, 
    17335895.6452154, 17335895.6452154, 0, 0, 0, 29801.5018087855, 
    106687956.637477, 0, 0, 0, 0, 0, 29487.0499343884, 87767797.765109, 
    0, 0, 21264.086517, 5544131.50383598, 5544131.50383598, 3152206.8069098, 
    125597242.284512, 26021816.018031, 26021816.018031, 10618.8412004161, 
    3978075.41256916, 3978075.41256916, 2089507.56997955, 55002825.1456963, 
    14282115.3002807, 14282115.3002807, 223446.75, 76841565.6543946, 
    68718959.8198714, 44122407.0971828, 1492011122.86748, 140630344.906275, 
    135318800.377663, 42845.6895644946, 18665307.370065, 17519424.3777374, 
    10798653.5438382, 414163305.360245, 38684912.6292571, 38499952.9123186
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(41.8564, 
    382.692432546053, 324.531961687029, 182.999335744795, 6509.47012036391, 
    425.624216559475, 404.67496920901, 9.62741009971136, 76.6892869075473, 
    90.0669937372844, 32.4560427320527, 2526.83768758004, 135.952175817736, 
    141.05128114459, 0.5028, 0, 0, 1.88656202533374, 37984.4705807478, 
    0, 0, 0.496770882472722, 0, 0, 2.37777160091284, 41234.6084782228, 
    0, 0, 2.8128, 392.276519339849, 392.276519339849, 221.834097182065, 
    2303.39621759101, 40.1008250995449, 40.1008250995449, 2.77907147617198, 
    7.55694578528675e-06, 7.55694578528675e-06, 7.29594697507463, 
    3216.90799335689, 0, 0, 4.3732, 320.720188745359, 320.720188745359, 
    177.997722942579, 1901.05191493643, 1901.05191493643, 1901.05191493643, 
    2.53756388607163, 81.1090641288114, 81.1090641288114, 45.6284226199987, 
    1473.29386286625, 1473.29386286625, 1473.29386286625, 19.8816, 
    358.144628850045, 297.749404144712, 263.796804171474, 8246.24958104378, 
    721.420807504426, 645.962279579108, 5.53376764856157, 79.0620481902541, 
    68.6077066832057, 57.594291836203, 2056.8074791837, 201.74786547491, 
    187.466181793881, 7.9988, 500.754331319131, 500.754331319131, 
    290.26934418576, 4290.96061679252, 311.490406260939, 311.490406260939, 
    3.74151037438523, 121.955268736614, 121.955268736614, 68.2247887114975, 
    1724.56481152646, 168.954768174307, 168.954768174307, 13.058, 
    172.920949298541, 172.920949298541, 129.62717450724, 4529.38119871956, 
    629.122495702252, 629.122495702252, 4.935464852545, 114.803916072782, 
    114.803916072782, 71.9618687791725, 1663.7374204288, 504.14263201485, 
    504.14263201485, 0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, 
    NaN, NaN, NaN, NaN, NaN, 9.5164, 260.727471147355, 260.727471147355, 
    148.240875731469, 5906.54304308352, 1223.7448336766, 1223.7448336766, 
    4.51944987299216, 109.445932515066, 109.445932515066, 54.3366205251103, 
    2651.18936465766, 449.01516077109, 449.01516077109, 100, 
    343.892071173085, 307.540654853433, 197.462738201306, 6677.255869094, 
    629.368495654, 605.597532198, 0, 46.4273772592529, 48.8015845757447, 
    25.2889043279041, 1342.67701544117, 124.015190137454, 126.90258902678
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(15L, 
    3L, 2L, 5L, 12L, 5L, 7L, 2L, 8L, 21L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "StW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
})

test_that("fvbn.stratum.fun.2", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
    eig.list = c("GW"), bwi.list = c(1,2,3), bagr = bagr.xx, 
    a.klass = list(A.ob = 500, A.b = 500), 
    d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
  )

  reference <- list(list(Log = list(Datum = structure(1524125023.47903, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = 1:3), nTE = 93L, HBF = 866977.0275, se.HBF = 29670.8941169293, 
    BL = 8937.9075, se.BL = 8937.9075, iBL = 17875.815, se.iBL = 12576.1090375045, 
    LK = 1.03191489361702, se.LK = 0.018836834900987, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(401259.103910681, 
    153204416.570847, 149897433.645013, 72370541.0959742, 3182574853.34878, 
    332216294.226677, 297945972.572234, 44767.1164429632, 19858813.1824595, 
    19521745.885207, 9011552.14912735, 1466339208.70812, 51033755.4141896, 
    48919781.149832, 60966.931352984, 24836686.5971171, 23550705.9818487, 
    11117639.9900908, 189925241.446909, 33448915.0369674, 25286241.7311232, 
    18786.423689262, 8284769.6325322, 8226205.2802496, 3642597.37820494, 
    79143240.2080717, 11140901.4535105, 9785519.42168748, 9223.15986702128, 
    4583682.99394145, 4583682.99394145, 2273801.8449666, 857112.791334021, 
    857112.791334021, 857112.791334021, 9223.15986702128, 4583682.99394145, 
    4583682.99394145, 2273801.8449666, 857112.791334021, 857112.791334021, 
    857112.791334021, 74667.9353354441, 16348548.0044897, 15301618.2972952, 
    8563144.98675021, 50731998.0575054, 18725476.7345993, 18232333.13326, 
    20277.7749635525, 4333875.27084672, 4141919.24851652, 2284756.63798002, 
    24423919.62162, 5831275.05903773, 5749756.7517156, 166402.405688824, 
    58692953.6381697, 54453359.1061677, 42612510.3023129, 1196028302.13499, 
    97137737.7579702, 48927586.4809899, 31424.1393637099, 12643146.742044, 
    12261638.648457, 8779309.447363, 375539476.921702, 17952908.9961853, 
    10614387.0692621, 78250.2106277952, 29699485.0010423, 28076602.8757115, 
    18402434.2784737, 143706240.268485, 28127135.5409785, 25356290.4001262, 
    20762.3913432623, 8635625.71410211, 8573736.90981153, 5279984.79700082, 
    81728507.2665601, 9572241.62858821, 9395618.29225362, 29577.7513775505, 
    8090812.24723444, 7635456.42934729, 5698555.39801539, 1196058714.04302, 
    6483005.90584916, 6280401.32300355, 11667.7597390237, 3833447.11193014, 
    3815521.88082682, 2564579.84124191, 457098803.104325, 3389658.36233675, 
    3387394.42881582, 8535.11214094149, 633058.582856155, 602473.598781492, 
    739019.405187874, 825869632.695983, 7925191.48580799, 6147051.410327, 
    5579.4796505178, 447177.683390464, 446547.527968444, 394016.431474761, 
    399830026.213536, 5885193.55785922, 5629790.01382416, 38094.417198758, 
    6719401.35302795, 6208079.43344833, 5064256.38794104, 1107190377.72684, 
    31415626.2511999, 26083326.5647623, 14028.7521918772, 3242165.23962201, 
    3234545.25944051, 2164470.41354698, 566738009.8894, 18087237.8986722, 
    17814465.5043873, 866977.0275, 302809044.988725, 290309412.361555, 
    166841903.689713, 7892942472.51384, 556336495.731384, 455116316.40716, 
    34234.9205468565, 22502234.7358508, 22112489.3778977, 12135730.1983569, 
    1905675529.21028, 53493935.7864608, 51602516.2490566), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(46.2825531914894, 
    381.809197791932, 385.490055641678, 180.358627108143, 7931.47076871609, 
    827.934596346573, 766.225323223907, 4.91407168542041, 29.362072784423, 
    29.5391373651381, 12.5577102861658, 3564.22852575939, 98.8524580414515, 
    95.4132015882004, 7.03212765957447, 407.379640830512, 398.61485101096, 
    182.355249696304, 3115.21733556322, 548.640292280846, 427.990204966567, 
    2.17311448375731, 75.6059294370348, 75.5523923633274, 33.1026607437513, 
    1328.55813337385, 115.47272343188, 98.3547437997634, 1.06382978723404, 
    496.975338173532, 512.836253221623, 246.531761104662, 92.9304927694845, 
    92.9304927694845, 95.89635956, 1.06412040486192, NaN, 6.7490006145452e-06, 
    NaN, NaN, NaN, 1.45922134278008e-06, 8.61244680851064, 218.950047715183, 
    211.469190174946, 114.683028910341, 679.434858210462, 250.783373753077, 
    251.971827278679, 2.33945255477755, 39.3432939540712, 40.846601892838, 
    20.4820938593719, 348.66178560547, 54.0740330099364, 55.6163657117802, 
    19.1934042553191, 352.716977829795, 337.68281195531, 256.081095257716, 
    7187.5661724001, 583.75200379987, 303.415716794887, 3.48385652766114, 
    41.6456488277797, 41.4585936667348, 27.5197191332947, 1958.05606844104, 
    98.0501264553991, 47.8573784261529, 9.02563829787234, 379.545112566033, 
    370.256698827668, 235.174245932789, 1836.49652972868, 359.451243840965, 
    334.382917321814, 2.34589665915637, 43.6424212161994, 41.5071387735538, 
    26.0200587935621, 928.099760239073, 89.1802768613803, 86.6872972781565, 
    3.41159574468085, 273.543858826785, 266.387431161774, 192.66357760856, 
    40437.7837508915, 219.185218750934, 219.111979824753, 1.348158851944, 
    97.2109559878152, 97.9397905491559, 60.881284560147, 15595.306436479, 
    86.7504661373397, 88.934322891125, 0.984468085106383, 74.1710914165357, 
    72.8404582537903, 86.5857873902937, 96761.4272733953, 928.539819388217, 
    743.192801383186, 0.643966977970586, 56.0994243524354, 56.5841628319658, 
    28.0656373930428, 46264.5354343144, 738.404233703578, 670.396000493589, 
    4.39393617021276, 176.388086421415, 168.166626482521, 132.939594836646, 
    29064.373709934, 824.677959693899, 706.554270585672, 1.62137934169783, 
    73.018806445916, 73.7106143213379, 47.5367571229367, 8440.86348294393, 
    384.539082964168, 385.214574522852, 100, 349.269975309381, 
    345.539266751902, 192.440974094568, 9103.98110002268, 641.696928620619, 
    541.699826329787, 1.82542523782751, 21.4614896112152, 21.8258507641704, 
    11.2417732496218, 2164.11224468799, 59.8584080457514, 60.1638950503592
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(56L, 
    17L, 1L, 19L, 43L, 17L, 15L, 7L, 18L, 90L), .Dim = c(10L, 
    1L, 1L)), Eigentumsart = "GW", BWI = 1), list(Log = list(
    Datum = structure(1524125023.68643, class = c("POSIXct", 
    "POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = 1:3), nTE = 96L, HBF = 893790.75, se.HBF = 25407.5770896024, 
    BL = 17875.815, se.BL = 12576.1090375045, iBL = 8937.9075, 
    se.iBL = 8937.9075, LK = 1.03092783505155, se.LK = 0.018244082884591, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(375733.045492268, 
    144042421.429319, 142506081.276618, 68317117.4512753, 3114476252.66766, 
    286870701.694332, 260142611.721956, 45008.1880367813, 21677943.0449781, 
    21517025.5680339, 10033742.059875, 1351147324.32039, 62973270.5302968, 
    62338851.9212093, 88341.5405829897, 33095324.232304, 32147403.7719761, 
    14723341.0585363, 295222256.002283, 58330452.4449994, 52323344.902014, 
    23482.7084861681, 9844472.11622135, 9570286.04505333, 4341455.94491622, 
    165136044.961724, 24540714.9307886, 23720364.8400641, 9214.33762886598, 
    1914363.01650978, 1914363.01650978, 981552.109916594, 28160346.432681, 
    290722.332295093, 290722.332295093, 9214.33762886598, 1914363.01650978, 
    1914363.01650978, 976416.571363756, 27868203.8118028, 290722.332295094, 
    290722.332295094, 72950.8324414948, 14008450.3734457, 12993139.4794716, 
    7432046.32607872, 26555106.1137209, 17265231.4135923, 16808332.4616997, 
    20852.1121393157, 4184862.6771744, 4092520.73940551, 2254492.24370382, 
    11440623.6056402, 6915658.72951198, 6911781.58342641, 187791.88661134, 
    80955037.6620772, 73414505.8629425, 58435632.2910256, 1568612557.63024, 
    113659791.020672, 81688472.5268385, 31388.1799403295, 14932617.6544687, 
    14486224.554503, 10468508.8616297, 417607419.139136, 24758395.3393115, 
    22235284.2485843, 80933.2131293814, 28430028.2004384, 28430028.2004384, 
    17122173.8453321, 95842193.8478669, 20942579.2289071, 20942579.2289071, 
    21434.4890768358, 8850231.96478366, 8850231.96478366, 5271372.82088834, 
    37918306.4247991, 8804599.19322902, 8804599.19322902, 25555.9654136598, 
    15561856.4522371, 15350289.5164233, 11703096.1546837, 2313052328.00242, 
    18785658.0978014, 15402752.3035673, 10159.5113667182, 9364157.64591169, 
    9365270.74926683, 6202596.21553357, 725553398.564719, 9490371.50736188, 
    8926127.23481756, 14403.8525814433, 4492882.3346713, 4342363.52984515, 
    3277489.47486824, 1003581825.14245, 23438822.3385675, 19607462.3267621, 
    7101.63210507569, 2294866.33567304, 2292806.09238209, 1551353.38857832, 
    317120207.413011, 15692932.8751823, 15267824.4697895, 38866.0761185567, 
    13092202.7331433, 11591374.9982217, 9012544.30088877, 1436283569.30706, 
    34673731.5782404, 23087702.0865095, 13693.4094952242, 4523285.65611488, 
    4461033.71653515, 2707010.3709793, 442791649.912859, 14970596.0139169, 
    13885169.7645838, 893790.75, 335592566.434146, 322689549.652446, 
    191004993.012605, 9881786435.14639, 574257690.149407, 490293979.890549, 
    30588.5506360105, 26561698.6626637, 25933461.2363719, 15400691.7429401, 
    1886568825.30319, 69316092.6103236, 68542395.0188894), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(42.0381443298969, 
    383.363729002334, 391.004963802702, 181.823553373564, 8289.06663928699, 
    763.496064921539, 713.773416324889, 4.82532356101857, 36.5294985523241, 
    37.3247531086957, 16.0617163410444, 3507.86910225911, 130.597959800237, 
    135.399122372012, 9.88391752577319, 374.629240263403, 375.153672377236, 
    166.663847623361, 3341.82825037951, 660.283396237614, 610.602807314809, 
    2.64229689907272, 66.8353311691141, 66.3038196771532, 28.8525303438999, 
    1825.67413576913, 209.492401314734, 220.570092318751, 1.03092783505155, 
    207.759156828876, 214.184697761728, 106.524435011114, 3056.144409606, 
    31.551083106, 32.5268898, 1.03134428743575, NaN, 3.89821153930605e-06, 
    0.786281554524048, 4298.96975929466, 4.9165330045986e-08, 
    5.98494940510821e-07, 8.1619587628866, 192.025915327014, 
    183.616673117979, 101.87747113152, 364.013750425914, 236.669422894368, 
    237.532283260285, 2.344505870523, 49.2890470055952, 47.1936164704938, 
    25.659650737705, 151.62962104281, 82.8887147645695, 84.8210832243776, 
    21.0107216494845, 431.089112117097, 403.026238014758, 311.172294743307, 
    8352.93039510643, 605.243352477233, 448.448128672646, 3.42078571709459, 
    44.3350873573478, 46.0290971515571, 29.604498113228, 1874.63088036363, 
    110.74860400331, 95.4746010287652, 9.05505154639175, 351.277641170499, 
    362.141898113917, 211.55929912186, 1184.21337967457, 258.763719110322, 
    266.76672073229, 2.35699375246097, 61.5121890116356, 63.414627847047, 
    35.9338398154871, 537.882412993721, 104.248003776625, 107.472168841881, 
    2.85927835051546, 608.932442987235, 619.230793375632, 457.93989642936, 
    90509.2916883541, 735.079179899045, 621.347142599603, 1.13030245267235, 
    215.169747545311, 222.641086418281, 132.137792561725, 41611.3353820502, 
    239.292868819615, 210.401408733175, 1.61154639175258, 311.922265884584, 
    310.796254510228, 227.54255893251, 69674.5415483758, 1627.2606378077, 
    1403.36611841095, 0.795871535834655, 66.3490057579068, 67.0507713579393, 
    45.0609754485182, 40600.976010061, 572.124650311832, 573.142306859609, 
    4.34845360824742, 336.854245157318, 307.46276253192, 231.887167446412, 
    36954.6842065002, 892.133578714557, 612.404366619251, 1.53703855399451, 
    88.2254047019351, 84.4826187837478, 63.8116792396658, 16265.410273187, 
    332.299297253863, 293.098781916817, 100, 375.471066839913, 
    372.200807422716, 213.702136671928, 11056.0401695211, 642.4967926211, 
    565.521304877423, 1.76967603980552, 26.6110853860687, 27.1636643670394, 
    15.2634286357124, 2064.80885455967, 71.4047915189674, 73.7918961236771
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(54L, 
    18L, 2L, 18L, 46L, 18L, 21L, 19L, 33L, 92L), .Dim = c(10L, 
    1L, 1L)), Eigentumsart = "GW", BWI = 2), list(Log = list(
    Datum = structure(1524125023.91695, class = c("POSIXct", 
    "POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = c(3, 5)), nTE = 97L, HBF = 902724.87, 
    se.HBF = 23749.5302613181, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(329903.038209, 
    144299884.122483, 134163532.92777, 68408615.2800265, 2147247442.02653, 
    233976761.628424, 189918694.616375, 41954.8149210379, 21131336.4407612, 
    19735144.944894, 9665222.60758577, 592989902.867983, 43444897.7729498, 
    35038580.1418026, 73741.896435, 41666847.6994295, 41272260.54267, 
    18616041.1447896, 368446211.082146, 48382341.0267089, 39641776.5179797, 
    20128.4249748835, 12453027.22519, 12373211.1644436, 5513119.11212982, 
    119658615.416587, 17537825.3629695, 15645752.7559506, 26295.21354, 
    3512023.28778686, 3512023.28778686, 1939659.57364047, 57489686.3940141, 
    589442.782523505, 589442.782523505, 14103.3263030828, 2668666.18601838, 
    2668666.18601838, 1454899.37701584, 24082849.3877344, 419102.811548309, 
    419102.811548309, 51592.067001, 12059909.3610462, 12059909.3610462, 
    6430962.48498199, 55066819.2500534, 26616697.4443081, 26616697.4443081, 
    15028.9452094005, 3250630.29733915, 3250630.29733915, 1740343.26890642, 
    26027469.1984718, 12165682.4526368, 12165682.4526368, 190524.999642, 
    73112666.4927309, 68206059.1754734, 53212721.7668321, 2461964491.17629, 
    121941966.727928, 98472131.8211852, 29479.9064238981, 12714939.8000087, 
    12114172.9887067, 9014989.69617412, 856005980.7703, 34678581.4784261, 
    32925510.4587541, 74672.328702, 30821100.2284374, 30375909.0650126, 
    18482335.1513085, 481167465.140534, 40190577.8843869, 39701244.9813839, 
    19162.4019334276, 10572193.3841335, 10575739.7586214, 6169221.88900068, 
    289133656.40049, 20319255.7655703, 20323020.822646, 68639.266452, 
    23834640.4155144, 23394835.4629845, 16650419.3701906, 1315605100.33008, 
    49574678.7588594, 46270487.4897497, 19263.0216461386, 11814532.2834294, 
    11779094.679639, 7791411.87321356, 493139340.677042, 25053463.7612241, 
    24808419.2513869, 16763.868972, 5706638.13364283, 5376784.45076459, 
    4109689.87986344, 1709676400.91064, 31119214.6398002, 13036450.0818778, 
    7048.8149559089, 2645673.18826535, 2642189.33150088, 1732310.91808527, 
    639972194.132348, 18047660.6305558, 8314538.26768923, 70592.191047, 
    15929567.6217167, 13622353.1738338, 10428136.6331752, 1448094491.39748, 
    68263574.9345905, 56566652.6159554, 18123.8103531699, 5497846.94629767, 
    5371590.79761946, 2996064.2210912, 473539173.3416, 23264518.3956268, 
    22870280.5406463, 902724.87, 350943277.362788, 331983667.447342, 
    198278581.284808, 10044758107.7078, 620655255.82753, 510813578.351338, 
    23749.5302613181, 26734715.3478642, 25254921.4830741, 14922176.6155414, 
    1512253825.15038, 68014193.5578388, 63304970.2071242), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(36.5452475247525, 
    437.400894838277, 406.675651294775, 207.359761375366, 6508.72284682084, 
    709.228877971699, 575.680344283636, 4.46055270659472, 37.6979887172356, 
    39.6588968571518, 15.9652263947197, 1720.50543798547, 90.9238180044362, 
    72.612473299265, 8.16881188118812, 565.036291630456, 559.68536934834, 
    252.44863564363, 4996.42983018363, 656.103834668202, 537.574681889583, 
    2.2430510680613, 65.9595407969579, 65.8788129974556, 28.4768838762563, 
    1784.08662855439, 156.59322590411, 144.431124658231, 2.91287128712871, 
    133.561314588467, 133.561314588467, 73.7647393769925, 2186.31753290619, 
    22.4163527566281, 22.4163527566281, 1.56472695478332, 94.1979781863492, 
    94.1979781863492, 51.1467645103759, 1218.00420532482, 16.0567263710947, 
    16.0567263710947, 5.71514851485149, 233.755111242441, 233.755111242441, 
    124.650219671512, 1067.35051435303, 515.906785510109, 515.906785510109, 
    1.67357121423767, 44.0675825138691, 44.0675825138691, 23.8279860398046, 
    462.347084732477, 248.757781648105, 248.757781648105, 21.1055445544554, 
    383.743165621892, 357.990076387004, 279.295220400576, 12922.0023398628, 
    640.031318499198, 516.84625118077, 3.21078850758625, 39.9942124894101, 
    38.5811960467845, 28.0688167425763, 4087.66079643678, 170.077164335634, 
    157.941509284197, 8.27188118811881, 412.75129307186, 406.789363516917, 
    247.512505269084, 6443.71848989419, 538.22585398104, 531.672785240466, 
    2.07929367758985, 67.4192623330501, 67.631251607318, 36.9257748515851, 
    3804.61677892102, 253.765528461915, 253.460114289196, 7.60356435643564, 
    347.244975762994, 340.837492477352, 242.578632186204, 19166.9458071801, 
    722.24954201, 674.11104286942, 2.12079220380676, 134.063564134808, 
    134.171635029026, 86.3633031160064, 8796.441568734, 303.135505217231, 
    303.856331656835, 1.8570297029703, 340.412952593127, 320.736487486583, 
    245.151634549739, 101985.788827522, 1856.32652532523, 777.651633024099, 
    0.782805218068872, 75.6487324422285, 74.3155077948572, 54.4159307851792, 
    49742.9374747492, 1073.16588635261, 278.689892268648, 7.81990099009901, 
    225.656228903717, 192.972522481475, 147.723657227641, 20513.5223871058, 
    967.013120320077, 801.316006444588, 2.02121957823721, 69.5601102145013, 
    64.7903206680538, 40.0644378759215, 7912.96849513548, 289.365124892991, 
    270.020500193081, 100, 388.759952257422, 367.757307325921, 
    219.644531655374, 11127.1534013545, 687.535345988119, 565.857433784158, 
    0, 27.338908452774, 26.9512762362584, 15.1673918857392, 1678.39740773579, 
    71.654204426588, 67.9400017605441), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(58L, 22L, 9L, 18L, 
    51L, 22L, 28L, 20L, 41L, 95L), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 3))

    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)
    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("OEW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )
    reference <- 
list(list(Log = list(Datum = structure(1524125635.68141, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = c("BW", "StW", "KW"), Wa = c(3, 5)), 
    nTE = 61L, HBF = 572023.68, se.HBF = 46711.0661569284, BL = 0, 
    se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(179220.381666, 
    69647304.7433155, 63162950.6847649, 33207607.2698058, 968914063.210337, 
    94072827.5242634, 75371854.0300651, 32115.1614534862, 14858925.1935441, 
    14602620.5817975, 6812005.00412025, 317242398.304396, 24758100.014916, 
    20922698.2408392, 18584.513091, 6912539.51909799, 6718262.28224375, 
    3115297.59906625, 174131656.758164, 10543456.562824, 5705514.74452772, 
    8995.47296850128, 3914075.10424077, 3880160.58282068, 1758510.13921542, 
    94263343.8899534, 7025260.34970415, 3160812.5423896, 15222.980184, 
    2465501.14664696, 2465501.14664696, 1395716.92461437, 28702159.9099653, 
    252038.104219953, 252038.104219953, 10874.4320137334, 2465501.14664696, 
    2465501.14664696, 1362031.01467851, 17272443.1708969, 252038.104219953, 
    252038.104219953, 37347.783582, 9705855.63518456, 9705855.63518456, 
    5171650.81931257, 53245996.5327475, 24795874.7270021, 24795874.7270021, 
    11381.1736735364, 2871562.26531143, 2871562.26531143, 1529851.78776502, 
    26024093.8765517, 12115346.5083464, 12115346.5083464, 162608.456484, 
    55977042.8998121, 52426362.5305425, 40722736.2392938, 1606095148.19234, 
    91126155.4313136, 84157208.7894814, 28892.9667686377, 11455165.6721069, 
    10857536.1134251, 8112874.83433158, 406265343.990699, 33068310.6422791, 
    32800550.8966371, 59872.109769, 26044923.8424391, 25599732.6790142, 
    15590640.0834321, 438931900.660987, 26405135.1748336, 25915802.2718306, 
    17432.1086749031, 9987918.71447106, 9989522.65872232, 5832026.37030096, 
    288986104.201224, 15839903.2094483, 15840431.7491654, 43517.595243, 
    9126560.04294418, 8686755.09041427, 6872128.93202838, 895443757.590187, 
    41940101.7017559, 38635910.4326462, 15248.3031456564, 5003444.85179845, 
    4905882.00464707, 3385657.8769101, 465566903.943051, 24639239.5241597, 
    24379584.1926606, 10391.167662, 3803717.28375676, 3652848.99100614, 
    2796715.93262468, 1392886675.39446, 27280828.3432977, 11221183.4439826, 
    6093.00564966406, 2284685.48999235, 2282139.31682375, 1522682.50748381, 
    609444132.666295, 17932541.0080649, 8203926.06282769, 45258.692319, 
    7935202.52045951, 7087300.21677217, 5071081.55015133, 499387120.975172, 
    51297703.0083906, 45690542.2808568, 15081.5104256403, 4089448.71903656, 
    4072149.52845484, 2211662.0982553, 137307195.882531, 21765357.4646655, 
    21593206.7763001, 572023.68, 191618647.633657, 179505569.25659, 
    113943575.350329, 6057738479.22436, 367714120.577901, 311745928.824613, 
    46711.0661569284, 22430333.1167373, 21673846.874439, 13159314.6660489, 
    1084899440.97344, 63214285.4764786, 59943064.1592654), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(31.3309375, 
    388.612634879397, 352.431738497673, 185.289234188176, 5406.27162046799, 
    524.900274454164, 420.55403146351, 5.18761111853181, 47.3608598523109, 
    53.6871779073573, 20.0596134652111, 1551.37160606422, 112.675836679594, 
    89.5223718783261, 3.24890625, 371.951607515914, 361.497890708648, 
    167.628690825099, 9369.71853421825, 567.324874813639, 307.003724907421, 
    1.55673209316712, 86.5292494665492, 88.0172697373736, 38.4203044999443, 
    3259.50712379615, 329.025951286817, 99.7321846121071, 2.66125, 
    161.95916416145, 161.95916416145, 91.6848677292067, 1885.44946935768, 
    16.5564233266792, 16.5564233266792, 1.8922793409455, 135.156606464604, 
    135.156606464604, 74.9222576966568, 1449.93282947436, 13.8165074116751, 
    13.8165074116751, 6.5290625, 259.877687624343, 259.877687624343, 
    138.472763931434, 1425.68022586512, 663.918239553917, 663.918239553917, 
    1.93868060139393, 56.4457716448895, 56.4457716448895, 29.6613438245056, 
    574.024615757516, 335.494856958598, 335.494856958598, 28.426875, 
    344.244353031664, 322.408586023944, 250.434307783376, 9877.07025157311, 
    560.40231487149, 517.545093343667, 4.38101699696098, 40.4035948302025, 
    39.0096468634602, 28.1131917584576, 2050.52269611057, 186.653939764346, 
    184.854734288696, 10.46671875, 435.009288012837, 427.573586061753, 
    260.399042953127, 7331.15806933286, 441.025634084225, 432.852664985744, 
    2.8293104661225, 76.1728282322194, 76.5114706911072, 41.7928019210469, 
    4694.40480626337, 251.051652655063, 250.57800402885, 7.60765625, 
    209.72114823859, 199.614777468927, 157.916100226926, 20576.5909763643, 
    963.750443184292, 887.822735077738, 2.56258645411583, 80.7928721343327, 
    79.7082003772574, 50.3197625665295, 12589.3565399561, 444.357172936376, 
    449.688676219691, 1.8165625, 366.052921816166, 351.534024839618, 
    269.143567267434, 134045.250803544, 2625.38621555135, 1079.87704644762, 
    1.05786848921078, 27.1237513975228, 25.657217206992, 42.5067916239032, 
    81479.6751268899, 1766.76984805136, 273.334987175727, 7.91203125, 
    175.329911534546, 156.595337903673, 112.046576918495, 11034.0598763947, 
    1133.43316786145, 1009.54181262713, 2.58017391560777, 72.3242055161393, 
    71.346304857039, 38.941706484008, 4084.94911611847, 427.494255828608, 
    409.873281923745, 100, 334.983767863695, 313.80793406418, 
    199.19380846319, 10590.0134750092, 642.830241884219, 544.987803345156, 
    0, 26.7014347052787, 27.1656614476559, 14.9976206602448, 
    1712.48005365472, 97.3106179298456, 94.4560269672278), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(33L, 7L, 
    4L, 15L, 37L, 15L, 18L, 14L, 24L, 60L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "OEW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)


    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("GPW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )

    reference <- list(list(Log = list(Datum = structure(1524125707.03081, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt2 = "GPW", Wa = c(3, 5)), nTE = 6L, HBF = 53627.22, 
    se.HBF = 21333.1991845241, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(39874.519431, 
    18127497.1104581, 18127497.1104581, 8538774.79785192, 391831605.967679, 
    21980022.7790017, 21980022.7790017, 17996.6821212237, 9612640.35504385, 
    9612640.35504385, 4389033.69165976, 343759649.519323, 12123185.9637436, 
    12123185.9637436, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 4814.830569, 355634.585665191, 
    355634.585665191, 313000.43594746, 13006336.1642741, 13006336.1642741, 
    13006336.1642741, 4814.830569, 355634.585665191, 355634.585665191, 
    313000.43594746, 13006336.1642741, 13006336.1642741, 13006336.1642741, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 89703.2322167132, 
    56900243.5399877, 0, 0, 0, 0, 0, 89703.2322167132, 56900243.5399877, 
    0, 0, 0, 134472.514861265, 0, 549471.874259159, 238544850.720191, 
    3831343.93690191, 0, 0, 134472.514861265, 0, 442862.095283705, 
    220688717.181538, 3831343.93690191, 0, 53627.22, 21383453.0013894, 
    21248980.4865282, 11062202.3131866, 702682137.754868, 41216804.2429135, 
    37385460.3060116, 21333.1991845241, 10069946.1317884, 9965264.60374343, 
    4829439.93192113, 458538130.874455, 24619774.9882662, 23874547.5936278
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(74.355, 
    454.613556956503, 454.613556956503, 214.141133728963, 9826.616384574, 
    551.22978515231, 551.22978515231, 15.8521337522922, 109.209508681063, 
    109.209508681063, 44.8627988446531, 7295.8235427284, 235.960221917379, 
    235.960221917379, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 3.98, 490.320515575746, 490.320515575746, 246.52909254077, 
    158.082117252931, 158.082117252931, 158.082117252931, 3.65152982100243, 
    0, 0, NaN, NaN, NaN, NaN, 9.895, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    9.07836371327111, NaN, NaN, NaN, NaN, NaN, NaN, 2.79166666666667, 
    268.823781574257, 268.823781574257, 189.566552846588, 438.923212537313, 
    438.923212537313, 438.923212537313, 2.56126987025924, NaN, 
    NaN, 2.50647609960353e-06, 0, 0, 0, 8.97833333333333, 73.8623261127657, 
    73.8623261127657, 65.0075701443566, 2701.30713384073, 2701.30713384073, 
    2701.30713384073, 8.23734972602181, 0, 0, 8.18462142054601e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, 
    NaN, 0, Inf, NaN, Inf, Inf, Inf, NaN, 0, NaN, NaN, NaN, NaN, 
    NaN, NaN, 100, 398.742522946172, 396.234980790132, 206.279615336887, 
    13103.087159, 768.579916, 697.1359005, 0, 100.494753004501, 
    98.4143131739766, 37.0989933067113, 6777.95397726179, 342.4680961761, 
    348.266226831989), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(5, 
    0, 2, 1, 1, 1, 0, 1, 3, 6), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GPW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)

    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("StW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )

    reference <- list(list(Log = list(Datum = structure(1524125764.91314, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = "StW", Wa = c(3, 5)), nTE = 22L, HBF = 223446.75, 
    se.HBF = 42845.6895644946, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(93526.765467, 
    35791985.3847305, 30352424.6672482, 17115335.9548203, 608809685.26172, 
    39807256.2792336, 37847940.9355765, 25909.3109510919, 12240990.2802847, 
    11769974.6212068, 5613700.92575079, 279423683.673827, 16614855.9875758, 
    16602754.9429665, 1123.490259, 0, 0, 2119.53405846176, 42675182.6907422, 
    0, 0, 1123.490259, 0, 0, 1803.79620083324, 30023120.6726591, 
    0, 0, 6285.110184, 2465501.14664696, 2465501.14664696, 1394251.74335744, 
    14477099.0249684, 252038.104219953, 252038.104219953, 6285.110184, 
    2465501.14664696, 2465501.14664696, 1362045.53435845, 14224747.869921, 
    252038.104219953, 252038.104219953, 9771.773271, 3134004.96785197, 
    3134004.96785197, 1739353.39134915, 18576648.2891592, 18576648.2891592, 
    18576648.2891592, 5867.39709559324, 1781231.26204829, 1781231.26204829, 
    957899.312133893, 11795699.437277, 11795699.437277, 11795699.437277, 
    44424.789048, 15910499.5853375, 13227454.4682965, 11719117.3768543, 
    366337898.075028, 32048967.188222, 28696738.0032671, 16053.8794627622, 
    6331508.10070777, 5050925.39005954, 4650934.0865651, 149900194.30754, 
    14881495.7434152, 14306161.7638617, 17873.058639, 8950011.52740006, 
    8950011.52740006, 5188001.00973616, 76692590.7215723, 5567286.2965877, 
    5567286.2965877, 9833.73296472472, 6205638.65416471, 6205638.65416471, 
    3567386.27972677, 33786263.2721981, 3695451.60093428, 3695451.60093428, 
    29177.676615, 5045431.53859164, 5045431.53859164, 3782219.77828842, 
    132156819.8823, 18356332.730822, 18356332.730822, 12526.8878314269, 
    4240518.45107686, 4240518.45107686, 2831313.02904606, 55478531.6365285, 
    17335895.6452154, 17335895.6452154, 0, 0, 0, 29801.5018087855, 
    106687956.637477, 0, 0, 0, 0, 0, 29487.0499343884, 87767797.765109, 
    0, 0, 21264.086517, 5544131.50383598, 5544131.50383598, 3152206.8069098, 
    125597242.284512, 26021816.018031, 26021816.018031, 10618.8412004161, 
    3978075.41256916, 3978075.41256916, 2089507.56997955, 55002825.1456963, 
    14282115.3002807, 14282115.3002807, 223446.75, 76841565.6543946, 
    68718959.8198714, 44122407.0971828, 1492011122.86748, 140630344.906275, 
    135318800.377663, 42845.6895644946, 18665307.370065, 17519424.3777374, 
    10798653.5438382, 414163305.360245, 38684912.6292571, 38499952.9123186
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(41.8564, 
    382.692432546053, 324.531961687029, 182.999335744795, 6509.47012036391, 
    425.624216559475, 404.67496920901, 9.62741009971136, 76.6892869075473, 
    90.0669937372844, 32.4560427320527, 2526.83768758004, 135.952175817736, 
    141.05128114459, 0.5028, 0, 0, 1.88656202533374, 37984.4705807478, 
    0, 0, 0.496770882472722, 0, 0, 2.37777160091284, 41234.6084782228, 
    0, 0, 2.8128, 392.276519339849, 392.276519339849, 221.834097182065, 
    2303.39621759101, 40.1008250995449, 40.1008250995449, 2.77907147617198, 
    7.55694578528675e-06, 7.55694578528675e-06, 7.29594697507463, 
    3216.90799335689, 0, 0, 4.3732, 320.720188745359, 320.720188745359, 
    177.997722942579, 1901.05191493643, 1901.05191493643, 1901.05191493643, 
    2.53756388607163, 81.1090641288114, 81.1090641288114, 45.6284226199987, 
    1473.29386286625, 1473.29386286625, 1473.29386286625, 19.8816, 
    358.144628850045, 297.749404144712, 263.796804171474, 8246.24958104378, 
    721.420807504426, 645.962279579108, 5.53376764856157, 79.0620481902541, 
    68.6077066832057, 57.594291836203, 2056.8074791837, 201.74786547491, 
    187.466181793881, 7.9988, 500.754331319131, 500.754331319131, 
    290.26934418576, 4290.96061679252, 311.490406260939, 311.490406260939, 
    3.74151037438523, 121.955268736614, 121.955268736614, 68.2247887114975, 
    1724.56481152646, 168.954768174307, 168.954768174307, 13.058, 
    172.920949298541, 172.920949298541, 129.62717450724, 4529.38119871956, 
    629.122495702252, 629.122495702252, 4.935464852545, 114.803916072782, 
    114.803916072782, 71.9618687791725, 1663.7374204288, 504.14263201485, 
    504.14263201485, 0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, 
    NaN, NaN, NaN, NaN, NaN, 9.5164, 260.727471147355, 260.727471147355, 
    148.240875731469, 5906.54304308352, 1223.7448336766, 1223.7448336766, 
    4.51944987299216, 109.445932515066, 109.445932515066, 54.3366205251103, 
    2651.18936465766, 449.01516077109, 449.01516077109, 100, 
    343.892071173085, 307.540654853433, 197.462738201306, 6677.255869094, 
    629.368495654, 605.597532198, 0, 46.4273772592529, 48.8015845757447, 
    25.2889043279041, 1342.67701544117, 124.015190137454, 126.90258902678
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(15L, 
    3L, 2L, 5L, 12L, 5L, 7L, 2L, 8L, 21L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "StW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)
})
#  
#  test_that("VB.A.bagrupp.akl.dkl.stratum.fun.2", {
#    result <- VB.A.bagrupp.akl.dkl.stratum.fun.2(
#      list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
#      list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
#      list(Wa = c(3, 5), Begehbar = 1), T, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      nTE = 13086L,
#      HBF = 1309350.0525594,
#      se.HBF = 15708.5123749046,
#      Attribute = c(
#        "V_DhmR", "V_EoR", "oiB", "N_Dh", "V_DhmR/J", "V_EoR/J",
#        "oiB/J", "N_Dh/J", "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "N_Dh/ha/J"
#      ),
#      Größen = c("Wert", "Standardfehler"),
#      Nutzungsart = 2,
#      BAGR = "Alle Baumarten",
#      AKL = "0-500",
#      DKL = "0-400",
#      T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(
#        143666003.773992, 116293789.603695,
#        74674926.1724354, 208483290.793865, 14159345.8683898, 11461176.3729741,
#        7355561.3051014, 20542633.9154161, 10.8140262725864, 8.75333250307723,
#        5.61771948664408, 15.6891840155818, 2749335.42891021, 2224933.41144847,
#        1382500.01017309, 4657542.73722314, 270557.711654204, 218952.942110049,
#        135972.01748951, 458749.542973834, 0.160854623779009, 0.13004375336356,
#        0.0789666810478547, 0.30066653658216, 10568284.5422928, 8344844.94757921,
#        5971633.48830166, 51811157.6293454, 1044376.02768454, 824563.706138422,
#        589952.934457943, 5137927.94935176, 0.797629347204044, 0.629750389917988,
#        0.450569298336037, 3.92402928407769, 354017.697245855, 281349.87510091,
#        196858.398616963, 2069888.75718359, 34961.7234247034, 27779.4183500989,
#        19431.4806099903, 206120.721609439, 0.0251521853255503, 0.01999199808866,
#        0.013946681165557, 0.151338524049196
#      ),
#      .Dim = c(12L, 2L, 2L, 1L, 1L, 1L)
#      ),
#      BAF.bagr.akl.dkl = structure(c(1309350.0525594, 15800.301815736),
#        .Dim = c(2L, 1L, 1L, 1L)
#      ),
#      mPL.NArt.Bagr.Akl.Dkl = structure(c(
#        10.1665227629513, 0.0101779728202569,
#        10.1410810810811, 0.0160592441799894
#      ),
#      .Dim = c(2L, 2L, 1L, 1L, 1L)
#      ),
#      mPL.Stratum = 10.1485939171634,
#      SE.mPL.Stratum = 0.00883984636898767,
#      nT.NArt.Bagr.Akl.Dkl = structure(c(8970L, 8970L),
#        .Dim = c(2L, 1L, 1L, 1L)
#      )
#    ),
#    .Names = c(
#      "Stratum", "nTE", "HBF", "se.HBF", "Attribute", "Größen",
#      "Nutzungsart", "BAGR", "AKL", "DKL", "T.VBN.A.NArt.Bagr.Akl.Dkl",
#      "BAF.bagr.akl.dkl", "mPL.NArt.Bagr.Akl.Dkl", "mPL.Stratum",
#      "SE.mPL.Stratum", "nT.NArt.Bagr.Akl.Dkl"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("VB.A.bagrupp.akl.dkl.stratum.fun.3", {
#    result <- VB.A.bagrupp.akl.dkl.stratum.fun.3(
#      list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
#      list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 500, d.B = 500, Ndh = F),
#      list(Wa = c(1:3), Begehbar = 1), F, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      nTE = 13086L,
#      HBF = 1309350.0525594,
#      se.HBF = 15708.5123749046,
#      Attribute = c(
#        "V_DhmR", "V_EoR", "oiB", "V_EoR_HB", "V_DhmR/J", "V_EoR/J",
#        "oiB/J", "V_EoR_HB/J", "V_DhmR/ha/J", "V_EoR/ha/J",
#        "oiB/ha/J", "V_EoR_HB/ha/J"
#      ),
#      Größen = c("Wert", "Standardfehler"),
#      Nutzungsart = "insgesamt",
#      BAGR = c("Alle Baumarten", "Alle BA"),
#      AKL = "0-500",
#      DKL = "0-500",
#      T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(
#        154234288.316285, 124638634.551274,
#        80646559.6607371, 118542802.733222, 15203721.8960743, 12285740.0791125,
#        7945514.23955935, 11684403.4708475, 11.6116556197905, 9.38308289299522,
#        6.06828878498012, 9.14607623529644, 2823840.06991487, 2283775.44562971,
#        1425645.29001439, 2222876.04824596, 277971.501039977, 224806.445670574,
#        140260.415288834, 218694.21409298, 0.160735117535021, 0.129922081077202,
#        0.0788373938100195, 0.131428790438861, 154234288.316285,
#        124638634.551274, 80646559.6607371, 118542802.733222, 15203721.8960743,
#        12285740.0791125, 7945514.23955935, 11684403.4708475, 11.6116556197905,
#        9.38308289299522, 6.06828878498012, 9.14607623529644, 2823840.06991487,
#        2283775.44562971, 1425645.29001439, 2222876.04824596, 277971.501039977,
#        224806.445670574, 140260.415288834, 218694.21409298, 0.160735117535021,
#        0.129922081077202, 0.0788373938100195, 0.131428790438861
#      ),
#      .Dim = c(12L, 2L, 1L, 2L, 1L, 1L)
#      ),
#      BAF.bagr.akl.dkl = structure(c(
#        1309350.0525594, 15800.301815736,
#        1309350.0525594, 15800.301815736
#      ),
#      .Dim = c(2L, 2L, 1L, 1L)
#      ),
#      mPL.NArt.Bagr.Akl.Dkl = structure(c(
#        10.1652097285865, 0.00980347411535932,
#        NA, NA, 10.1652097285865, 0.00980347411535932, NA, NA
#      ),
#      .Dim = c(2L, 2L, 2L, 1L, 1L)
#      ),
#      mPL.Stratum = 10.1485939171634,
#      SE.mPL.Stratum = 0.00883984636898767,
#      nT.NArt.Bagr.Akl.Dkl = structure(c(8970L, 8970L),
#        .Dim = c(1L, 2L, 1L, 1L)
#      )
#    ),
#    .Names = c(
#      "Stratum", "nTE", "HBF", "se.HBF", "Attribute", "Größen",
#      "Nutzungsart", "BAGR", "AKL", "DKL",
#      "T.VBN.A.NArt.Bagr.Akl.Dkl", "BAF.bagr.akl.dkl",
#      "mPL.NArt.Bagr.Akl.Dkl", "mPL.Stratum", "SE.mPL.Stratum",
#      "nT.NArt.Bagr.Akl.Dkl"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.2", {
#    result <- iVB.ew.bagrupp.akl.dkl.stratum.fun.2(
#      get_data("baeume.23"), get_data("baeume.3"),
#      list(
#        bagr.lab = c("Fichte", "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche"),
#        ba.grupp = list(c(10), c(30), c(40), c(20), c(100), c(110, 111))
#      ),
#      list(A.ob = 160, A.b = 20), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
#      list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1309350.0525594,
#      se_HBF = 15708.5123749046,
#      Attribute = c(
#        "V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J",
#        "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J",
#        "V_EoR/ha/J", "oiB/ha/J", "mBAF_mLK", "mBAFoLK", "mPL", "nT"
#      ),
#      Größen = c("Wert", "Standardfehler"),
#      BAGR = c(
#        "Fichte", "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche",
#        "Alle BA"
#      ),
#      AKL = c(
#        "1-20", "21-40", "41-60", "61-80", "81-100", "101-120", "121-140",
#        "141-160", ">160"
#      ),
#      DKL = "0-400",
#      iVB.bagr.akl.dkl = structure(c(
#        3464922.15484338,
#        3308166.20992571, 2569628.35553625, 1903772.68687055, 338347.350948474,
#        322945.802139545, 250796.439280503, 186034.570596779, 5.7064105461295,
#        5.57024796330222, 4.22981720421372, 3.13757336246974, 59292.5006382454,
#        57976.9166951219, 10.1390786338364, 2300, 230663.029498138,
#        228236.339791984, 174374.250978079, 118492.156671577, 22320.4698197158,
#        22087.9926225692, 16855.713239933, 11488.8723491072, 0.295589102531467,
#        0.299565691690403, 0.226087117839159, 0.145538268558179,
#        2377.94008849468, 2323.87990477335, 0.0136085650998704, NA,
#        446326.993559083, 377397.949042815, 324118.871252554, 207200.953428881,
#        43958.3686206971, 37223.3063220516, 31916.0274297785, 20401.6936220472,
#        3.96259325266654, 3.43409050340258, 2.87704568921637, 1.83909494429305,
#        11093.3335363442, 10839.3492498727, 10.1240320733104, 1302,
#        52266.9477903855, 50084.7237139327, 38336.0304356731, 23670.2141161324,
#        5144.01957854978, 4932.56836712693, 3773.28925725851, 2333.51670615344,
#        0.391011922075183, 0.376840662617629, 0.288228730679319,
#        0.177790523277111, 812.896485845985, 793.466457854196, 0.0180571268718284,
#        NA, 299578.873901378, 276422.477538197, 217707.404437154,
#        164746.150136764, 28847.7366701899, 26639.5516349001, 20949.1234896702,
#        15853.2760388064, 5.53326765149455, 5.2119568591352, 4.01823923511966,
#        3.04080768895772, 5213.50827162644, 5111.23793901094, 10.2575974542562,
#        358, 53235.6071029793, 52548.3352434502, 39661.9507293506,
#        28530.5816824925, 5137.39417081071, 5073.06274456456, 3827.66783110481,
#        2752.37844114595, 0.824135342503947, 0.826681397825544, 0.618902426714993,
#        0.439719233308812, 556.54539780449, 544.869636441316, 0.034865069030257,
#        NA, 198544.583207681, 185131.831245613, 136741.766543673,
#        102539.026141461, 19501.5850343826, 18177.3647311751, 13434.333456965,
#        10071.2117784938, 8.53444131357013, 8.13213782970818, 5.87924162437338,
#        4.40744512451436, 2285.04530265786, 2235.2504485069, 10.1875823142051,
#        298, 30659.0652101075, 30331.6671709863, 21646.0338005403,
#        15470.601460398, 2996.39114272983, 2963.65445008098, 2113.55518354571,
#        1514.43015745928, 0.97189577247219, 0.944420702738566, 0.680031910707785,
#        0.497008734643486, 356.116721593696, 347.913128142238, 0.0344589531213272,
#        NA, 866084.21154318, 705148.799971515, 665115.866690217,
#        735996.544543315, 85231.4095060796, 69344.8789908748, 65467.9852304206,
#        72361.9490918239, 3.31268497389173, 2.75573298867535, 2.54454094095804,
#        2.81248829307351, 25728.8001055984, 25163.8599515435, 10.2196182396607,
#        2967, 67717.258832095, 63742.1790897095, 52813.2066964872,
#        55897.8447224737, 6725.40646274579, 6292.63211184143, 5243.13219906905,
#        5532.20917502257, 0.213097470479139, 0.198584015713761, 0.167119332222055,
#        0.174171702849754, 1360.39732426206, 1329.53492784781, 0.0122275859408339,
#        NA, 297793.557217656, 293469.503316882, 186536.059286758,
#        193395.908790276, 28807.1304995714, 28376.1949261549, 18046.4378555447,
#        18714.2159877448, 5.17623966677055, 5.21328172914866, 3.24269324475653,
#        3.36268366367547, 5565.26211189601, 5443.05801996026, 10.2904625199362,
#        993, 42374.9647279072, 41966.4634659185, 26957.386148861,
#        26710.2033124144, 4059.9255096058, 4014.28039835384, 2587.17488633621,
#        2563.33163009132, 0.532568694123264, 0.537629066972024, 0.343752408538496,
#        0.331114283474045, 519.005389150204, 507.278010579784, 0.0214712780876175,
#        NA, 8668161.67917693, 7888849.6578879, 6294631.88235857,
#        5424440.94411128, 846702.809748495, 770102.713031493, 614781.655599628,
#        529920.392911515, 4.76568155652617, 4.43206764098625, 3.46030928874803,
#        2.98266618918587, 177666.677831004, 173756.985545493, 10.1874046095737,
#        4381, 343506.018805245, 336632.432183579, 253756.691078652,
#        200643.268989751, 33370.8984255794, 32677.518794321, 24638.8761449042,
#        19516.9640731019, 0.139861745738439, 0.139723305345063, 0.105021635647806,
#        0.0789312207831737, 4722.44229814519, 4615.1984711157, 0.0102247599601316,
#        NA, 17922067.6073403, 17302441.6473729, 14430918.9525253,
#        7926956.98780998, 1758637.68209131, 1697911.14375924, 1415715.3517447,
#        778104.530843447, 22.6138345201167, 22.3697253293165, 18.2042913204684,
#        10.0054304982947, 77768.2210651568, 75902.1900699897, 10.1794697153977,
#        1267, 703160.256767265, 693727.608863159, 568525.122849945,
#        308154.991934071, 68706.0581669643, 67805.6677670495, 55534.1672314905,
#        30134.9136281038, 0.319306493717555, 0.320194296876573, 0.260672367136347,
#        0.135856963027614, 2873.86413649123, 2804.68700883775, 0.0185571804340779,
#        NA, 2256351.74491328, 1942769.00713531, 1769718.74312248,
#        982990.470227077, 221683.715321162, 190674.526188386, 173797.254883432,
#        96538.2102606736, 23.8302571691133, 20.9716159823886, 18.6826230025871,
#        10.3775343796675, 9302.61531581328, 9092.02830857239, 10.1241379310345,
#        388, 177349.697597102, 169636.128072374, 141042.979719266,
#        77818.1351901286, 17307.9811498426, 16547.5779191168, 13759.2388030565,
#        7593.83759407588, 0.979185245399135, 0.841166705396656, 0.782660542533183,
#        0.427603136902145, 781.040273184423, 762.760618240493, 0.0325597601647428,
#        NA, 3461088.06443155, 3423639.98406401, 2658165.73400556,
#        1691470.06516024, 340712.640590562, 337165.568077415, 261648.143465388,
#        166521.144953281, 22.6037309158016, 22.918281818023, 17.3583939218089,
#        11.047430308987, 15073.2921861311, 14711.6424675548, 10.2327349524815,
#        281, 299373.963213872, 298367.76326241, 229525.014236393,
#        145213.647617667, 29517.0022954703, 29430.3346071217, 22633.2338006089,
#        14320.1966976137, 0.725553825226513, 0.746759723128027, 0.553003510875376,
#        0.345266323565567, 1214.80779526216, 1185.37220427637, 0.0380944646674365,
#        NA, 598091.526219207, 577850.933921327, 462923.868786953,
#        272827.036456593, 58747.5384669793, 56809.3183776506, 45465.5244530738,
#        26795.6040293464, 13.6779799466062, 13.5573379339382, 10.5855759740575,
#        6.23872495996758, 4295.04493326561, 4190.30038599535, 10.1511111111111,
#        125, 89203.6450154224, 88507.6895358154, 69845.0624807604,
#        40260.9824755824, 8755.72729569365, 8694.18405933581, 6855.97276869868,
#        3949.87641608498, 0.655153025844625, 0.645980067968265, 0.515328382888432,
#        0.299355759002613, 615.112437298334, 600.082631678078, 0.0514053763207024,
#        NA, 3108982.22239424, 2426489.15184832, 2504403.54507138,
#        2278549.94948392, 305085.882505767, 238820.223053299, 245786.38677238,
#        223591.995789692, 15.6966269837103, 12.5713165753528, 12.6456760278544,
#        11.5037776432928, 19436.3975663295, 18997.2324395623, 10.2147508305648,
#        895, 155230.811768493, 144873.976491352, 126341.373747098,
#        113376.587118226, 15192.1344008546, 14214.0097920932, 12361.3702039678,
#        11097.4822920784, 0.460768129631313, 0.34461380756597, 0.37247914972509,
#        0.334758001466049, 1131.14820801573, 1104.90344503146, 0.021784885182194,
#        NA, 633627.38787489, 620893.742327392, 430125.232788861,
#        395116.817161997, 62558.3444840685, 61323.5945451805, 42502.2110760856,
#        39005.6697121483, 10.8650852228603, 10.9025983002052, 7.38175137641743,
#        6.77447475780246, 5757.74080008546, 5624.67705923148, 10.2515212981744,
#        151, 88655.2467022756, 88497.524583823, 61472.6469695771,
#        54511.7636575847, 8801.90334205525, 8786.4707201826, 6107.14955110869,
#        5416.21298444059, 0.522408367230748, 0.532224195880803, 0.39682958553499,
#        0.31558174393696, 774.978507036461, 756.382329890714, 0.0497876754625404,
#        NA, 32966805.6662347, 30714908.03341, 25979807.9204094, 16525139.477435,
#        3235586.26579033, 3015542.36401857, 2549411.43702567, 1621740.67154412,
#        18.9969785686705, 18.1335694638159, 14.9682655486456, 9.52166632273047,
#        170321.098910245, 166296.126641577, 10.2140680548502, 2504,
#        941702.192555397, 924296.698970359, 748626.450876844, 454473.018302697,
#        92260.9263724051, 90594.0769608087, 73316.1203586135, 44571.5945991048,
#        0.23067837334542, 0.231178776680519, 0.187633364810447, 0.101834265365076,
#        4545.32046856041, 4436.75166375037, 0.0133289014583507, NA,
#        23468200.9082402, 23071540.5745853, 18818076.0347384, 10376313.7694451,
#        2315752.78720325, 2276673.80196696, 1857054.52747049, 1023794.01624452,
#        18.9601463052071, 19.1142374396886, 15.204570078532, 8.3822782991594,
#        122137.917604953, 119108.795689631, 10.1761121495327, 1680,
#        765627.695208189, 757918.685755095, 613871.340387099, 336389.383014827,
#        75453.8173258505, 74691.2233725555, 60515.6318478228, 33141.6422407193,
#        0.209919550783817, 0.212345485570402, 0.168352783639273,
#        0.0889940917260452, 3734.08206390978, 3642.12803385201, 0.0164101091579517,
#        NA, 2641939.16939494, 2470191.47933966, 2096229.34440577,
#        1156176.18894415, 259335.076345574, 242504.49300911, 205757.797866578,
#        113462.544615272, 23.646967788943, 22.648956346577, 18.7616271853302,
#        10.3458628719919, 10966.948433314, 10707.09348803, 10.1099157485418,
#        454, 198446.374970795, 195191.229103458, 157425.273399194,
#        86730.3404523167, 19376.809447302, 19061.6480075752, 15370.8660579998,
#        8464.43639669488, 0.814347915782438, 0.783496303781435, 0.645681009285886,
#        0.353857107571789, 817.446455814527, 797.632116268343, 0.0327288641794357,
#        NA, 3054550.60425697, 2989775.08277148, 2335447.10559448,
#        1487944.06287677, 296790.61288478, 290797.855429407, 226922.651180945,
#        144569.158681751, 22.2527352498442, 22.3409225202377, 17.0141825910198,
#        10.8394911219333, 13337.2643655956, 13016.3763455151, 10.2935943060498,
#        324, 239396.936390844, 237794.603761761, 182621.715499, 116081.733219565,
#        23208.5428185889, 23064.9474817511, 17705.8789673476, 11255.9029917146,
#        0.684206657598321, 0.693131201837558, 0.520852331679096,
#        0.332996923343523, 988.578330927533, 964.591405214228, 0.0345071639897195,
#        NA, 1521154.22951355, 1499242.45593253, 1175807.17058209,
#        703888.40714769, 149088.999380127, 147025.507284055, 115233.752017611,
#        68978.1250782248, 10.1006018469665, 10.2124293707246, 7.80694922698035,
#        4.67318568413619, 14760.4075122418, 14396.7220674764, 10.1945619335347,
#        313, 133742.209488631, 132264.329954642, 103914.475525907,
#        62363.7215228162, 13151.667915185, 13013.1394408637, 10217.4407882677,
#        6135.33835595251, 0.323152063461187, 0.325443914506454, 0.249745530794346,
#        0.139955465325008, 1279.9725267064, 1248.62737548056, 0.0374901876468943,
#        NA, 6033525.58731873, 5326208.2522507, 5012820.66392559,
#        4238431.2806683, 591466.254281697, 522182.258150872, 491339.08173842,
#        415538.968641663, 15.1682634087647, 13.7157502055213, 12.6004832243218,
#        10.6565750578921, 38993.6697657773, 38071.7241365817, 10.2082417582418,
#        1305, 251214.551199942, 242507.165982479, 210790.130429813,
#        175850.014272259, 24551.7400034513, 23704.9302343644, 20593.168434297,
#        17187.1584851174, 0.293289190448136, 0.257928971200853, 0.248058413110892,
#        0.203489711332925, 1720.13834492101, 1678.67388036444, 0.0180192694504914,
#        NA, 933710.371729427, 908358.652827632, 673157.598352013,
#        571458.52936201, 90406.4979450555, 88036.9557762467, 65139.2216426668,
#        55303.1280240641, 11.462618797692, 11.4333918369445, 8.25898672595466,
#        7.01187070917259, 7887.07184114494, 7699.98588623324, 10.3761297798378,
#        279, 85740.4876434874, 84758.1814840624, 62527.8440947061,
#        51769.5054187066, 8348.26055494443, 8261.77615553582, 6084.59634860677,
#        5031.80031438009, 0.430506157007733, 0.429672172546127, 0.334285964617374,
#        0.249207894257746, 685.09798173529, 668.807453509676, 0.0393009286453709,
#        NA, 43610828.4402991, 41823991.5723825, 34647272.3872838,
#        22031815.9445661, 4283687.55614601, 4109216.26109501, 3403590.59030065,
#        2162311.64112136, 16.45819706485, 16.1825270708607, 13.0768091577704,
#        8.30773734982962, 260276.841944902, 253929.206674669, 10.1967378474085,
#        3010, 1039644.60435861, 1021696.09234696, 827725.95779309,
#        510920.783159102, 101911.784029294, 100172.764349314, 81162.7300507138,
#        50009.7858195746, 0.156181862049714, 0.15836549115004, 0.125439031520233,
#        0.0710564631396485, 5808.13372437816, 5666.13554544101, 0.012230823828492,
#        NA, 10321880.0765653, 10109154.5719728, 8315187.15047099,
#        4658244.87469101, 1021488.53127554, 1000251.30567927, 822918.355102728,
#        460808.722855507, 15.0339577315231, 15.1008273354697, 12.1114622321411,
#        6.78204272452878, 67945.4172691789, 66238.1791049173, 10.1601782363977,
#        1291, 431002.03738042, 427122.794614093, 346797.591408255,
#        193380.585768197, 42639.4450795962, 42218.6342548808, 34316.6704558492,
#        19106.5443308155, 0.2323650764115, 0.233961643051362, 0.187247473692846,
#        0.100331798827199, 2674.54364428471, 2608.16586116789, 0.0182246662870195,
#        NA, 2597247.42731594, 2494453.5700582, 2051974.17773087,
#        1142329.1620146, 256026.421762584, 245728.066292723, 202301.832157652,
#        112587.752859526, 22.0415351032272, 21.6650870673069, 17.4163389241325,
#        9.69277658830045, 11615.6347805874, 11342.1222600823, 10.1643493761141,
#        497, 187535.004153516, 185830.220367448, 147837.201419736,
#        82447.5233635578, 18474.9872346441, 18291.9647458773, 14564.1616129597,
#        8120.25812649807, 0.663367100265232, 0.652997507300292, 0.520672005831184,
#        0.288849689360554, 822.540413864644, 802.956617055964, 0.0298964876870011,
#        NA, 628076.811055246, 602123.745563702, 484690.479909835,
#        322340.974468278, 60889.3031708446, 58358.6961147217, 46992.875115098,
#        31244.4114576431, 19.5960995305599, 19.2527891147627, 15.1237903872674,
#        10.0554377339452, 3107.21544743578, 3031.1813923092, 10.3262711864407,
#        135, 80594.7471579594, 79568.6099310516, 62007.286793398,
#        40957.0586831948, 7771.46234575616, 7671.49510076904, 5979.73247581004,
#        3947.51074233138, 1.20910662725517, 1.22336327076109, 0.934508365421569,
#        0.613445298653864, 391.690942692737, 382.025226281758, 0.0477920025311845,
#        NA, 769791.350097185, 747637.758535179, 591149.13378013,
#        351595.154152155, 75038.3586721701, 72943.8531248662, 57601.7995091621,
#        34238.5659968884, 7.46048862266626, 7.43437794619393, 5.72690524536467,
#        3.40407808214666, 10058.1024202879, 9811.69556522348, 10.246265060241,
#        268, 72617.2688043835, 72005.1346848148, 55898.0732578875,
#        32934.2109956677, 7023.26353674671, 6967.96260559746, 5402.40231957446,
#        3175.64144008648, 0.337521608169755, 0.33536459850778, 0.259275826923218,
#        0.143222672248937, 904.427497229952, 882.58841777386, 0.0384563237149178,
#        NA, 6006012.17073447, 5616246.47346699, 5168087.89843417,
#        4122680.98549398, 586674.0633579, 548680.600063661, 504759.702692516,
#        402737.001229194, 13.0720696117502, 12.5279358155895, 11.2468820132205,
#        8.97364728408641, 44879.967807894, 43796.5685760376, 10.2758465011287,
#        1344, 247368.710929391, 241680.822304392, 214563.423114525,
#        168618.114411147, 24268.1617904241, 23709.8087682583, 21051.5738179362,
#        16546.4577659468, 0.2370287391676, 0.22479430784718, 0.20578403999039,
#        0.15900166019546, 1873.06893411527, 1827.72870188803, 0.0176904158499928,
#        NA, 1024421.11549586, 960781.648543208, 760697.967273225,
#        615983.037865487, 99548.452729788, 93466.5720681203, 73932.8603697623,
#        59828.5181395113, 9.03096971276781, 8.6884163345032, 6.70714013596942,
#        5.42760354843797, 11023.008148178, 10757.6074246061, 10.3212415130941,
#        342, 85230.3906248194, 83637.2098898703, 63908.9005337613,
#        50503.3409803586, 8351.48266894462, 8198.39124522083, 6256.5478180529,
#        4943.38710582508, 0.362596879736102, 0.34676519960441, 0.27877150637825,
#        0.205629211629577, 919.524423863467, 897.358910023851, 0.0354212321803871,
#        NA, 24734320.2347179, 23739526.0561028, 20053856.1050987,
#        13253700.3421484, 2430841.31531184, 2333324.01349041, 1970779.08535,
#        1300690.80844354, 13.2773655005116, 13.0660405029127, 10.7644847370875,
#        7.10443218077579, 183081.599675642, 178579.272961098, 10.222224857685,
#        2684, 670043.523335538, 659832.820930909, 543428.432646068,
#        350514.576416981, 65933.9060562408, 64890.1422211043, 53467.5855605925,
#        34418.1730397143, 0.157297884104754, 0.156475898549466, 0.127492542408767,
#        0.077250404752038, 4635.73387424318, 4522.18117217785, 0.0129886863067623,
#        NA, 8726709.76918194, 8509139.80676718, 7090065.29625965,
#        3926639.89772604, 861113.241676397, 839951.089435309, 699649.536883352,
#        387330.477859665, 12.8988843882597, 12.9121637475183, 10.4802690886378,
#        5.80194428811109, 66758.7378688474, 65051.149122605, 10.1578999504705,
#        1230, 376748.106037648, 371722.519769521, 306136.669785612,
#        168154.639102169, 37137.9449726984, 36669.0425318721, 30181.0899072392,
#        16560.8788517144, 0.220118642904161, 0.224132340457696, 0.179085681715788,
#        0.0935705218729192, 2686.80944055257, 2619.05481354466, 0.0186142528112237,
#        NA, 3149243.0437327, 3052926.06240188, 2494463.9425814, 1402856.75239354,
#        311330.170550333, 301972.080016081, 246587.506546996, 138697.131587307,
#        18.8382666734899, 18.7248161821635, 14.9207550250329, 8.39242000565244,
#        16526.4764506414, 16126.8381530884, 10.1246882793017, 592,
#        198969.57241113, 196995.562596587, 157972.243503533, 88464.8981324734,
#        19637.8215025045, 19453.745728427, 15587.5105227152, 8734.27430014119,
#        0.461537989741806, 0.46609609397864, 0.368394015098447, 0.204252592168592,
#        989.521563252434, 965.783547534023, 0.0267550721683242, NA,
#        410159.052987912, 385812.480595365, 320515.24859298, 214947.549805779,
#        40692.4825480178, 38397.8948935883, 31805.509414907, 21330.9677276176,
#        16.4268679485968, 15.8903781768564, 12.8393469870021, 8.61095141255821,
#        2477.19058041699, 2416.42423271669, 10.2922535211268, 79,
#        81438.4417148268, 80681.9588553724, 64149.3980348121, 42394.3574011896,
#        8268.53878647964, 8200.61318793192, 6516.66800702174, 4301.81785700682,
#        1.35400777231671, 1.36049211743713, 1.06830181855229, 0.69365495778391,
#        479.197544433944, 467.327300317622, 0.0682403792607294, NA,
#        771467.209320922, 732050.180312242, 594869.528555567, 348424.528190823,
#        75200.4532612576, 71374.2154548395, 57969.449645369, 33981.258592014,
#        5.99256825271984, 5.83225818416213, 4.61946528919991, 2.70789606438286,
#        12548.9523172517, 12237.8353634379, 10.261089187056, 390,
#        67725.776332727, 66963.2518458935, 51773.5640053598, 29523.0606645026,
#        6598.60660165462, 6524.02757020543, 5044.1607201698, 2878.85145954686,
#        0.290705728470311, 0.29472101852497, 0.218736893771199, 0.117139237278773,
#        918.79844845396, 896.153065062423, 0.0329972124483689, NA,
#        5814842.02381765, 5581871.75199466, 5063112.24723023, 3921326.74952457,
#        567119.88229695, 544693.663630036, 494021.440266749, 382428.492632065,
#        11.9658114960386, 11.7775019722686, 10.423488249594, 8.068959308948,
#        47395.0205955277, 46248.6582394615, 10.2591884207806, 1192,
#        264753.583711924, 261041.876823426, 232337.765767041, 176708.615152351,
#        25900.9724903664, 25554.1609150965, 22760.5800885678, 17285.3700409247,
#        0.235219925111481, 0.235203533665711, 0.209932369991826,
#        0.154619302821468, 2054.56657905311, 2005.0698065078, 0.0192011055793722,
#        NA, 1135007.46895341, 1041306.04274271, 852576.211113167,
#        665036.315348918, 109581.983684192, 100745.861808074, 82359.2177734008,
#        64188.7589396098, 8.92733407079475, 8.40614298421901, 6.70957237816959,
#        5.22927652318338, 12274.8832759248, 11984.7904083009, 10.3802880970432,
#        424, 86378.2752899206, 82950.7185725176, 65467.1285045863,
#        49872.2876058711, 8330.9171564562, 8013.11905665117, 6324.2575556116,
#        4811.14698721196, 0.3591845424795, 0.328581281430223, 0.272413041828566,
#        0.199585580362985, 859.46810922804, 838.973427523266, 0.0323144527593538,
#        NA, 22109258.4241942, 21286150.7639688, 18101192.661838,
#        11777249.8904156, 2169978.05773659, 2090536.19720928, 1776818.82058833,
#        1154570.01418086, 11.8781561688587, 11.7341945886876, 9.72605753291793,
#        6.31995465918507, 182686.439451409, 178157.621420789, 10.2219035532995,
#        2485, 629292.08996624, 618063.99548877, 516313.179959137,
#        331736.962343409, 61897.8735152078, 60851.5309286738, 50806.2707444038,
#        32569.82676763, 0.145831620066131, 0.146427053836085, 0.119702147807425,
#        0.0749879786014173, 4757.75439532006, 4640.42558670565, 0.0132997618057585,
#        NA, 5034540.44301573, 4792002.81188057, 4124574.77299388,
#        2251827.63960928, 501113.689957043, 477328.756940536, 410576.654558219,
#        224080.665463397, 11.1369275135497, 10.8912077919935, 9.12480048382354,
#        4.98004779847017, 44995.6856904532, 43826.9809975931, 10.1275299907721,
#        978, 256620.437311143, 249994.333846942, 210212.854057823,
#        113305.776314712, 25503.7729057977, 24866.0578614461, 20899.6550018763,
#        11254.3347392362, 0.238266310000929, 0.23933525112779, 0.195841878983368,
#        0.101855986237282, 2076.76056451606, 2023.76841103196, 0.0216860089823182,
#        NA, 2930720.83473766, 2811078.10619874, 2336117.84708351,
#        1310866.49192698, 289817.499404921, 277975.378781365, 231011.764408175,
#        129619.127689025, 16.4799563642046, 16.2069221596818, 13.1360728902901,
#        7.3705610346769, 17586.0598778295, 17151.6452070639, 10.136372745491,
#        581, 188090.65186869, 184124.376344374, 150196.69175928,
#        83713.6383299838, 18561.4852156684, 18172.2448192331, 14820.3635731499,
#        8258.31855898374, 0.484666302001212, 0.48465383153595, 0.388135990434797,
#        0.213260377691742, 1088.83090101928, 1061.86742013887, 0.0284633859870514,
#        NA, 192938.297397879, 174591.323854781, 152229.432872265,
#        107830.56508718, 18523.1865940969, 16848.8641179399, 14617.9403394981,
#        10338.6411433772, 14.1941411853539, 13.2436323831631, 11.2015882345017,
#        7.92240208283446, 1304.9881885922, 1272.22378502141, 10.4780141843972,
#        38, 56334.1242931068, 54281.2903496883, 44097.806816064,
#        30907.2863476483, 5513.26688378136, 5354.84324843232, 4315.89509059742,
#        3011.92612419295, 1.71910463688705, 1.90732255836941, 1.31648222082104,
#        0.865221966885352, 348.720483618112, 340.055947685242, 0.109530388663881,
#        NA, 686126.372181393, 649378.680173144, 535690.997976812,
#        310523.935091531, 66681.4579901806, 63094.8970887265, 52030.9758051489,
#        30160.3788860497, 5.05791151498442, 4.9085985924843, 3.9466454332701,
#        2.28772033878605, 13183.5952037975, 12853.953302544, 10.2707355242567,
#        401, 64863.8811153508, 63703.3507729971, 50743.1294460617,
#        29043.1911920397, 6239.18238597491, 6123.87856936035, 4876.63985878483,
#        2785.26175129767, 0.278026893344774, 0.278691726175641, 0.217192533523134,
#        0.117021578698415, 965.582070832502, 942.293039165308, 0.032924273152432,
#        NA, 5226182.64786368, 4989518.19730631, 4584610.16753889,
#        3465665.04759403, 510522.410442191, 487404.479054081, 447758.255550884,
#        338637.057544908, 10.677222291072, 10.4503505406853, 9.36455350322131,
#        7.0823592959803, 47814.1595749183, 46640.0124241303, 10.2529801324503,
#        1017, 270639.810409584, 265956.64138975, 239130.448810049,
#        177690.08729655, 26225.6227467882, 25768.0354615658, 23155.2383156256,
#        17225.5214815465, 0.238145690247698, 0.237905796038427, 0.210858065781129,
#        0.151669600562585, 2241.73195872473, 2187.11340601089, 0.0215584465837696,
#        NA, 1007536.06605392, 931797.932662263, 777636.984559737,
#        587734.420758495, 96273.8487627303, 89153.4811749145, 74277.5661262165,
#        56231.2404781082, 7.66524847630036, 7.27833318344425, 5.91392167124714,
#        4.47708734962466, 12559.7818597, 12249.1618517422, 10.4373983739837,
#        444, 73505.127063156, 71455.4028359012, 56491.0080656429,
#        42240.1864968343, 6969.5361803891, 6779.13997732027, 5357.74171999942,
#        4015.2426686605, 0.308383322725064, 0.294650131238147, 0.235902651727324,
#        0.165971124972054, 859.796086285173, 838.617808771005, 0.0338544077885648,
#        NA, 16160886.067129, 15365361.1650373, 13396917.6053513,
#        8698626.8471893, 1588273.66804518, 1510729.14070094, 1316443.82751109,
#        853623.420673826, 10.5877651108607, 10.329811948343, 8.77569042902078,
#        5.69043260809559, 150010.285590485, 146249.433025087, 10.2261437908497,
#        2102, 509241.793469263, 496788.722122693, 424369.945000615,
#        276454.29483109, 49943.3984686181, 48742.1936925578, 41591.9149687708,
#        27009.2448392861, 0.150972423408927, 0.151045865414308, 0.12536462894588,
#        0.0796338235010496, 4277.02593268138, 4171.09899970208, 0.0147658260535502,
#        NA, 2055872.36362972, 1970400.75252508, 1691080.4740114,
#        909424.567683906, 205434.776424236, 197038.744381022, 168967.917409174,
#        90895.2297486594, 10.4470259010297, 10.2904016091061, 8.59256762823555,
#        4.62231777887177, 19664.4268302223, 19147.8187019115, 10.1234193222054,
#        573, 159240.188061563, 156099.091613281, 130918.126399317,
#        69357.2842596555, 15963.7029657877, 15652.6361636687, 13123.9337502234,
#        6948.68401969129, 0.349684789322683, 0.348836353136291, 0.288456099151125,
#        0.145836241162016, 1300.69182026607, 1267.40615492044, 0.0284471708857295,
#        NA, 1982911.04580825, 1921601.94758329, 1585729.95353527,
#        900392.793102773, 195652.310926404, 189608.681041438, 156414.020437886,
#        88842.5353888346, 14.2409648526507, 14.1518870326204, 11.3849233723368,
#        6.46659074918202, 13738.6976901349, 13398.1200248692, 10.1586034912718,
#        456, 149270.355646221, 148346.203579614, 119739.132632711,
#        67175.2834489969, 14701.1735517827, 14607.9246486454, 11786.2873057903,
#        6618.96227267534, 0.5286229664949, 0.533351801190002, 0.425583604969715,
#        0.233266993053577, 960.12099989623, 936.632450125717, 0.0321788988216837,
#        NA, 27842.0980747963, 27842.0980747963, 21893.9350289732,
#        15300.653987912, 2521.51210052367, 2521.51210052367, 1982.41170636093,
#        1385.37790686128, 12.3553929700808, 12.6923579396303, 9.71380452843788,
#        6.78834277566396, 204.081902261598, 198.663803252078, 10.6461538461538,
#        7, 19835.3828909336, 19835.3828909336, 15603.0168610926,
#        10857.3002439543, 1796.77806336611, 1796.77806336611, 1413.26914880826,
#        983.405900749899, 3.17284147662986, 3.24967201036731, 2.49821957772324,
#        1.71084462657375, 109.911399998183, 107.132751662747, 0.251882170244631,
#        NA, 470110.379360122, 431846.324983593, 365007.528729231,
#        205038.229908603, 46339.3346253642, 42497.3834117414, 35993.99973916,
#        20198.5814815074, 4.08169680772453, 3.84195811555568, 3.17045108697247,
#        1.77914694330777, 11352.9585386323, 11061.3864424169, 10.2679389312977,
#        317, 50430.1536667303, 49060.2906314991, 39290.2837321291,
#        21233.7975402165, 4973.81708020098, 4831.24389760604, 3875.83443422797,
#        2088.845542348, 0.265289536440745, 0.263064659448664, 0.208158060060431,
#        0.098783900866168, 1000.53616646723, 974.967741825833, 0.0359908661128857,
#        NA, 2644443.00653416, 2452688.24662455, 2370532.59513184,
#        1746843.22842019, 258840.747655622, 239987.804050144, 231886.111421249,
#        170995.746363768, 8.73955706077533, 8.31394929091331, 7.82945467714225,
#        5.77353873387931, 29617.1471684012, 28865.6805150877, 10.3018744906275,
#        751, 172363.795508447, 166883.854307209, 155628.904469869,
#        112457.754233293, 16696.3024251288, 16169.3888622575, 15047.5029684423,
#        10899.9402725778, 0.311045841801204, 0.304425864777366, 0.280145945962142,
#        0.197854672900316, 1663.6005389787, 1621.90277056483, 0.0247427796937637,
#        NA, 686668.702900187, 634282.690168651, 523970.51499513,
#        395115.44445336, 66515.341023636, 61426.6213512923, 50750.5991375514,
#        38293.6168162463, 6.795305103459, 6.43206607256721, 5.1847558776021,
#        3.91213223561276, 9788.42598101707, 9550.06068940696, 10.3747747747748,
#        322, 66977.2861017247, 65344.3172315831, 52721.2416725253,
#        37416.7504715762, 6450.79580591048, 6291.53259647734, 5071.298012754,
#        3605.85692469862, 0.381157341979156, 0.36876715941146, 0.300815951496285,
#        0.196558821313238, 831.144051785545, 810.870081116431, 0.0415207543632187,
#        NA, 8213619.70038065, 7761437.25545366, 6841022.6403503,
#        4381353.17210634, 809372.587472363, 764943.899519132, 673832.33594324,
#        431209.609966955, 8.98565305940197, 8.71423436409236, 7.48088542249907,
#        4.78728834039663, 90073.8746668492, 87780.9647478772, 10.2298779306336,
#        1582, 340799.184877671, 333995.320912615, 284896.005809557,
#        179099.231824748, 33518.5298575015, 32859.1223102119, 27986.5077850127,
#        17556.8981627412, 0.195884788681132, 0.196512850095277, 0.163705163714466,
#        0.0987445365613301, 3201.98016251359, 3121.96078502582, 0.0169584124877272,
#        NA, 621975.280820188, 599658.039833416, 514665.187347558,
#        274319.005284097, 62222.075315115, 59982.4327072404, 51495.1082738847,
#        27417.4099769871, 8.81902237571197, 8.73027846267469, 7.29863974814708,
#        3.88599626172193, 7055.43910246534, 6870.62078989673, 10.1274468085106,
#        266, 65472.0425498674, 64832.8869538209, 54335.2508688595,
#        28435.6373568118, 6619.33336625399, 6554.47512704703, 5498.74513088442,
#        2863.11365275015, 0.532379913381943, 0.540795162585538, 0.446653705167028,
#        0.219549563220965, 650.008016449338, 632.868155445136, 0.0395873372050692,
#        NA, 1014388.11599922, 935077.566101982, 808257.977324796,
#        463036.119379114, 99942.5958475704, 92204.8243281506, 79633.1055462163,
#        45612.3785937907, 12.1463093579143, 11.5061066444205, 9.67803894718728,
#        5.54340275287094, 8228.22743127728, 8013.55551252974, 10.2142981691369,
#        322, 92197.229741169, 88768.6657492679, 73521.9965436808,
#        42169.8016834586, 9112.09081252397, 8790.19854972918, 7269.81842318188,
#        4161.45850060173, 0.594319809447542, 0.585307992224963, 0.476185852774679,
#        0.2683521824691, 700.417773506137, 682.323362484827, 0.0372198874992966,
#        NA, 1306.57810846998, 1306.57810846998, 1084.63116383861,
#        652.301551650382, 130.657810846998, 130.657810846998, 108.463116383861,
#        65.2301551650382, 50.6853688995217, 51.5120175069231, 42.0755026451913,
#        25.3043768028889, 2.5778210494238, 2.53645299040049, 10,
#        1, 1306.57767627867, 1306.57767627867, 1084.63080506315,
#        652.301335881376, 130.657767627867, 130.657767627867, 108.463080506315,
#        65.2301335881376, 9.51820431832689e-07, 8.94966683656228e-07,
#        4.54866789341456e-07, 2.74766891269394e-07, 2.57782019672939,
#        2.53645215138986, 0, NA, 271022.963202617, 235983.24933813,
#        209107.655291196, 118084.053515315, 26467.159407865, 22996.8220115546,
#        20420.5129940311, 11531.4333586623, 3.94218197938041, 3.51555568983457,
#        3.04155716502207, 1.71756281368964, 6713.83501479675, 6541.44722498671,
#        10.2589446589447, 224, 33835.2032161909, 31984.9259769881,
#        25949.1996515782, 14932.3502817317, 3292.93002986286, 3106.31076256708,
#        2526.93903742136, 1456.18860299877, 0.265329432770254, 0.253495994431879,
#        0.203964788912365, 0.111207095874829, 707.14789362911, 689.364651405083,
#        0.0429682931276711, NA, 1840799.88518573, 1662653.62707663,
#        1700070.66021318, 1202246.11340985, 179717.469774873, 161824.721632254,
#        165916.684945973, 117376.568143174, 8.68521258056422, 8.02760818463344,
#        8.01826155923187, 5.67246160085368, 20692.3512933978, 20158.5226770311,
#        10.3, 535, 138934.490750866, 133493.492007848, 127423.484500568,
#        90375.3223817762, 13574.5399673374, 13007.4698294474, 12444.8030868634,
#        8825.58455716671, 0.356075190488318, 0.32265071834479, 0.321973580919898,
#        0.225289048926177, 1439.11729078269, 1402.90822006418, 0.0303285092126776,
#        NA, 704798.204988495, 603250.235357743, 547599.971800698,
#        398469.541658067, 67820.5110501821, 57953.5519611244, 52648.146337472,
#        38364.3219153479, 6.29468582547938, 5.51565945870652, 4.88647955252115,
#        3.56074216524236, 10774.2487759533, 10507.0939195936, 10.4,
#        337, 61161.0105176753, 57386.1373015135, 48144.5827995871,
#        34028.8959238023, 5841.72173780131, 5462.99101470551, 4589.9755791124,
#        3250.13044169267, 0.329945266136304, 0.288904902010947, 0.255269615490925,
#        0.173609523075473, 872.726107972612, 851.392020384412, 0.037764884083605,
#        NA, 4616784.90462722, 4178816.14979796, 3913557.70171751,
#        2554442.69204091, 452018.578822478, 408686.661858273, 383051.058840482,
#        249796.475117878, 8.00950466075253, 7.4323024353039, 6.7874405717601,
#        4.42624733901026, 56435.2725877569, 54987.8944534046, 10.2676025917927,
#        1122, 225446.950298813, 215522.399119057, 192771.285146683,
#        126458.078612924, 22138.0417222242, 21151.7580584934, 18916.4082223305,
#        12366.457538465, 0.216904283759287, 0.204497387905837, 0.184139764419646,
#        0.11770300260676, 2494.1128798227, 2430.99077338067, 0.0200445310046681,
#        NA, 275787.724292771, 253403.586155013, 226908.683692812,
#        120530.397845049, 27682.5765875838, 25439.2683678643, 22771.649303255,
#        12084.1659364171, 7.27193029719731, 6.86224751091692, 5.98187982833086,
#        3.17438704129893, 3806.77144254986, 3707.13360708628, 10.0980810234542,
#        130, 39970.7785835067, 38726.0335666978, 32828.110682293,
#        17608.7452420895, 4033.35973502829, 3903.80018970186, 3311.36183006191,
#        1773.59006137191, 0.475582009698855, 0.458275800139556, 0.394584534944012,
#        0.199025545829367, 519.740553304247, 506.625217522785, 0.0555691462820393,
#        NA, 601850.029512855, 553762.456283086, 482174.979105569,
#        280628.487044034, 59501.7474723892, 54716.38022791, 47687.6570252827,
#        27748.4073510843, 11.4934665205034, 10.8500226304997, 9.21143517197829,
#        5.35993318574334, 5177.00620315402, 5042.97383436792, 10.1345767575323,
#        194, 71631.5956095614, 69418.9105949557, 57326.385906288,
#        32736.367696245, 7064.33844356213, 6842.81479981682, 5661.89127120489,
#        3233.34761669673, 0.644365573637972, 0.663683030284247, 0.511660581214061,
#        0.287628047494307, 563.306077849202, 548.879860877202, 0.0425839474079928,
#        NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, 0, 0, NaN,
#        0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, 0, 0, NaN,
#        NA, 141621.839501979, 118504.240025065, 111420.326551367,
#        60179.8315924003, 13727.8475182294, 11377.7215331163, 10799.9314106586,
#        5833.79449650884, 3.36680441275932, 2.86506611510319, 2.64872236398451,
#        1.43075926709523, 4077.4116447645, 3971.18986997845, 10.2368539325843,
#        127, 28732.4826656082, 27448.4870937019, 22306.7231517806,
#        11530.8093510872, 2646.28813809556, 2503.7209519268, 2048.36087002529,
#        1054.8583272402, 0.415846640220984, 0.422003196401469, 0.314292916219148,
#        0.148728975104527, 554.86311997555, 540.499398095246, 0.057175984862777,
#        NA, 639570.443660677, 578311.137892176, 594375.028045688,
#        405765.005366282, 63042.0565024848, 57067.3820467667, 58598.1813276464,
#        40023.3940005327, 7.11818197078814, 6.61935254206466, 6.61641673810222,
#        4.51910704361481, 8856.48284368103, 8621.29365132238, 10.2229591836735,
#        240, 70259.8861778726, 65102.1014320261, 65467.9753290975,
#        44608.331454003, 6906.14802089067, 6380.44109674562, 6435.5902879527,
#        4391.42389912553, 0.479440842672969, 0.430307598024194, 0.445216559472424,
#        0.303847753759014, 837.614540531694, 815.585189701157, 0.0436342757834894,
#        NA, 1029075.57208749, 903582.49588347, 810173.865369765,
#        574057.924643949, 99849.8755816812, 87531.7814895211, 78480.2845813473,
#        55686.1995623813, 6.31814424600857, 5.68294709232754, 4.96595269212058,
#        3.52362423385626, 15803.6714094903, 15402.5332397862, 10.3287316652286,
#        363, 87895.220175611, 85013.6790359047, 69009.9540940686,
#        47929.1930105888, 8534.41943443774, 8260.82718802875, 6672.43739906041,
#        4650.89797167356, 0.270350441729988, 0.255531004653937, 0.208293192935949,
#        0.137769731297871, 1248.13887628193, 1216.85620032236, 0.0365526898209475,
#        NA, 2743755.85169042, 2457629.96854616, 2270499.69475853,
#        1471737.3108707, 269249.239190514, 241004.60417151, 222775.3918996,
#        144356.253970987, 6.93977791608714, 6.37674133891817, 5.74193542607778,
#        3.7207174526056, 38797.9619011101, 37794.3202275783, 10.2425565700675,
#        756, 161947.515511327, 154602.030983072, 134271.734246792,
#        86571.003603955, 15922.7449045469, 15182.1446357243, 13194.0830476794,
#        8509.65673807873, 0.211316501948099, 0.201307103463217, 0.176310692136055,
#        0.109801419447066, 2074.56030358584, 2021.76396794453, 0.023872202408598,
#        NA
#      ), .Dim = c(16L, 2L, 7L, 9L, 1L)),
#      VB.A.bagr.akl.dkl = structure(c(
#        164601.666771908,
#        159068.517373039, 122556.019151374, 101913.94283134, 16224.2160782092,
#        15670.35852698, 12069.0505005601, 10075.6253481721, 0.273630153958191,
#        0.270286165947464, 0.203551045589992, 0.16993085533102, 10.1032300767805,
#        40754.4628675392, 39796.7817333635, 31064.3951496661, 23405.7085226711,
#        3945.89641656815, 3843.5055005196, 3001.69897224024, 2283.26456798477,
#        0.0656673543559168, 0.0654357293823441, 0.0499917413537403,
#        0.0378918554557618, 0.0117742644081858, 16956.5246337499,
#        16956.5246337499, 12224.3245067848, 8769.66105930804, 1704.87001158061,
#        1704.87001158061, 1228.87391884129, 882.221548338703, 0.153684192943003,
#        0.157285273523283, 0.110775892099091, 0.079527181387664,
#        10.1086597938144, 11711.1925278546, 11711.1925278546, 8538.90022718331,
#        5953.02924796239, 1173.49761849362, 1173.49761849362, 855.483125894881,
#        596.823616783546, 0.105099132738128, 0.107566488154876, 0.076624264979963,
#        0.0534379081603987, 0.0156085409970514, 15901.0944050626,
#        13047.8278549802, 11276.1694856168, 9638.102020574, 1541.8610971348,
#        1259.35945851277, 1093.00788669945, 934.072039315894, 0.295743483428634,
#        0.246390301829006, 0.209649209275824, 0.179163816503257,
#        10.209785202864, 10225.7476581012, 9820.03775431331, 7314.68658155758,
#        6143.83522282902, 977.005815623787, 935.314409689038, 698.498291306077,
#        586.538287461701, 0.18383229550629, 0.179807867253744, 0.131428875448771,
#        0.110416678183352, 0.0297192791429559, 3513.95753038554,
#        3513.95753038554, 2143.39654326164, 2704.67873691203, 362.491661179032,
#        362.491661179032, 221.379482171101, 282.700840180099, 0.158636531519702,
#        0.162170490300614, 0.096881878846604, 0.12371782732328, 10.1318908748824,
#        2583.66258985171, 2583.66258985171, 1568.80113297131, 1920.90716786575,
#        262.512931267796, 262.512931267796, 159.725958900624, 199.95906134374,
#        0.10959690195821, 0.112102364255669, 0.0666101550739859,
#        0.0825919470720877, 0.031841064202529, 23367.1939311758,
#        20166.3905300141, 20015.9417575819, 22358.3471665176, 2327.50288906836,
#        2013.69863405251, 1993.37881815168, 2225.92213445966, 0.0904629395663857,
#        0.0800234398828387, 0.0774765558428798, 0.0865148054057647,
#        10.1716967126193, 8384.11873300834, 7750.01873695149, 7232.10644849941,
#        7984.50774744608, 837.664091047671, 776.755965138564, 722.510813928563,
#        796.712725533207, 0.0323739393795496, 0.0306457875223518,
#        0.0279235054270638, 0.0308083081201034, 0.0106698059715967,
#        12269.785509759, 12269.785509759, 7944.16806687629, 9589.26599212916,
#        1292.87386273744, 1292.87386273744, 833.56375079479, 1011.45978987848,
#        0.232311405418598, 0.237527113985619, 0.149779782880847,
#        0.181745220538029, 10.2257735247209, 7782.76967278107, 7782.76967278107,
#        5448.89201219757, 5943.28402888738, 812.452282297447, 812.452282297447,
#        565.678621775358, 621.576848958936, 0.141546704142928, 0.144738727859923,
#        0.0989071519755964, 0.108190776425621, 0.0188784382229348,
#        518322.877721555, 478606.732631191, 387852.327450898, 367639.672361569,
#        51727.1097406814, 47778.8105979002, 38658.5085737582, 36745.5427964812,
#        0.291146940845508, 0.274974905025564, 0.217590090869656,
#        0.206822929572834, 10.1489401063748, 62433.2636004542, 60721.7440290652,
#        47697.1533119657, 42006.1917076671, 6214.5447880017, 6046.00656260907,
#        4733.88731915039, 4205.66257665902, 0.0341840976281223, 0.0340069537947664,
#        0.0260572208722427, 0.0230701987476592, 0.0089443402357497,
#        8540098.36137485, 8139119.07031288, 6659692.20125055, 4382491.93966897,
#        842651.698776517, 802681.360989388, 657067.800688344, 432529.39613717,
#        10.8354246404906, 10.5752068583164, 8.44905273245008, 5.5617756226516,
#        10.1382388713208, 459745.643542899, 452830.47330599, 360825.657561198,
#        230435.867798424, 45389.4257967832, 44682.0466767539, 35622.9029305869,
#        22749.9072486399, 0.449570312477336, 0.456262135758557, 0.354172619704049,
#        0.222165092751016, 0.0162404613017379, 564264.277109609,
#        483446.053879741, 435814.34913874, 270145.914283975, 55752.1617018118,
#        47792.53547864, 43049.3716527677, 26702.318828963, 5.99317071695312,
#        5.25653175030032, 4.62766331738873, 2.8704098710362, 10.1052824651504,
#        97169.6141735738, 92649.6429520922, 76218.1938926985, 45174.395744416,
#        9580.6138263763, 9138.62242985029, 7511.23496525031, 4457.32087268826,
#        0.935297418703417, 0.915992238134732, 0.735044551222554,
#        0.433661372689602, 0.0281570684449567, 1098959.27078472,
#        1079508.68510923, 812113.930984871, 596821.58847396, 108870.315363052,
#        106961.615969194, 80468.0593378069, 59096.7398488729, 7.22272971416446,
#        7.27054210330955, 5.33845283061954, 3.92062590700973, 10.1970432946146,
#        139325.442589503, 138437.704241898, 103523.524222019, 74526.7548922516,
#        13905.5185795526, 13818.1749550097, 10337.477040802, 7426.25432098345,
#        0.680344311147036, 0.693274491574808, 0.507579542470513,
#        0.359271687925707, 0.0326545345900237, 445388.353076974,
#        440178.973215979, 326956.189128, 220106.146542378, 43923.6243074649,
#        43396.2202283466, 32232.5822018024, 21722.8864062064, 10.2265808600212,
#        10.3563506743773, 7.50459720506238, 5.05766219998309, 10.1135802469136,
#        81104.9648333337, 81022.938419667, 59765.0395259993, 40098.1354812167,
#        7974.0387148014, 7965.53168282344, 5870.8918588644, 3951.5660604799,
#        1.33313942860484, 1.36224390110013, 0.979719697910081, 0.665129263540792,
#        0.0476084901662539, 909468.930564674, 693947.545328958, 795050.76773401,
#        768775.341297846, 89914.4703818491, 68834.2269680312, 78577.6813815607,
#        76089.7982411023, 4.62608721986691, 3.6233818366449, 4.04281097427665,
#        3.91480972651619, 10.1636877076412, 87123.9544946084, 79375.2334639951,
#        76386.622390961, 72855.8675012058, 8578.01222084606, 7849.07678205973,
#        7515.0829013329, 7199.06804509075, 0.38768544402669, 0.359486795744735,
#        0.340100965780013, 0.324211193836921, 0.0187148450979728,
#        224912.50842074, 212060.321583627, 164913.338120214, 168249.131597131,
#        22313.8965448267, 21094.0622223066, 16359.5412357856, 16691.9090232208,
#        3.87546041400396, 3.7502708155815, 2.8413125570958, 2.89903793914673,
#        10.2032454361055, 45168.7336151902, 44660.0866592788, 33565.4682843738,
#        33281.7641740714, 4481.61291602377, 4436.0921610009, 3330.01605855183,
#        3302.07514892303, 0.566550676155908, 0.570302605016187, 0.429942169863037,
#        0.408064110395656, 0.0435489688531794, 13500917.778057, 12545050.3135319,
#        10539907.5582368, 7539922.62754191, 1332300.73637148, 1237992.96524753,
#        1040052.51649467, 743994.844990613, 7.8222882831068, 7.44450872217735,
#        6.10642206484798, 4.36818955344271, 10.1713179278822, 558638.094548909,
#        548689.833274609, 437842.34660451, 298611.488322951, 55152.6430446119,
#        54158.4641324049, 43229.2952381508, 29467.3644586187, 0.249856927344837,
#        0.252788415071932, 0.196354910965532, 0.130962082130537,
#        0.0116495238760414, 20467221.7404617, 19800315.9027597, 16272305.5599029,
#        9531763.49604424, 2016459.03602111, 1950983.37602327, 1603104.54144965,
#        939287.571217436, 16.509689010281, 16.3798430227358, 13.1253633014669,
#        7.69038468672354, 10.1375140186916, 834199.647123805, 820672.197341359,
#        664332.75403101, 384138.174193798, 81998.3898085843, 80676.0546344462,
#        65296.6470471063, 37771.858018587, 0.512355355608297, 0.520026408764378,
#        0.408576018527457, 0.234099867479197, 0.0143026783154952,
#        1017880.63537713, 877372.775170662, 801137.868266314, 464682.450153758,
#        99987.7760508441, 86288.3895518755, 78690.7460665033, 45667.2323975025,
#        9.1171921395303, 8.05899282081936, 7.17526361548915, 4.1640783373049,
#        10.101231367466, 122089.544258514, 117715.058559453, 96525.0352656106,
#        55022.0175951412, 12060.0533973624, 11640.5096708205, 9534.33237349437,
#        5436.36760445979, 0.915930833531695, 0.905042999069445, 0.723706929437271,
#        0.412886184875809, 0.0280899893334502, 1185610.46053744,
#        1169726.7512716, 891180.03804, 596536.373998841, 115974.4049108,
#        114463.445124041, 87172.3339710677, 58348.2993264535, 8.69551669156119,
#        8.7938026748497, 6.53599805638816, 4.37483262886857, 10.2653914590747,
#        146694.118137062, 146165.955860992, 110400.83927492, 73732.2263148865,
#        14453.2892505349, 14403.7606311856, 10876.1698450614, 7261.14648056766,
#        0.816098408754207, 0.834680586572344, 0.614479027349161,
#        0.410007222244544, 0.0290866656532318, 1421362.83893944,
#        1393405.22246572, 1075584.32583738, 675247.92590183, 139784.555514676,
#        137082.682649691, 105788.361215359, 66412.0551091404, 9.4702368751502,
#        9.52179822651254, 7.16703526834347, 4.49933750501538, 10.1411883182276,
#        156974.012376075, 154657.157499585, 118321.846596903, 74859.051389401,
#        15265.3355497255, 15058.9701488563, 11511.4651808901, 7277.35416746712,
#        0.796469127529213, 0.812003176833335, 0.599600321001992,
#        0.379533579245714, 0.0338561364082387, 3202137.93102366,
#        2731650.00986993, 2840488.24083022, 2470239.96011362, 315895.023420716,
#        269496.274635621, 280225.307330735, 243710.079823765, 8.10118732907667,
#        7.07864644292985, 7.18643074668172, 6.24999086486741, 10.1730769230769,
#        204802.780568313, 193482.614135829, 181934.470502677, 156416.054908671,
#        20308.879326223, 19177.7928363682, 18041.5506278039, 15512.1573848109,
#        0.41586854434015, 0.39505539427994, 0.370014293293191, 0.315517622698398,
#        0.015887744634205, 522398.794972297, 495295.657903836, 397341.051607492,
#        338922.211939723, 50870.4937921344, 48344.3084362183, 38696.5206493539,
#        32993.9725390563, 6.44985804830068, 6.27849312329946, 4.90632283168558,
#        4.18329808623459, 10.3190034762457, 68760.4320910267, 67949.1937170291,
#        52447.8225676391, 43963.0472114873, 6772.5083045129, 6703.26368794188,
#        5165.69973628336, 4329.79185931428, 0.728335355138343, 0.739920374185539,
#        0.556862239808552, 0.461727963729082, 0.0339427546166532,
#        31752374.3863842, 30136448.6682261, 25342658.6693496, 16450786.0001746,
#        3124111.6234119, 2966058.03877368, 2493616.82383999, 1618186.54572703,
#        12.0030333857871, 11.6806494125497, 9.58063270326548, 6.21717450402133,
#        10.1623028221912, 1018540.73260344, 1000047.45786217, 811221.210744926,
#        509938.219481864, 99985.9422019626, 98186.6489340759, 79647.643179539,
#        50030.1692214559, 0.286860759329676, 0.290451637835384, 0.228360112098484,
#        0.140310798172541, 0.0107132991917734, 14786823.0498919,
#        14290568.5302871, 11765215.278096, 6742450.2162543, 1461458.2688481,
#        1412118.1003548, 1162819.42380856, 666434.053076934, 21.5092986044703,
#        21.3187940767226, 17.1140228516344, 9.80837383685093, 10.1242729831144,
#        781084.604431422, 770111.749354302, 622412.49592339, 352392.017159729,
#        77088.862904721, 75973.9508806265, 61430.0246868468, 34784.5102369525,
#        0.897788870482499, 0.90812950915787, 0.715898765703805, 0.403627231503592,
#        0.0157236876160505, 1288532.35920189, 1250231.17368852, 1015960.43328273,
#        570606.61371136, 126062.045330944, 122224.956835273, 99387.6636287993,
#        55813.4674968996, 10.8527900293168, 10.7761981428673, 8.55636954038023,
#        4.80502947545989, 10.1521093285799, 150267.442403526, 149688.554088585,
#        118431.3265224, 66271.8466124803, 14725.5569760242, 14663.9891413326,
#        11602.7216977237, 6492.01968897812, 0.996752191990831, 1.01911516296038,
#        0.785220163833675, 0.438848863102728, 0.0261167904448117,
#        234397.387711271, 234397.387711271, 177239.43141706, 117579.369603559,
#        23097.7268743274, 23097.7268743274, 17465.1277303444, 11586.6403735845,
#        7.43357751178432, 7.62004112750614, 5.62082933282193, 3.72894656633686,
#        10.2627118644068, 73330.80296263, 73330.80296263, 55461.8331169693,
#        36468.4492643515, 7287.52405314896, 7287.52405314896, 5511.68037759754,
#        3623.56396263362, 2.1774650460358, 2.23302525646946, 1.64713358768832,
#        1.0820670834543, 0.0435527158703251, 978405.025160521, 977061.41219503,
#        748666.143385089, 463472.853677964, 96500.3404840475, 96383.5045740048,
#        73842.8143396795, 45712.2174118914, 9.59428890775651, 9.82332808160355,
#        7.34162481689718, 4.54481526452609, 10.2092771084337, 121576.08823798,
#        121569.874613723, 93123.411953306, 57361.2037774466, 12112.8215623663,
#        12112.3623454125, 9278.50553613622, 5717.52679934347, 0.989567533211139,
#        1.01767713447205, 0.758391498984259, 0.464156327274419, 0.0340137263242301,
#        3917241.48274823, 3581605.40590527, 3499625.05727285, 2857453.14447994,
#        384669.421959457, 351901.351185036, 343666.329819625, 280554.221704827,
#        8.57107169965029, 8.03490690313057, 7.65745490929644, 6.2512126324538,
#        10.2244469525959, 242317.756984236, 235412.96628278, 216685.250570649,
#        175429.08835443, 23851.4971543948, 23183.5298196885, 21328.6046695301,
#        17267.9148017815, 0.419749834979943, 0.41481984370498, 0.375422981790366,
#        0.303426952812164, 0.0157117667219809, 582779.85314234, 549313.464979313,
#        445222.817957035, 369242.594821968, 57091.3423028367, 53776.4372209581,
#        43611.737510558, 36162.936645438, 5.17928876903476, 4.99892170241816,
#        3.95642794818824, 3.28067766614284, 10.264888457808, 77873.3966933765,
#        76882.6070506173, 59636.575226113, 49094.2522993498, 7550.51064046667,
#        7447.60531091185, 5780.7159305377, 4759.05459569852, 0.63847978405297,
#        0.640522114101831, 0.488666921141723, 0.403190854986719,
#        0.0309233539155666, 24596749.9217483, 23515266.0274845, 19862939.7677413,
#        12859892.7092621, 2423880.16473576, 2317289.48004177, 1957354.60974503,
#        1266450.41369128, 13.2393433803837, 12.9762510599232, 10.6911596425462,
#        6.91740959187053, 10.1790796963947, 934570.388733266, 920215.515962597,
#        751099.617186485, 465978.25575237, 92048.7066704707, 90613.5065031957,
#        73977.4157669587, 45857.6442032151, 0.40365797597657, 0.407518896231817,
#        0.323616008535581, 0.196408908364509, 0.0113329205858632,
#        18877642.2203479, 18294719.0297836, 15070554.2670755, 8517809.74010817,
#        1861676.02950046, 1804111.24895182, 1486227.01223688, 840045.276470491,
#        27.8866271132606, 27.7337337354567, 22.2626589369722, 12.5833007526419,
#        10.1204804358593, 1021683.9966238, 1011917.09081811, 816883.002192477,
#        457424.383664861, 100145.337440734, 99187.5086776849, 80066.130949245,
#        44848.9389537958, 1.20614260017504, 1.22518816860716, 0.96491913017458,
#        0.539220314718781, 0.0158503473625613, 2406923.23571178,
#        2300603.43107806, 1905266.17270942, 1066133.12234757, 237259.124281876,
#        226681.979786472, 187796.191961691, 105082.74045658, 14.3563042606501,
#        14.0561948743227, 11.363353375571, 6.35844795897201, 10.1274314214464,
#        232830.120750522, 228283.376211021, 184581.251774954, 103002.49530291,
#        22779.3573034897, 22311.0354354867, 18056.3202684557, 10076.2226339305,
#        1.12554414157936, 1.1309774146726, 0.893435311983246, 0.497803059230472,
#        0.0228832334817858, 260511.822487404, 245433.135790765, 198732.25680317,
#        131824.092265989, 26154.479498161, 24642.6415053473, 19953.0464960313,
#        13237.8624513122, 10.5581216499533, 10.1979781412979, 8.05470788310222,
#        5.343901497108, 10.2281690140845, 78178.6968008331, 77453.6061125502,
#        59596.8939414207, 39193.9989963152, 7979.19242118887, 7907.58856513952,
#        6082.83318070508, 3999.97811275077, 2.09783625267676, 2.13408039814004,
#        1.60082229065126, 1.05842641067291, 0.0591926072777267, 1208081.95131175,
#        1159645.27644382, 925198.74637321, 569439.130668927, 118175.312578512,
#        113532.229116855, 90515.0182024637, 55743.5014458709, 9.41714571789796,
#        9.2771495730403, 7.21295419044887, 4.44208409089557, 10.217363851618,
#        145016.140411866, 143349.412544757, 111002.228452229, 67156.7964873008,
#        14209.0004820256, 14048.8173368181, 10879.4268447865, 6595.56606342862,
#        0.987075148865571, 0.995501868358284, 0.755919466450505,
#        0.4573336753754, 0.0281483648608698, 4639265.49714751, 4401790.32919195,
#        4160131.84261079, 3269905.20912288, 456713.686122742, 433163.231962578,
#        409550.542142323, 321862.156064877, 9.6363221364617, 9.36596321821468,
#        8.64121456212573, 6.79105425043846, 10.2052209873352, 314122.922259898,
#        307862.713278188, 281985.505294307, 219356.681349453, 30965.6877633183,
#        30284.5304829995, 27798.5193590691, 21622.4521734917, 0.518922423655281,
#        0.518287395057594, 0.465955220877523, 0.361755015369164,
#        0.0168873081390077, 682793.302463323, 639826.055343075, 525593.486821434,
#        421633.712112911, 66795.793302935, 62657.1390187534, 51415.2372325221,
#        41238.2188524278, 5.44166423431042, 5.22805463292506, 4.18865386144769,
#        3.35956097711413, 10.316906747536, 93508.5809939382, 90455.0754892306,
#        72000.7063321711, 56478.6932798389, 9181.47443726105, 8876.96860962844,
#        7069.08981668934, 5540.12463445385, 0.616092630409233, 0.61154153253239,
#        0.474401318557546, 0.372219497142018, 0.0283195901910962,
#        29981149.2693914, 28876713.7017516, 24316318.0525937, 15170365.1499985,
#        2953082.30019726, 2844002.38696323, 2395028.01114484, 1493810.44952453,
#        16.1647591855483, 15.9634056869564, 13.1100481148842, 8.17690932074824,
#        10.1839086294416, 1208708.32079051, 1190215.6627484, 975482.563142825,
#        585499.439630833, 118786.41811286, 116915.532976772, 95874.7039831733,
#        57586.3499484438, 0.524303296189258, 0.529554510839223, 0.421933279707779,
#        0.247576330642321, 0.011581658130581, 13975737.7912423, 13400434.0402312,
#        11208931.207082, 6276771.46105825, 1381044.39406666, 1324025.6003615,
#        1107627.88224636, 620364.96622576, 30.6928180529913, 30.2102853133829,
#        24.6163129920113, 13.7872099670521, 10.0994770839742, 958055.362389463,
#        942722.773017166, 769799.636311846, 423612.892329916, 94138.159011437,
#        92628.1977091484, 75636.3963116588, 41638.9640687125, 1.72906257250486,
#        1.74147356210514, 1.39039668839319, 0.761992075111485, 0.0181338329224343,
#        2838861.89346154, 2705061.17866147, 2247812.3722773, 1260701.59896744,
#        280396.985647738, 267117.078579315, 222016.444171873, 124520.796654315,
#        15.9442756135062, 15.5738458529508, 12.6245700125112, 7.08065351303032,
#        10.1220941883768, 267731.32130275, 261708.06527891, 212176.488451343,
#        118653.198412659, 26495.6903281006, 25894.5019242825, 20997.2680578186,
#        11739.7547656668, 1.22878983268178, 1.22940190327099, 0.974746402061141,
#        0.543524964954799, 0.0237672270305701, 196179.363256053,
#        186319.111555721, 151167.408890978, 101289.49732653, 19066.372322828,
#        18049.8515289793, 14692.8914768299, 9843.57720168164, 14.6103792275672,
#        14.1876387955407, 11.2590225760437, 7.5430393069693, 10.3765957446809,
#        71300.1048078844, 70617.933589824, 55035.2179673374, 36838.240797022,
#        6943.36665057684, 6868.85305690864, 5359.36421602332, 3586.51275368338,
#        4.44886299500872, 4.45702115690513, 3.43629783869034, 2.29762277434238,
#        0.0907993187385513, 1694869.45161884, 1621099.6471603, 1299968.85149242,
#        799842.273843152, 166383.873441201, 159013.052146986, 127623.131416177,
#        78504.3714596243, 12.6205235270933, 12.3707507258109, 9.68044978955477,
#        5.95470129703402, 10.2284820031299, 173746.152489026, 169225.490462668,
#        133162.557177286, 81214.9904184274, 17036.7718207545, 16591.6303207684,
#        13059.8960629507, 7968.45117744851, 1.0618337812065, 1.05490164738004,
#        0.813770592413177, 0.493546074303292, 0.0293906717949848,
#        4533563.04764524, 4333502.45223515, 4077217.25903357, 3128656.40357744,
#        446233.732716839, 426448.258089872, 401309.524893994, 307986.049424413,
#        9.33266916503367, 9.14339932442298, 8.39311050244848, 6.44131471017159,
#        10.2028296207104, 343621.734351031, 335467.28324421, 309246.188417976,
#        235388.167201886, 33882.3603657715, 33096.774171763, 30491.3533360129,
#        23215.0899489736, 0.550269086964183, 0.551440167828866, 0.495352338273245,
#        0.375983492682592, 0.0188481909507368, 746993.19935387, 743051.709818521,
#        577583.368133722, 458680.824933987, 71893.8596677889, 71548.1149717056,
#        55589.3194253992, 44151.0449020353, 5.72413282896827, 5.8410620936917,
#        4.42597809789723, 3.5152716341118, 10.3619364375462, 92283.7869100929,
#        92203.1395916798, 71440.3149270198, 56303.2606760004, 8852.22584342786,
#        8845.78498461032, 6852.63785284571, 5401.53164798748, 0.646100069164614,
#        0.6621666887159, 0.500462764474255, 0.392926319156912, 0.0298031279454808,
#        25084186.7535645, 24032797.388817, 20444279.1721047, 12723494.7447636,
#        2473589.12656597, 2369657.55796403, 2015955.47399472, 1254112.51397264,
#        16.4894634846483, 16.2028495355435, 13.4387816546001, 8.3601768307825,
#        10.1881164587047, 1146489.50457548, 1126187.07291365, 930538.838116761,
#        552790.060982992, 112809.667777208, 110820.055502438, 91559.2800831564,
#        54396.7705482606, 0.634950632258515, 0.639166486691924, 0.512989243189229,
#        0.296113154925582, 0.0128092762497151, 6402099.95152697,
#        6093681.71028094, 5145623.43800317, 2907586.64108658, 640569.690246206,
#        609972.880223616, 514851.108742588, 290908.618994693, 32.5750501541044,
#        31.855998310801, 26.1818517868679, 14.7936485261597, 10.097875569044,
#        600860.66656769, 581249.676251327, 484035.328497891, 269636.011712707,
#        60492.3295342708, 58408.2071326885, 48733.996028847, 27142.1926930848,
#        2.45456383861301, 2.43143918478216, 1.98046673300025, 1.09658154007651,
#        0.023783268562542, 2632178.10333042, 2540372.96548253, 2089070.95495691,
#        1176662.49278153, 260660.001771813, 251612.078156784, 206870.703479973,
#        116531.085402431, 18.972686323754, 18.7796554807503, 15.0575191437917,
#        8.48196008316762, 10.1307980049875, 269172.352444765, 266461.213060981,
#        213694.151606975, 120167.222317071, 26633.9270709812, 26371.4073577224,
#        21142.2209388918, 11893.4476830482, 1.54017028958115, 1.55746270274276,
#        1.22277321462162, 0.687750738520587, 0.0268056463789367,
#        62443.0574525383, 62443.0574525383, 48242.8013737087, 31641.6833657046,
#        5709.81061036267, 5709.81061036267, 4411.1044228119, 2892.72264583428,
#        27.9780350295033, 28.7410716843957, 21.6143831174095, 14.1743222391484,
#        10.3692307692308, 45803.3385621603, 45803.3385621603, 35401.7768967486,
#        23248.3199045081, 4157.60742164531, 4157.60742164531, 3213.1746691862,
#        2109.55623266779, 14.3815017617218, 14.807495050061, 11.129453336584,
#        7.33575391917826, 0.160894790837111, 1208780.82346337, 1133533.81306745,
#        928743.304067898, 571013.479434098, 119139.283573687, 111675.098766832,
#        91532.9229933616, 56275.8297029329, 10.4941177375286, 10.0959404454575,
#        8.06247311499378, 4.95693078693413, 10.2526717557252, 154032.32504983,
#        145034.29810149, 118139.781203844, 72241.4306292145, 15393.6095015523,
#        14482.1675955604, 11805.169711806, 7216.12000210729, 1.00697413684818,
#        0.929450588368744, 0.771510745148564, 0.470697039526748,
#        0.0319933548524134, 3594472.39722304, 3404734.04930012, 3236754.17295966,
#        2456000.79298013, 351687.50543559, 332767.307939473, 316689.170379888,
#        240303.88195766, 11.8744558156097, 11.5281296682245, 10.6927641808042,
#        8.11367416960545, 10.2343113284434, 344740.859896479, 337811.39428578,
#        310642.514117167, 233704.918894707, 33485.274643135, 32774.709982965,
#        30173.2119607218, 22702.7090807046, 0.9119414118901, 0.914541967351999,
#        0.821975812595528, 0.617205561871331, 0.0211258393779416,
#        567195.841955748, 545977.767930686, 440558.122965823, 344495.311677184,
#        54865.7945840525, 52841.7152654787, 42617.923820646, 33332.0289374048,
#        5.60517029913237, 5.53312873959968, 4.35390980156524, 3.40524911789152,
#        10.2975975975976, 108610.302718299, 107906.891132915, 84339.9931681901,
#        65542.7489589611, 10385.4103953498, 10318.3362944576, 8064.7383158855,
#        6274.14642846726, 0.912884332031364, 0.931643724035814, 0.709092427603843,
#        0.54997257293733, 0.037039656321736, 15007127.6186613, 14259214.2103931,
#        12312197.591396, 7810056.31043066, 1485688.75587506, 1411749.84571002,
#        1218536.98060648, 771882.39217, 16.4941139855489, 16.0826421737881,
#        13.5281954408358, 8.56943697631433, 10.184072854098, 845583.35098328,
#        822238.057695638, 693158.645389811, 429737.72798464, 83948.9360359475,
#        81560.0257803515, 68758.9897347969, 42467.7744169124, 0.767337130753212,
#        0.762218491585795, 0.627647768785782, 0.381999581612171,
#        0.0146278201502411, 1749030.38650039, 1657513.90429877, 1406754.55299101,
#        804822.3862465, 175024.816150796, 165610.030566289, 140781.35178392,
#        80567.978390555, 24.8070763008412, 24.1040854430242, 19.9535917948363,
#        11.4192720283565, 10.0873404255319, 257273.33332507, 246249.314011783,
#        207133.334328417, 117821.708320035, 26017.2915459086, 24723.3281532135,
#        20945.4964380449, 11947.048344623, 3.15015710855846, 3.0531497604212,
#        2.53784711499748, 1.44543546784211, 0.0330855513254736, 1786429.18732493,
#        1712321.05409962, 1420000.00772422, 801802.558233594, 174836.710583542,
#        167529.792761029, 138977.237012781, 78483.3516752917, 21.2484052055914,
#        20.9058004900677, 16.8903008787164, 9.53830607269792, 10.1786399302528,
#        210926.831818353, 207911.778239303, 167709.278970337, 94559.795703805,
#        20343.522700745, 20046.112884064, 16176.9044619057, 9122.09436414926,
#        2.0118858687905, 2.01440265505179, 1.60082171472605, 0.902451642089967,
#        0.031308212028184, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,
#        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 762389.457584001,
#        697965.397419447, 587981.765918961, 363535.8650588, 74698.5918472954,
#        68599.2122456278, 57608.8828486674, 35641.3372964093, 11.1260690324778,
#        10.4868555667003, 8.58062235990341, 5.30864062311015, 10.2432432432432,
#        115708.478248071, 112824.927447582, 89170.1221302627, 55138.588667856,
#        11306.9944361669, 11046.5889433108, 8713.91666651753, 5400.32840426155,
#        1.32378443932176, 1.31106003556833, 1.01986498887872, 0.624896735196288,
#        0.0362519185225509, 3268871.43310086, 3054955.56445467, 2945835.82751916,
#        2228510.06608853, 319460.878465043, 298018.895178029, 287889.870736843,
#        217795.100196485, 15.4385972833823, 14.7837666456379, 13.9128640653176,
#        10.5253915859226, 10.2360830527497, 311413.282194002, 306668.164918582,
#        280692.353906523, 211880.594570109, 30417.605900826, 29912.9266136945,
#        27416.3182319122, 20700.8518410304, 1.17460815393124, 1.17179229536301,
#        1.05891815329132, 0.798504077580623, 0.0266274890769097,
#        707314.512855727, 660698.432494487, 551315.327781132, 434655.012149015,
#        68331.9014964827, 63708.2910054538, 53268.1602159655, 41965.8839613083,
#        6.34214996492287, 6.06335981128432, 4.9440254558492, 3.89501716861879,
#        10.3250939849624, 106392.302654872, 101715.693634293, 82988.4152642728,
#        65262.6299373654, 10227.152059891, 9780.11314943298, 7980.64940618759,
#        6262.00962457805, 0.811284339938763, 0.789103996677334, 0.633639634756188,
#        0.496247249070424, 0.0336734069326312, 8554113.84388507,
#        8026222.39990408, 7134342.48724766, 4805532.36998802, 839909.607119664,
#        787244.402877776, 700384.374599559, 471383.78207558, 14.8827066585636,
#        14.316685712432, 12.4104011991873, 8.35264472839353, 10.2183315334773,
#        553679.482862224, 537898.62916945, 463069.111126775, 311205.355591937,
#        54381.7621314169, 52633.1092059139, 45458.0384758971, 30530.5253819637,
#        0.787883043514617, 0.774902683917398, 0.656730294167995,
#        0.436076345555383, 0.0174160016914307, 791960.145646667,
#        709288.028703759, 635950.191239152, 369125.600879427, 80650.1637067072,
#        72337.2868752159, 64774.7856309813, 37567.6139105316, 21.1859747620377,
#        19.512996978836, 17.0156749908772, 9.86862869953861, 10.0390191897655,
#        124859.795060633, 114549.850390938, 100044.316695172, 58655.330655786,
#        12684.2268805969, 11663.1083156009, 10168.9413146208, 5949.080175853,
#        2.79647961574448, 2.52920982229059, 2.24701316278247, 1.30264578929547,
#        0.0502634216289927, 1227431.00141429, 1163522.47122237, 974217.980157487,
#        556619.782250809, 121818.013968303, 115304.292847043, 96682.3437102456,
#        55242.4214464478, 23.5305906904432, 22.8643448556569, 18.6753385868735,
#        10.6707273042849, 10.1116212338594, 167047.483697122, 160668.841800497,
#        132711.617175637, 75569.1692845493, 16644.3304706026, 15931.8363217603,
#        13220.8880516791, 7529.65611062985, 2.86975476829711, 2.78559672806006,
#        2.27807716595988, 1.2995179475178, 0.0392529463357284, 0,
#        0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0,
#        0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 386446.284344681, 358239.082548266,
#        298266.782803275, 182764.805321717, 38525.0054467637, 35762.2839606951,
#        29734.3912355547, 18222.702208534, 9.44839736655747, 9.00543291345805,
#        7.29246733616763, 4.46918383429163, 10.225393258427, 78149.7559896049,
#        77136.4443944463, 60302.5180347803, 37043.2440828961, 7809.22701840562,
#        7711.90042322886, 6026.24833451975, 3704.97000270559, 1.66806679022641,
#        1.67017521411826, 1.28711735314123, 0.793540541443695, 0.0539104426537862,
#        1429800.20553452, 1302940.55460351, 1290471.10002704, 964707.221569343,
#        141663.300157787, 129154.553245568, 127860.992514124, 95555.3803586945,
#        15.9954355084492, 14.9808785629008, 14.4369943205333, 10.7893146800224,
#        10.1839285714286, 236656.814420984, 229587.391980805, 213569.483239878,
#        159642.434494672, 23417.5280994256, 22726.8000529925, 21133.3807167918,
#        15791.3356782071, 2.32233188411765, 2.2922771431603, 2.09605001109717,
#        1.5638681806704, 0.0390835477464341, 1328090.56802401, 1236213.64286738,
#        1040472.14826732, 796045.892261363, 129233.057155626, 120250.416182018,
#        101247.707645688, 77424.8864348944, 8.17740724968628, 7.8071843319513,
#        6.40659407692365, 4.8991708590195, 10.2578947368421, 153709.474904964,
#        147046.630804724, 120429.507686143, 91449.4580541764, 14957.5397196021,
#        14310.1073902616, 11719.491192672, 8890.90275841774, 0.76133814770302,
#        0.734345336197297, 0.596948158026403, 0.452296122963107,
#        0.0330450801668645, 5239345.86687155, 4832802.1243919, 4298138.92515355,
#        2918870.07621609, 519432.472056528, 478984.051989891, 426152.780113464,
#        288947.754611188, 13.3881381032457, 12.6734400593976, 10.9838960407163,
#        7.44749828219508, 10.2005557761016, 401975.714282936, 382817.42770243,
#        335851.915079536, 231849.145993708, 40037.7383381676, 38055.6253564935,
#        33437.7672705181, 23009.4722114438, 0.874065453419145, 0.837673852007197,
#        0.734362883032103, 0.505867221464956, 0.021447403005249
#      ),
#      .Dim = c(13L, 2L, 7L, 9L, 1L)
#      )
#    ),
#    .Names = c(
#      "Stratum", "HBF", "se_HBF", "Attribute", "Größen", "BAGR",
#      "AKL", "DKL", "iVB.bagr.akl.dkl", "VB.A.bagr.akl.dkl"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.bwi12", {
#    result <- iVB.ew.bagrupp.akl.dkl.stratum.fun.bwi12(
#      get_data("baeume.12"), get_data("baeume.2"),
#      list(bagr.lab = c("alle Baumarten"), bacode = list(c(10:299))),
#      list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
#      list(Wa = c(1:3), Begehbar = c(1)), get_design("a", 1)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = 1:3, Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1298613.46918278, se_HBF = 15807.2409897449,
#      Attribute = c(
#        "V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J",
#        "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J",
#        "V_EoR/ha/J", "oiB/ha/J"
#      ),
#      Größen = c("Wert", "Standardfehler"),
#      BAGR = "alle Baumarten",
#      AKL = "0-500", DKL = "0-400",
#      iVB.bagr.akl.dkl = structure(c(
#        255277557.930226, 243683752.11536,
#        205567163.098199, 130086920.390191, 17884460.5784821, 17070292.904793,
#        14402887.5541372, 9117653.45979591, 13.7732010758775, 13.4116667149721,
#        11.0919681075012, 7.02169762911559, 1298497.02185828, 1272794.29675483,
#        14.2690394706822, 4439, 3421611.62344886, 3296207.07180454,
#        2764538.86925519, 1707775.24252132, 238759.177935475, 229980.30645474,
#        192943.566261479, 119282.887141281, 0.0763263544656992, 0.0778150959120681,
#        0.0620530797242411, 0.0345573245105437, 15862.5055163138,
#        15548.0710413573, 0.0142579043784973, NA
#      ),
#      .Dim = c(16L, 2L, 1L, 1L, 1L)
#      ),
#      VB.A.bagr.akl.dkl = structure(c(
#        242296015.230999,
#        228186778.742957, 192836832.268407, 122283106.86414, 16946609.0381363,
#        15962159.7102952, 13489162.3545045, 8556044.76775926, 13.0509417833581,
#        12.5410364824804, 10.3882890198702, 6.5891909058942, 14.3213856567039,
#        4335572.85837804, 4177555.15166883, 3470528.30180757, 2111788.51473821,
#        303893.145611409, 292881.381948176, 243323.480846937, 148097.554590202,
#        0.170716299197767, 0.170998259265493, 0.137179365161479,
#        0.0805525690779948, 0.0137565136931801
#      ),
#      .Dim = c(13L, 2L, 1L, 1L, 1L)
#      )
#    ),
#    .Names = c(
#      "Stratum", "HBF", "se_HBF", "Attribute", "Größen", "BAGR",
#      "AKL", "DKL", "iVB.bagr.akl.dkl", "VB.A.bagr.akl.dkl"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verbiss.bagr.fun", {
#    result <- verbiss.bagr.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 2, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"),
#        .Names = c("Wa", "Begehbar", "EigArt")
#      ),
#      HBF = 310978.141781646, se.HBF = 9650.45305895392, BAGR = c(
#        "FI", "TA",
#        "DGL", "KI", "LAE", "BU", "EI", "ALH", "ALN"
#      ),
#      m.Verbissproz.BAGR = structure(c(
#        96.5155721196901,
#        3.2474623945086, 0.236965485801271, 3.48442788030987, 0.554014570216615,
#        0.527021214230139, 0.139684544654859, 0.554014570216616,
#        69.7843797680487, 18.9992021663462, 11.2164180656051, 30.2156202319513,
#        1.99171133798698, 1.65647397315205, 1.34183821615875, 1.99171133798699,
#        97.3214285714286, 2.67857142857143, 0, 2.67857142857143,
#        1.9677418010511, 1.9677418010511, 0, 1.9677418010511, 86.5500000021677,
#        11.4499999978323, 2, 13.4499999978323, 4.80049946279884,
#        4.44091258921511, 1.9864641741707, 4.80049946279883, 84.6938775473567,
#        15.3061224526433, 0, 15.3061224526433, 9.17608292197702,
#        9.17608292197701, 0, 9.17608292197701, 85.489572039528, 12.5698221372745,
#        1.94060582319744, 14.510427960472, 0.986992760203528, 0.909062342932201,
#        0.413406573844527, 0.986992760203537, 66.9680496870387, 26.7819503129613,
#        6.25, 33.0319503129613, 3.63105407267664, 3.44628448846435,
#        1.83701116458529, 3.63105407267665, 65.9264848116772, 28.6132002993569,
#        5.46031488896589, 34.0735151883228, 1.42725701863182, 1.32976569426424,
#        0.892767977160766, 1.42725701863182, 68.8062597493353, 24.2131621105501,
#        6.98057814011462, 31.1937402506647, 2.39925544575336, 2.17939420809997,
#        1.38417368968831, 2.39925544575336, 81.5055588266682, 14.9567665285758,
#        3.53767464475603, 18.4944411733318, 0.706226820572756, 0.643123425051977,
#        0.34315073283352, 0.706226820572763
#      ), .Dim = c(4L, 2L, 10L))
#    ),
#    .Names = c("Stratum", "HBF", "se.HBF", "BAGR", "m.Verbissproz.BAGR")
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verbiss.bagrupp.fun", {
#    result <- verbiss.bagrupp.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(
#        bagr.lab = c(
#          "Fi/sNB", "Ta", "Dgl/Ki/Lae", "Bu", "Ei", "Es", "Ah",
#          "sBLb", "WLb"
#        ),
#        ba.grupp = list(
#          c(10:19, 90:99), c(30:39), c(20:29, 40, 50, 51), c(100),
#          c(110, 111), c(120), c(140:144), c(112, 130, 150:199),
#          c(200:299)
#        )
#      ),
#      list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      BAGR = c(
#        "Fi/sNB", "Ta", "Dgl/Ki/Lae", "Bu", "Ei", "Es", "Ah", "sBLb",
#        "WLb"
#      ),
#      m.Verbissproz.BAGR = structure(c(
#        96.0574454771787,
#        3.61557541182538, 0.326979110995943, 3.94255452282132, 0.317488648274475,
#        0.301163802723512, 0.0903863518809982, 0.317488648274473,
#        68.8715363350624, 19.1712507536728, 11.9572129112648, 31.1284636649376,
#        1.06659017700576, 0.859349966298884, 0.764926489643957, 1.06659017700576,
#        93.2114721520086, 5.55226411172762, 1.23626373626374, 6.78852784799136,
#        1.18412207057613, 1.06075061041891, 0.562868910016648, 1.18412207057613,
#        84.4496817075017, 13.569693651306, 1.98062464119225, 15.5503182924983,
#        0.513220964971834, 0.476312199884495, 0.208680451536187,
#        0.513220964971826, 65.5918813847893, 27.3113194424379, 7.09679917277282,
#        34.4081186152107, 1.77225601574225, 1.64154186864582, 0.936938846531801,
#        1.77225601574225, 70.0642778015485, 24.9385735714491, 4.99714862700238,
#        29.9357221984515, 0.88180199659296, 0.800108240119322, 0.452878003827781,
#        0.881801996592961, 61.4023353367778, 32.7410846840691, 5.85657997915313,
#        38.5976646632222, 0.932265078566988, 0.888938507178487, 0.494169468902097,
#        0.932265078566993, 61.7833196774943, 31.5477020437971, 6.66897827870861,
#        38.2166803225057, 1.20036558822392, 1.16099191878979, 0.632432082975517,
#        1.20036558822392, 67.6478107109341, 26.5585775416717, 5.79361174739424,
#        32.3521892890659, 1.14874394574895, 1.06524245525022, 0.601990433482375,
#        1.14874394574895, 78.9494712664289, 17.0064960777263, 4.04403265584478,
#        21.0505287335711, 0.36631280588909, 0.334165075661004, 0.184444611451421,
#        0.366312805889067
#      ), .Dim = c(4L, 2L, 10L))
#    ),
#    .Names = c("Stratum", "HBF", "se.HBF", "BAGR", "m.Verbissproz.BAGR")
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verjg.bagr.fun", {
#    result <- verjg.bagr.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 2, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"),
#        .Names = c("Wa", "Begehbar", "EigArt")
#      ),
#      HBF = 310978.141781646, se.HBF = 9650.45305895392,
#      BAGR = c("FI", "TA", "DGL", "KI", "LAE", "BU", "EI", "ALH", "ALN"),
#      n.Verjg.BAGR = structure(c(
#        1163054294.19255,
#        26.3854768743937, 94558787.2919012, 1.82277940363788, 275336601.981766,
#        6.24638727576144, 27649100.6454389, 0.605121768370304, 33919431.2281197,
#        0.769508674471195, 19197276.0181617, 0.43229372673899, 33600939.1228135,
#        0.762283245597242, 18537660.5679856, 0.418281171419954, 1910953.85713907,
#        0.0433526010413654, 693881.525535166, 0.0156471872365391,
#        1230733910.31817, 27.9208815025932, 83439745.1641056, 1.49045541152135,
#        130024484.019443, 2.94978319871283, 36612376.6935523, 0.802457714356436,
#        1302394681.86108, 29.5466040847528, 110977441.687462, 1.81640185013403,
#        236958278.882387, 5.37572254267629, 35328853.1520288, 0.774244799631737,
#        4407933575.46347, 100, 213346198.987428, 0
#      ),
#      .Dim = c(2L, 2L, 10L)
#      )
#    ),
#    .Names = c("Stratum", "HBF", "se.HBF", "BAGR", "n.Verjg.BAGR")
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verjg.bagrupp.fun", {
#    result <- verjg.bagrupp.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(
#        bagr.lab = c(
#          "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es", "Ah",
#          "sBLb", "WLb"
#        ),
#        ba.grupp = list(
#          c(10), c(30), c(11:19, 20:29, 31:39, 40, 50, 51, 90:99), c(100),
#          c(110, 111), c(120), c(140:144), c(112, 130, 150:199),
#          c(200:299)
#        )
#      ),
#      list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      BAGR = c("Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es", "Ah", "sBLb", "WLb"),
#      n.Verjg.BAGR = structure(c(
#        4133233954.75663,
#        21.5921900393957, 196158528.046877, 0.899757471373445, 1022360316.13047,
#        5.34085379058238, 59490121.9016487, 0.308606846119079, 198818825.003868,
#        1.03863800111108, 30664119.5815902, 0.159700089813015, 5601324261.47559,
#        29.2615562656143, 197398985.443689, 0.784762350768101, 429646125.441407,
#        2.24448963977582, 55582141.0704453, 0.283178557009599, 2717694883.78457,
#        14.197353704655, 124440118.37118, 0.53689145524285, 2675415027.10036,
#        13.9764819344245, 129277306.369491, 0.563134101597512, 1446432825.28827,
#        7.55622662174791, 104935361.747216, 0.508009811380214, 917337475.509285,
#        4.79221000269322, 54088641.8481722, 0.28277631231099, 19142263694.4905,
#        100, 443470186.924997, 0
#      ), .Dim = c(2L, 2L, 10L))
#    ),
#    .Names = c("Stratum", "HBF", "se.HBF", "BAGR", "n.Verjg.BAGR")
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verjg.kl4.bagrupp.fun", {
#    bagr.vj <- list(
#      bagr.lab = c(
#        "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es",
#        "Ah", "sBLb", "Bi", "Er/Pa/Wei", "sWLb"
#      ),
#      ba.grupp = list(
#        c(10:19), c(30:39), c(20:29, 40, 50, 51, 90:99),
#        c(100), c(110, 111), c(120), c(140:144),
#        c(112, 130, 150:199), c(200, 201), c(210:224, 240),
#        c(230, 250:299)
#      )
#    )
#  
#    result <- verjg.kl4.bagrupp.fun(
#      get_data("verj.kl4m.3"), get_data("ecken.3"), get_data("trakte.3"),
#      bagr.vj, list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1), .Names = c(
#        "Wa",
#        "Begehbar"
#      )), HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      BAGR = c(
#        "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es", "Ah",
#        "sBLb", "Bi", "Er/Pa/Wei", "sWLb"
#      ), VjgArt = c(
#        "Naturverjüngung",
#        "Pflanzung", "Saat", "Stockausschlag", "nicht zuzuordnen"
#      ), Verjg.kl4m.BAF.VArt.BAGR = structure(c(
#        89626.3418600095,
#        2711.7931064959, 12150.9605978002, 937.912294000381, 119.068207438919,
#        53.5258108419167, 67.0384025076264, 31.5871884053253, 223.127817301503,
#        81.8892576287999, 102186.536885058, 2963.09658115651, 35036.0701821947,
#        1532.56759643747, 2811.61061263329, 356.022174628901, 64.0366829923596,
#        34.1028183316967, 17.0097439198455, 9.648034565709, 153.08769527861,
#        46.0982146066284, 38081.8149170188, 1590.43164104944, 9128.22904592651,
#        666.128857558475, 4354.49444348045, 498.199601114723, 11.0063048893118,
#        9.11541836474589, 32.0183414961798, 17.7279475539192, 143.081963561053,
#        60.093635805262, 13668.8300993535, 859.276671360826, 146330.824649744,
#        3866.58991427346, 6736.85916543058, 591.839158084945, 283.16220760684,
#        105.318364486673, 933.534769247992, 161.592683170145, 315.18054910302,
#        176.496516695412, 154599.561341132, 3941.82914919518, 3429.96483277826,
#        268.486263115083, 3002.72008843861, 468.52844263887, 0, 0,
#        22.0126097786236, 18.2856753894259, 153.08769527861, 85.1086235004414,
#        6607.7852262741, 572.572389640467, 38356.9725392516, 1417.61226520819,
#        1481.84886737007, 248.485820019935, 66.0378293358708, 35.8765808371725,
#        101.057890347317, 40.8160463383617, 24.0137561221348, 14.1487449147748,
#        40029.930882427, 1448.03235748333, 48090.5483540903, 1654.03257937964,
#        2664.52635638521, 341.602412389775, 156.089414793876, 72.2622529954103,
#        247.141573423638, 90.9645917003624, 38.0217805267135, 21.0331649165094,
#        51196.3274792197, 1698.67639951996, 31098.8147513364, 1262.75781969199,
#        2717.55673448826, 325.764217611654, 228.130683160281, 129.333644449584,
#        1217.69755002659, 287.190801349464, 49.0280854160253, 20.1802509654513,
#        35311.2278044275, 1378.11461654998, 3836.19754051104, 342.375295500676,
#        670.384025076264, 125.377084298237, 1.00057317175562, 1.00057284078495,
#        43.0246463854916, 19.0064891274805, 37.0212073549579, 22.3936751608818,
#        4587.62799249951, 371.196225162708, 3412.95508885841, 295.507574085197,
#        1065.61042791973, 212.004051437209, 0, 0, 161.092280652655,
#        66.7959593823626, 68.038975679382, 45.2111737422009, 4707.69677311018,
#        373.296784081653, 15635.9569550251, 808.234243070646, 1836.05177017156,
#        243.326514097253, 102.058463519073, 44.5120568802622, 1190.68207438919,
#        336.358995533434, 67.0384025076264, 26.6719065492773, 18831.7876656125,
#        938.194190192324, 423982.875799726, 7213.13025569356, 39492.6230891943,
#        2024.75938669204, 1030.59036690829, 257.029278112354, 4032.30988217514,
#        574.711894627704, 1270.72792812964, 307.63298839511, 469809.127066133,
#        7631.83487610969
#      ), .Dim = c(2L, 6L, 12L))
#    ), .Names = c(
#      "Stratum",
#      "HBF", "se.HBF", "BAGR", "VjgArt", "Verjg.kl4m.BAF.VArt.BAGR"
#    ))
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("ntns.stratum.fun", {
#    result <- ntns.stratum.fun(
#      get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), list(
#        Wa = c(3, 5), Begehbar = 1,
#        WLT = c(9410)
#      ), 3, 3
#    )
#  
#    result[["Datum"]] <- NULL
#  
#    reference <- structure(list(
#      HBF = 5303.03781030478, se.HBF = 973.67411677321,
#      NTNS = c(
#        "sehr naturnah", "naturnah", "bedingt naturnah", "kulturbetont",
#        "kulturbestimmt", "keine Angabe"
#      ),
#      NTNS.Flaeche.Anteil = structure(c(
#        3101.77683244242,
#        58.4905660377358, 754.743775234348, 7.5009287954288, 2201.26097786236,
#        41.5094339622642, 509.689803474082, 7.5009287954288, 0, 0,
#        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
#      ), .Dim = c(2L, 2L, 6L))
#    ),
#    .Names = c("HBF", "se.HBF", "NTNS", "NTNS.Flaeche.Anteil")
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("ntns.stratum.fun.2", {
#    result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
#      list(Wa = c(3, 5), Begehbar = 1), 3, 3,
#      schicht = 1
#    )
#  
#    result["Datum"] <- NULL
#  
#    reference <- structure(list(
#      HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      NTNS_Kollektiv = "BWI 3 Schicht < 4m",
#      NTNS = c(
#        "sehr naturnah", "naturnah", "bedingt naturnah", "kulturbetont",
#        "kulturbestimmt", "keine Angabe"
#      ),
#      NTNS.Flaeche.Anteil = structure(c(
#        275757.966135848,
#        20.8282950423216, 6980.43129090457, 0.455228341952191, 360306.399149198,
#        27.2143288996372, 7450.22499743494, 0.455497510369835, 234634.408776692,
#        17.7221886336155, 5698.37991560239, 0.38285646415925, 33919.4305225155,
#        2.56197097944377, 1996.72034622579, 0.147644404309546, 66638.1732389242,
#        5.03325272067715, 3114.06068604502, 0.228220614021398, 352623.092420045,
#        26.6258780874688, 7381.61600654685, 0.464543374771226
#      ),
#      .Dim = c(2L, 2L, 6L)
#      )
#    ),
#    .Names = c(
#      "HBF", "se.HBF", "NTNS_Kollektiv", "NTNS",
#      "NTNS.Flaeche.Anteil"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("fba.stratum.fun", {
#    result <- fba.stratum.fun(
#      "alle", get_data("fba.3"), list(Wa = c(3, 5), Begehbar = 1),
#      get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3)
#    )
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      FBA = c(
#        "Adlerfarn", "Brennessel", "Riedgras", "Honiggras", "Reitgras",
#        "Heidekraut", "Heidelbeere", "Brombeere", "Riesenbärenklau",
#        "Riesenknöterich", "Drüsiges Springkraut", "Kleinblütiges Springkraut",
#        "Kermesbeere"
#      ),
#      Dichtestufen = c(
#        "nicht vorhanden", "selten, bis 10%",
#        "häufig, > 10 bis 50%", "flächig, > 50%"
#      ),
#      FBA.Dichtevertlg = structure(c(
#        0.9556,
#        0.00235, 0.0273, 0.00165, 0.0124, 0.00105, 0.0048, 0.00066,
#        0.774, 0.0045, 0.1564, 0.00368, 0.0487, 0.002, 0.0209, 0.00141,
#        0.9212, 0.00355, 0.0317, 0.00188, 0.0234, 0.00155, 0.0237,
#        0.00181, 0.9953, 0.00069, 0.0036, 6e-04, 0.0011, 3e-04, 1e-04,
#        8e-05, 0.9602, 0.00229, 0.0286, 0.00181, 0.0082, 9e-04, 0.0029,
#        0.00053, 0.9783, 0.00166, 0.0165, 0.00132, 0.0039, 0.00062,
#        0.0014, 0.00037, 0.8051, 0.00563, 0.0832, 0.00305, 0.0582,
#        0.00257, 0.0535, 0.00284, 0.5014, 0.00598, 0.2796, 0.00465,
#        0.1341, 0.00335, 0.0849, 0.00293, 0.998, 0.00043, 0.0014,
#        0.00034, 5e-04, 2e-04, 1e-04, 8e-05, 0.9983, 0.00041, 0.0012,
#        0.00034, 4e-04, 0.00017, 2e-04, 0.00011, 0.972, 0.00179,
#        0.0164, 0.00126, 0.0078, 8e-04, 0.0039, 0.00062, 0.931, 0.00292,
#        0.045, 0.00218, 0.0178, 0.0013, 0.0062, 0.00076, 0.9972,
#        6e-04, 0.0024, 0.00053, 3e-04, 0.00015, 1e-04, 8e-05
#      ),
#      .Dim = c(2L, 4L, 13L)
#      ),
#      FBA.Fläche = structure(c(
#        10419.1, 771.71, 46768.9,
#        1580.88, 31766.1, 1905.58, 715.6, 142.92, 7684.7, 663.43,
#        3606.6, 410.72, 77213.3, 3209.15, 146601.4, 3389.55, 336.2,
#        101.97, 333.4, 104.38, 6842.9, 601.35, 14712.1, 897.62, 348.8,
#        106.08, 0.0079, 6e-04, 0.0353, 0.0011, 0.024, 0.0014, 5e-04,
#        1e-04, 0.0058, 5e-04, 0.0027, 3e-04, 0.0583, 0.0023, 0.1107,
#        0.0022, 3e-04, 1e-04, 3e-04, 1e-04, 0.0052, 5e-04, 0.0111,
#        7e-04, 3e-04, 1e-04
#      ), .Dim = c(2L, 13L, 2L))
#    ),
#    .Names = c(
#      "Stratum", "HBF", "se.HBF", "FBA", "Dichtestufen",
#      "FBA.Dichtevertlg", "FBA.Fläche"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("fl.stratum.fun", {
#    result <- fl.stratum.fun(
#      list(Wa = c(3, 4, 5), Kreis = 317), get_data("ecken.3"),
#      get_data("trakte.3"), get_design("a", 3)
#    )
#  
#    reference <- structure(list(
#      Flaeche = 83747.9744759453,
#      SE_Flaeche = 5302.80028301014
#    ), .Names = c("Flaeche", "SE_Flaeche"))
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("fl.proz.stratum.fun", {
#    stratum <- list(Wa = c(3:5), Kreis = 317)
#    substratum <- list(EigArt2 = "MPW")
#  
#    result <- fl.proz.stratum.fun(stratum, substratum, get_data("ecken.3"))
#  
#    reference <- structure(list(
#      Fl_Proz = 41.6965352449223,
#      SE_Fl_Proz = 2.86767974355858
#    ), .Names = c("Fl_Proz", "SE_Fl_Proz"))
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("stratum.fun", {
#    result <- stratum.fun(list(Wa = c(1:5), EigArt = "BW"), get_data("ecken.3"))
#  
#    reference <-
#      structure(list(
#        TNr = c(
#          1985, 2180, 2180, 2329, 2747, 2747, 3610,
#          3855, 3855, 3855, 3855, 3856, 3999, 3999, 3999, 4000, 4000, 4000,
#          4001, 4001, 4001, 5778, 5882, 5882, 5882, 5882, 5884, 5884, 5884,
#          5885, 5885, 5885, 6030, 6077, 6136, 6136, 6136, 6136, 6137, 6139,
#          6153, 6377, 6377, 6377, 6377, 6754, 7113, 7674, 7674, 8362, 10711,
#          10711, 10711, 10711, 10857, 11801, 11934, 12878, 12878, 12928,
#          12928, 15157
#        ),
#        ENr = c(
#          4, 2, 3, 1, 3, 4, 1, 1, 2, 3, 4, 1, 1,
#          3, 4, 1, 2, 3, 1, 2, 4, 4, 1, 2, 3, 4, 1, 2, 4, 1, 3, 4, 4, 2,
#          1, 2, 3, 4, 3, 4, 2, 1, 2, 3, 4, 4, 3, 1, 3, 4, 1, 2, 3, 4, 3,
#          3, 1, 1, 2, 1, 4, 4
#        ), Wa = c(
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 4, 4, 5, 5, 5, 5, 5
#        ),
#        EigArt = c(
#          1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
#        )
#      ),
#      .Names = c("TNr", "ENr", "Wa", "EigArt"),
#      row.names = c(NA, -62L), class = "data.frame"
#      )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("r.variance.fun", {
#    result <- r.variance.fun(
#      cbind(get_data("trakte.1")$m, get_data("trakte.1")$m_Wa),
#      length(get_data("trakte.1")[, 1])
#    )
#  
#    reference <- structure(list(
#      R.xy = 0.380382172733123,
#      V.R.xy = 2.02873178828728e-05
#    ), .Names = c("R.xy", "V.R.xy"))
#  
#    expect_equal(result, reference)
#  })
#  
#  
#  context("made up examples")
#  
#  test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.2g", {
#    result <- iVB.ew.bagrupp.akl.dkl.stratum.fun.2g(
#      get_data("baeume.23"), get_data("baeume.3"),
#      list(
#        bagr.lab = c("Fichte", "Tanne"),
#        ba.grupp = list(c(10), c(30))
#      ),
#      list(A.ob = 160, A.b = 20), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
#      list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      HBF = 1309350.0525594, se_HBF = 15708.5123749046,
#      Attribute = c(
#        "V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "G", "V_DhmR/J",
#        "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "G/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J",
#        "V_EoR/ha/J", "oiB/ha/J", "G/ha/J", "mBAF_mLK", "mBAFoLK", "mPL", "nT"
#      ),
#      Größen = c("Wert", "Standardfehler"),
#      BAGR = c("Fichte", "Tanne", "Alle BA"),
#      AKL = c(
#        "1-20", "21-40", "41-60", "61-80", "81-100", "101-120", "121-140",
#        "141-160", ">160"
#      ), DKL = "0-400",
#      iVB.bagr.akl.dkl = structure(c(
#        3464922.15484338,
#        3308166.20992571, 2569628.35553625, 1903772.68687055, 420530.567745188,
#        338347.350948474, 322945.802139545, 250796.439280503, 186034.570596779,
#        41093.311091787, 5.7064105461295, 5.57024796330222, 4.22981720421372,
#        3.13757336246974, 0.693060853386922, 59292.5006382454, 57976.9166951219,
#        10.1390786338364, 2300, 230663.029498138, 228236.339791984,
#        174374.250978079, 118492.156671577, 27087.3980608649, 22320.4698197158,
#        22087.9926225692, 16855.713239933, 11488.8723491072, 2628.37024297543,
#        0.295589102531467, 0.299565691690403, 0.226087117839159,
#        0.145538268558179, 0.0336625506502826, 2377.94008849468,
#        2323.87990477335, 0.0136085650998704, NA, 446326.993559083,
#        377397.949042815, 324118.871252554, 207200.953428881, 58868.6057447011,
#        43958.3686206971, 37223.3063220516, 31916.0274297785, 20401.6936220472,
#        5795.66556884667, 3.96259325266654, 3.43409050340258, 2.87704568921637,
#        1.83909494429305, 0.522445804938506, 11093.3335363442, 10839.3492498727,
#        10.1240320733104, 1302, 52266.9477903855, 50084.7237139327,
#        38336.0304356731, 23670.2141161324, 7049.09585423904, 5144.01957854978,
#        4932.56836712693, 3773.28925725851, 2333.51670615344, 692.321031354084,
#        0.391011922075183, 0.376840662617629, 0.288228730679319,
#        0.177790523277111, 0.0523458403526371, 812.896485845985,
#        793.466457854196, 0.0180571268718284, NA, 8668161.67917693,
#        7888849.6578879, 6294631.88235857, 5424440.94411128, 1061308.60513477,
#        846702.809748495, 770102.713031493, 614781.655599628, 529920.392911515,
#        103688.781305005, 4.76568155652617, 4.43206764098625, 3.46030928874803,
#        2.98266618918587, 0.583614117013172, 177666.677831004, 173756.985545493,
#        10.1874046095737, 4381, 343506.018805245, 336632.432183579,
#        253756.691078652, 200643.268989751, 41314.7584459699, 33370.8984255794,
#        32677.518794321, 24638.8761449042, 19516.9640731019, 4020.91322467054,
#        0.139861745738439, 0.139723305345063, 0.105021635647806,
#        0.0789312207831737, 0.016303918702842, 4722.44229814519,
#        4615.1984711157, 0.0102247599601316, NA, 17922067.6073403,
#        17302441.6473729, 14430918.9525253, 7926956.98780998, 1419739.85286976,
#        1758637.68209131, 1697911.14375924, 1415715.3517447, 778104.530843447,
#        139549.504677269, 22.6138345201167, 22.3697253293165, 18.2042913204684,
#        10.0054304982947, 1.79442840232066, 77768.2210651568, 75902.1900699897,
#        10.1794697153977, 1267, 703160.256767265, 693727.608863159,
#        568525.122849945, 308154.991934071, 54436.9538329897, 68706.0581669643,
#        67805.6677670495, 55534.1672314905, 30134.9136281038, 5335.13371514508,
#        0.319306493717555, 0.320194296876573, 0.260672367136347,
#        0.135856963027614, 0.0243115237074545, 2873.86413649123,
#        2804.68700883775, 0.0185571804340779, NA, 2256351.74491328,
#        1942769.00713531, 1769718.74312248, 982990.470227077, 211152.892798644,
#        221683.715321162, 190674.526188386, 173797.254883432, 96538.2102606736,
#        20816.5746251519, 23.8302571691133, 20.9716159823886, 18.6826230025871,
#        10.3775343796675, 2.23771207541672, 9302.61531581328, 9092.02830857239,
#        10.1241379310345, 388, 177349.697597102, 169636.128072374,
#        141042.979719266, 77818.1351901286, 15379.4289722301, 17307.9811498426,
#        16547.5779191168, 13759.2388030565, 7593.83759407588, 1509.29189375434,
#        0.979185245399135, 0.841166705396656, 0.782660542533183,
#        0.427603136902145, 0.091452007546881, 781.040273184423, 762.760618240493,
#        0.0325597601647428, NA, 32966805.6662347, 30714908.03341,
#        25979807.9204094, 16525139.477435, 2779080.24839202, 3235586.26579033,
#        3015542.36401857, 2549411.43702567, 1621740.67154412, 272967.52676828,
#        18.9969785686705, 18.1335694638159, 14.9682655486456, 9.52166632273047,
#        1.6026641943646, 170321.098910245, 166296.126641577, 10.2140680548502,
#        2504, 941702.192555397, 924296.698970359, 748626.450876844,
#        454473.018302697, 74727.7347887074, 92260.9263724051, 90594.0769608087,
#        73316.1203586135, 44571.5945991048, 7333.29403182378, 0.23067837334542,
#        0.231178776680519, 0.187633364810447, 0.101834265365076,
#        0.0175096690672845, 4545.32046856041, 4436.75166375037, 0.0133289014583507,
#        NA, 23468200.9082402, 23071540.5745853, 18818076.0347384,
#        10376313.7694451, 1553459.91556945, 2315752.78720325, 2276673.80196696,
#        1857054.52747049, 1023794.01624452, 153268.649965383, 18.9601463052071,
#        19.1142374396886, 15.204570078532, 8.3822782991594, 1.25488180059791,
#        122137.917604953, 119108.795689631, 10.1761121495327, 1680,
#        765627.695208189, 757918.685755095, 613871.340387099, 336389.383014827,
#        49750.0835052971, 75453.8173258505, 74691.2233725555, 60515.6318478228,
#        33141.6422407193, 4901.03201137296, 0.209919550783817, 0.212345485570402,
#        0.168352783639273, 0.0889940917260452, 0.0130370050339329,
#        3734.08206390978, 3642.12803385201, 0.0164101091579517, NA,
#        2641939.16939494, 2470191.47933966, 2096229.34440577, 1156176.18894415,
#        178925.855086416, 259335.076345574, 242504.49300911, 205757.797866578,
#        113462.544615272, 17558.3820188566, 23.646967788943, 22.648956346577,
#        18.7616271853302, 10.3458628719919, 1.60102713399473, 10966.948433314,
#        10707.09348803, 10.1099157485418, 454, 198446.374970795,
#        195191.229103458, 157425.273399194, 86730.3404523167, 12785.6306044067,
#        19376.809447302, 19061.6480075752, 15370.8660579998, 8464.43639669488,
#        1243.9363376359, 0.814347915782438, 0.783496303781435, 0.645681009285886,
#        0.353857107571789, 0.0527452114960014, 817.446455814527,
#        797.632116268343, 0.0327288641794357, NA, 43610828.4402991,
#        41823991.5723825, 34647272.3872838, 22031815.9445661, 2990491.05602362,
#        4283687.55614601, 4109216.26109501, 3403590.59030065, 2162311.64112136,
#        293692.316054801, 16.45819706485, 16.1825270708607, 13.0768091577704,
#        8.30773734982962, 1.12838435359905, 260276.841944902, 253929.206674669,
#        10.1967378474085, 3010, 1039644.60435861, 1021696.09234696,
#        827725.95779309, 510920.783159102, 69084.8533486522, 101911.784029294,
#        100172.764349314, 81162.7300507138, 50009.7858195746, 6767.2317416621,
#        0.156181862049714, 0.15836549115004, 0.125439031520233, 0.0710564631396485,
#        0.0095130548933228, 5808.13372437816, 5666.13554544101, 0.012230823828492,
#        NA, 10321880.0765653, 10109154.5719728, 8315187.15047099,
#        4658244.87469101, 641616.515005232, 1021488.53127554, 1000251.30567927,
#        822918.355102728, 460808.722855507, 63466.6505973232, 15.0339577315231,
#        15.1008273354697, 12.1114622321411, 6.78204272452878, 0.934082873402451,
#        67945.4172691789, 66238.1791049173, 10.1601782363977, 1291,
#        431002.03738042, 427122.794614093, 346797.591408255, 193380.585768197,
#        26503.1197978763, 42639.4450795962, 42218.6342548808, 34316.6704558492,
#        19106.5443308155, 2614.2970611567, 0.2323650764115, 0.233961643051362,
#        0.187247473692846, 0.100331798827199, 0.0138201702064555,
#        2674.54364428471, 2608.16586116789, 0.0182246662870195, NA,
#        2597247.42731594, 2494453.5700582, 2051974.17773087, 1142329.1620146,
#        152465.148976256, 256026.421762584, 245728.066292723, 202301.832157652,
#        112587.752859526, 15000.0305020688, 22.0415351032272, 21.6650870673069,
#        17.4163389241325, 9.69277658830045, 1.29136554182451, 11615.6347805874,
#        11342.1222600823, 10.1643493761141, 497, 187535.004153516,
#        185830.220367448, 147837.201419736, 82447.5233635578, 10547.5858521173,
#        18474.9872346441, 18291.9647458773, 14564.1616129597, 8120.25812649807,
#        1035.97070023872, 0.663367100265232, 0.652997507300292, 0.520672005831184,
#        0.288849689360554, 0.0365173939516602, 822.540413864644,
#        802.956617055964, 0.0298964876870011, NA, 24734320.2347179,
#        23739526.0561028, 20053856.1050987, 13253700.3421484, 1552447.68938345,
#        2430841.31531184, 2333324.01349041, 1970779.08535, 1300690.80844354,
#        152466.379725351, 13.2773655005116, 13.0660405029127, 10.7644847370875,
#        7.10443218077579, 0.832778280261205, 183081.599675642, 178579.272961098,
#        10.222224857685, 2684, 670043.523335538, 659832.820930909,
#        543428.432646068, 350514.576416981, 40776.4678886144, 65933.9060562408,
#        64890.1422211043, 53467.5855605925, 34418.1730397143, 4005.00323500732,
#        0.157297884104754, 0.156475898549466, 0.127492542408767,
#        0.077250404752038, 0.00889907938265953, 4635.73387424318,
#        4522.18117217785, 0.0129886863067623, NA, 8726709.76918194,
#        8509139.80676718, 7090065.29625965, 3926639.89772604, 519016.508298868,
#        861113.241676397, 839951.089435309, 699649.536883352, 387330.477859665,
#        51160.8452854428, 12.8988843882597, 12.9121637475183, 10.4802690886378,
#        5.80194428811109, 0.766354291867413, 66758.7378688474, 65051.149122605,
#        10.1578999504705, 1230, 376748.106037648, 371722.519769521,
#        306136.669785612, 168154.639102169, 22008.3446711957, 37137.9449726984,
#        36669.0425318721, 30181.0899072392, 16560.8788517144, 2163.93489923898,
#        0.220118642904161, 0.224132340457696, 0.179085681715788,
#        0.0935705218729192, 0.012061129425329, 2686.80944055257,
#        2619.05481354466, 0.0186142528112237, NA, 3149243.0437327,
#        3052926.06240188, 2494463.9425814, 1402856.75239354, 176981.455016249,
#        311330.170550333, 301972.080016081, 246587.506546996, 138697.131587307,
#        17516.4174032608, 18.8382666734899, 18.7248161821635, 14.9207550250329,
#        8.39242000565244, 1.05990030334512, 16526.4764506414, 16126.8381530884,
#        10.1246882793017, 592, 198969.57241113, 196995.562596587,
#        157972.243503533, 88464.8981324734, 10753.1143766173, 19637.8215025045,
#        19453.745728427, 15587.5105227152, 8734.27430014119, 1063.99714583687,
#        0.461537989741806, 0.46609609397864, 0.368394015098447, 0.204252592168592,
#        0.0239635823719636, 989.521563252434, 965.783547534023, 0.0267550721683242,
#        NA, 22109258.4241942, 21286150.7639688, 18101192.661838,
#        11777249.8904156, 1284976.77435911, 2169978.05773659, 2090536.19720928,
#        1776818.82058833, 1154570.01418086, 126104.060300651, 11.8781561688587,
#        11.7341945886876, 9.72605753291793, 6.31995465918507, 0.690275976034843,
#        182686.439451409, 178157.621420789, 10.2219035532995, 2485,
#        629292.08996624, 618063.99548877, 516313.179959137, 331736.962343409,
#        35385.7241925639, 61897.8735152078, 60851.5309286738, 50806.2707444038,
#        32569.82676763, 3477.55948003636, 0.145831620066131, 0.146427053836085,
#        0.119702147807425, 0.0749879786014173, 0.00756655019496523,
#        4757.75439532006, 4640.42558670565, 0.0132997618057585, NA,
#        5034540.44301573, 4792002.81188057, 4124574.77299388, 2251827.63960928,
#        291713.262268899, 501113.689957043, 477328.756940536, 410576.654558219,
#        224080.665463397, 29011.5003629649, 11.1369275135497, 10.8912077919935,
#        9.12480048382354, 4.98004779847017, 0.644761823667915, 44995.6856904532,
#        43826.9809975931, 10.1275299907721, 978, 256620.437311143,
#        249994.333846942, 210212.854057823, 113305.776314712, 14559.8577289161,
#        25503.7729057977, 24866.0578614461, 20899.6550018763, 11254.3347392362,
#        1443.8830270267, 0.238266310000929, 0.23933525112779, 0.195841878983368,
#        0.101855986237282, 0.0131855581241498, 2076.76056451606,
#        2023.76841103196, 0.0216860089823182, NA, 2930720.83473766,
#        2811078.10619874, 2336117.84708351, 1310866.49192698, 158912.7437415,
#        289817.499404921, 277975.378781365, 231011.764408175, 129619.127689025,
#        15724.5668928565, 16.4799563642046, 16.2069221596818, 13.1360728902901,
#        7.3705610346769, 0.894149513995471, 17586.0598778295, 17151.6452070639,
#        10.136372745491, 581, 188090.65186869, 184124.376344374,
#        150196.69175928, 83713.6383299838, 9931.43263862992, 18561.4852156684,
#        18172.2448192331, 14820.3635731499, 8258.31855898374, 980.690216998718,
#        0.484666302001212, 0.48465383153595, 0.388135990434797, 0.213260377691742,
#        0.0239447987557637, 1088.83090101928, 1061.86742013887, 0.0284633859870514,
#        NA, 16160886.067129, 15365361.1650373, 13396917.6053513,
#        8698626.8471893, 883471.283755294, 1588273.66804518, 1510729.14070094,
#        1316443.82751109, 853623.420673826, 86911.3909784211, 10.5877651108607,
#        10.329811948343, 8.77569042902078, 5.69043260809559, 0.579369545470247,
#        150010.285590485, 146249.433025087, 10.2261437908497, 2102,
#        509241.793469263, 496788.722122693, 424369.945000615, 276454.29483109,
#        26970.4024799049, 49943.3984686181, 48742.1936925578, 41591.9149687708,
#        27009.2448392861, 2649.50340343451, 0.150972423408927, 0.151045865414308,
#        0.12536462894588, 0.0796338235010496, 0.00751541047841702,
#        4277.02593268138, 4171.09899970208, 0.0147658260535502, NA,
#        2055872.36362972, 1970400.75252508, 1691080.4740114, 909424.567683906,
#        116091.267124548, 205434.776424236, 197038.744381022, 168967.917409174,
#        90895.2297486594, 11601.2955430305, 10.4470259010297, 10.2904016091061,
#        8.59256762823555, 4.62231777887177, 0.589963574488753, 19664.4268302223,
#        19147.8187019115, 10.1234193222054, 573, 159240.188061563,
#        156099.091613281, 130918.126399317, 69357.2842596555, 8585.2707457278,
#        15963.7029657877, 15652.6361636687, 13123.9337502234, 6948.68401969129,
#        858.908879437649, 0.349684789322683, 0.348836353136291, 0.288456099151125,
#        0.145836241162016, 0.0175875578171356, 1300.69182026607,
#        1267.40615492044, 0.0284471708857295, NA, 1982911.04580825,
#        1921601.94758329, 1585729.95353527, 900392.793102773, 109643.348110547,
#        195652.310926404, 189608.681041438, 156414.020437886, 88842.5353888346,
#        10833.7197531524, 14.2409648526507, 14.1518870326204, 11.3849233723368,
#        6.46659074918202, 0.788555072503819, 13738.6976901349, 13398.1200248692,
#        10.1586034912718, 456, 149270.355646221, 148346.203579614,
#        119739.132632711, 67175.2834489969, 7930.95856205778, 14701.1735517827,
#        14607.9246486454, 11786.2873057903, 6618.96227267534, 783.702861905441,
#        0.5286229664949, 0.533351801190002, 0.425583604969715, 0.233266993053577,
#        0.025809687020139, 960.12099989623, 936.632450125717, 0.0321788988216837,
#        NA, 8213619.70038065, 7761437.25545366, 6841022.6403503,
#        4381353.17210634, 451434.186201237, 809372.587472363, 764943.899519132,
#        673832.33594324, 431209.609966955, 44531.4886840427, 8.98565305940197,
#        8.71423436409236, 7.48088542249907, 4.78728834039663, 0.494388509973049,
#        90073.8746668492, 87780.9647478772, 10.2298779306336, 1582,
#        340799.184877671, 333995.320912615, 284896.005809557, 179099.231824748,
#        18015.8390001742, 33518.5298575015, 32859.1223102119, 27986.5077850127,
#        17556.8981627412, 1777.81247813508, 0.195884788681132, 0.196512850095277,
#        0.163705163714466, 0.0987445365613301, 0.0092901810903382,
#        3201.98016251359, 3121.96078502582, 0.0169584124877272, NA,
#        621975.280820188, 599658.039833416, 514665.187347558, 274319.005284097,
#        35918.8548424964, 62222.075315115, 59982.4327072404, 51495.1082738847,
#        27417.4099769871, 3590.96750368677, 8.81902237571197, 8.73027846267469,
#        7.29863974814708, 3.88599626172193, 0.508964424685063, 7055.43910246534,
#        6870.62078989673, 10.1274468085106, 266, 65472.0425498674,
#        64832.8869538209, 54335.2508688595, 28435.6373568118, 3586.27526138727,
#        6619.33336625399, 6554.47512704703, 5498.74513088442, 2863.11365275015,
#        359.582431726728, 0.532379913381943, 0.540795162585538, 0.446653705167028,
#        0.219549563220965, 0.0270079169680593, 650.008016449338,
#        632.868155445136, 0.0395873372050692, NA, 1014388.11599922,
#        935077.566101982, 808257.977324796, 463036.119379114, 58316.7571083746,
#        99942.5958475704, 92204.8243281506, 79633.1055462163, 45612.3785937907,
#        5745.19927915469, 12.1463093579143, 11.5061066444205, 9.67803894718728,
#        5.54340275287094, 0.698230490970137, 8228.22743127728, 8013.55551252974,
#        10.2142981691369, 322, 92197.229741169, 88768.6657492679,
#        73521.9965436808, 42169.8016834586, 5374.38791649827, 9112.09081252397,
#        8790.19854972918, 7269.81842318188, 4161.45850060173, 526.794325898761,
#        0.594319809447542, 0.585307992224963, 0.476185852774679,
#        0.2683521824691, 0.0350092151911407, 700.417773506137, 682.323362484827,
#        0.0372198874992966, NA, 4616784.90462722, 4178816.14979796,
#        3913557.70171751, 2554442.69204091, 246168.500389655, 452018.578822478,
#        408686.661858273, 383051.058840482, 249796.475117878, 24132.3579232781,
#        8.00950466075253, 7.4323024353039, 6.7874405717601, 4.42624733901026,
#        0.427611258291563, 56435.2725877569, 54987.8944534046, 10.2676025917927,
#        1122, 225446.950298813, 215522.399119057, 192771.285146683,
#        126458.078612924, 11859.5062509733, 22138.0417222242, 21151.7580584934,
#        18916.4082223305, 12366.457538465, 1163.66319973022, 0.216904283759287,
#        0.204497387905837, 0.184139764419646, 0.11770300260676, 0.010750827228051,
#        2494.1128798227, 2430.99077338067, 0.0200445310046681, NA,
#        275787.724292771, 253403.586155013, 226908.683692812, 120530.397845049,
#        16204.9100472296, 27682.5765875838, 25439.2683678643, 22771.649303255,
#        12084.1659364171, 1621.20118596494, 7.27193029719731, 6.86224751091692,
#        5.98187982833086, 3.17438704129893, 0.42587300299779, 3806.77144254986,
#        3707.13360708628, 10.0980810234542, 130, 39970.7785835067,
#        38726.0335666978, 32828.110682293, 17608.7452420895, 2319.43686843869,
#        4033.35973502829, 3903.80018970186, 3311.36183006191, 1773.59006137191,
#        233.048959467158, 0.475582009698855, 0.458275800139556, 0.394584534944012,
#        0.199025545829367, 0.0263435294721906, 519.740553304247,
#        506.625217522785, 0.0555691462820393, NA, 601850.029512855,
#        553762.456283086, 482174.979105569, 280628.487044034, 34116.0905613888,
#        59501.7474723892, 54716.38022791, 47687.6570252827, 27748.4073510843,
#        3366.87369287059, 11.4934665205034, 10.8500226304997, 9.21143517197829,
#        5.35993318574334, 0.650351489016832, 5177.00620315402, 5042.97383436792,
#        10.1345767575323, 194, 71631.5956095614, 69418.9105949557,
#        57326.385906288, 32736.367696245, 3926.02003442729, 7064.33844356213,
#        6842.81479981682, 5661.89127120489, 3233.34761669673, 385.378335231643,
#        0.644365573637972, 0.663683030284247, 0.511660581214061,
#        0.287628047494307, 0.0370687743812539, 563.306077849202,
#        548.879860877202, 0.0425839474079928, NA, 2743755.85169042,
#        2457629.96854616, 2270499.69475853, 1471737.3108707, 141172.752852628,
#        269249.239190514, 241004.60417151, 222775.3918996, 144356.253970987,
#        13858.7962019428, 6.93977791608714, 6.37674133891817, 5.74193542607778,
#        3.7207174526056, 0.357204232461146, 38797.9619011101, 37794.3202275783,
#        10.2425565700675, 756, 161947.515511327, 154602.030983072,
#        134271.734246792, 86571.003603955, 8085.95673019662, 15922.7449045469,
#        15182.1446357243, 13194.0830476794, 8509.65673807873, 795.269943312593,
#        0.211316501948099, 0.201307103463217, 0.176310692136055,
#        0.109801419447066, 0.0101380917869725, 2074.56030358584,
#        2021.76396794453, 0.023872202408598, NA
#      ), .Dim = c(19L, 2L, 3L, 9L, 1L)),
#      VB.A.bagr.akl.dkl = structure(c(
#        164601.666771908,
#        159068.517373039, 122556.019151374, 101913.94283134, 28324.6975593222,
#        16224.2160782092, 15670.35852698, 12069.0505005601, 10075.6253481721,
#        2807.56494718213, 0.273630153958191, 0.270286165947464, 0.203551045589992,
#        0.16993085533102, 0.0473510969677532, 10.1032300767805, 40754.4628675392,
#        39796.7817333635, 31064.3951496661, 23405.7085226711, 6347.82070900417,
#        3945.89641656815, 3843.5055005196, 3001.69897224024, 2283.26456798477,
#        623.085926852964, 0.0656673543559168, 0.0654357293823441,
#        0.0499917413537403, 0.0378918554557618, 0.0103278880612781,
#        0.0117742644081858, 16956.5246337499, 16956.5246337499, 12224.3245067848,
#        8769.66105930804, 3377.55890799518, 1704.87001158061, 1704.87001158061,
#        1228.87391884129, 882.221548338703, 339.912672251576, 0.153684192943003,
#        0.157285273523283, 0.110775892099091, 0.079527181387664,
#        0.0306411658080907, 10.1086597938144, 11711.1925278546, 11711.1925278546,
#        8538.90022718331, 5953.02924796239, 2242.98391105933, 1173.49761849362,
#        1173.49761849362, 855.483125894881, 596.823616783546, 224.97799987214,
#        0.105099132738128, 0.107566488154876, 0.076624264979963,
#        0.0534379081603987, 0.0201399801881096, 0.0156085409970514,
#        518322.877721555, 478606.732631191, 387852.327450898, 367639.672361569,
#        100506.727242546, 51727.1097406814, 47778.8105979002, 38658.5085737582,
#        36745.5427964812, 10070.4855653751, 0.291146940845508, 0.274974905025564,
#        0.217590090869656, 0.206822929572834, 0.0566819039356051,
#        10.1489401063748, 62433.2636004542, 60721.7440290652, 47697.1533119657,
#        42006.1917076671, 10996.8126480104, 6214.5447880017, 6046.00656260907,
#        4733.88731915039, 4205.66257665902, 1110.23573526401, 0.0341840976281223,
#        0.0340069537947664, 0.0260572208722427, 0.0230701987476592,
#        0.00607812443873293, 0.0089443402357497, 8540098.36137485,
#        8139119.07031288, 6659692.20125055, 4382491.93966897, 1047536.48948593,
#        842651.698776517, 802681.360989388, 657067.800688344, 432529.39613717,
#        103418.50986664, 10.8354246404906, 10.5752068583164, 8.44905273245008,
#        5.5617756226516, 1.3298299543202, 10.1382388713208, 459745.643542899,
#        452830.47330599, 360825.657561198, 230435.867798424, 53946.999185585,
#        45389.4257967832, 44682.0466767539, 35622.9029305869, 22749.9072486399,
#        5327.39053158019, 0.449570312477336, 0.456262135758557, 0.354172619704049,
#        0.222165092751016, 0.0513641530941516, 0.0162404613017379,
#        564264.277109609, 483446.053879741, 435814.34913874, 270145.914283975,
#        74628.8151637772, 55752.1617018118, 47792.53547864, 43049.3716527677,
#        26702.318828963, 7390.96188373054, 5.99317071695312, 5.25653175030032,
#        4.62766331738873, 2.8704098710362, 0.794503656532678, 10.1052824651504,
#        97169.6141735738, 92649.6429520922, 76218.1938926985, 45174.395744416,
#        11401.4809027991, 9580.6138263763, 9138.62242985029, 7511.23496525031,
#        4457.32087268826, 1126.62363311096, 0.935297418703417, 0.915992238134732,
#        0.735044551222554, 0.433661372689602, 0.108455200968386,
#        0.0281570684449567, 13500917.778057, 12545050.3135319, 10539907.5582368,
#        7539922.62754191, 1735103.52767671, 1332300.73637148, 1237992.96524753,
#        1040052.51649467, 743994.844990613, 171283.542705362, 7.8222882831068,
#        7.44450872217735, 6.10642206484798, 4.36818955344271, 1.00565076083512,
#        10.1713179278822, 558638.094548909, 548689.833274609, 437842.34660451,
#        298611.488322951, 67409.8021915305, 55152.6430446119, 54158.4641324049,
#        43229.2952381508, 29467.3644586187, 6655.29669293341, 0.249856927344837,
#        0.252788415071932, 0.196354910965532, 0.130962082130537,
#        0.0293168538258076, 0.0116495238760414, 20467221.7404617,
#        19800315.9027597, 16272305.5599029, 9531763.49604424, 1893001.93617731,
#        2016459.03602111, 1950983.37602327, 1603104.54144965, 939287.571217436,
#        186603.211594632, 16.509689010281, 16.3798430227358, 13.1253633014669,
#        7.69038468672354, 1.52780737754337, 10.1375140186916, 834199.647123805,
#        820672.197341359, 664332.75403101, 384138.174193798, 75084.2838481405,
#        81998.3898085843, 80676.0546344462, 65296.6470471063, 37771.858018587,
#        7387.48751259402, 0.512355355608297, 0.520026408764378, 0.408576018527457,
#        0.234099867479197, 0.045107773926645, 0.0143026783154952,
#        1017880.63537713, 877372.775170662, 801137.868266314, 464682.450153758,
#        96791.8946734493, 99987.7760508441, 86288.3895518755, 78690.7460665033,
#        45667.2323975025, 9525.14311736243, 9.1171921395303, 8.05899282081936,
#        7.17526361548915, 4.1640783373049, 0.868531768456958, 10.101231367466,
#        122089.544258514, 117715.058559453, 96525.0352656106, 55022.0175951412,
#        10906.0701566894, 12060.0533973624, 11640.5096708205, 9534.33237349437,
#        5436.36760445979, 1078.42511725304, 0.915930833531695, 0.905042999069445,
#        0.723706929437271, 0.412886184875809, 0.0821472594764986,
#        0.0280899893334502, 31752374.3863842, 30136448.6682261, 25342658.6693496,
#        16450786.0001746, 3050239.87649551, 3124111.6234119, 2966058.03877368,
#        2493616.82383999, 1618186.54572703, 300183.35004707, 12.0030333857871,
#        11.6806494125497, 9.58063270326548, 6.21717450402133, 1.15332331452914,
#        10.1623028221912, 1018540.73260344, 1000047.45786217, 811221.210744926,
#        509938.219481864, 93862.7708716031, 99985.9422019626, 98186.6489340759,
#        79647.643179539, 50030.1692214559, 9216.18399365972, 0.286860759329676,
#        0.290451637835384, 0.228360112098484, 0.140310798172541,
#        0.0256510255201275, 0.0107132991917734, 14786823.0498919,
#        14290568.5302871, 11765215.278096, 6742450.2162543, 1171235.57850498,
#        1461458.2688481, 1412118.1003548, 1162819.42380856, 666434.053076934,
#        115806.077970864, 21.5092986044703, 21.3187940767226, 17.1140228516344,
#        9.80837383685093, 1.70439865741166, 10.1242729831144, 781084.604431422,
#        770111.749354302, 622412.49592339, 352392.017159729, 59443.5518809903,
#        77088.862904721, 75973.9508806265, 61430.0246868468, 34784.5102369525,
#        5872.91051975516, 0.897788870482499, 0.90812950915787, 0.715898765703805,
#        0.403627231503592, 0.0672683419092956, 0.0157236876160505,
#        1288532.35920189, 1250231.17368852, 1015960.43328273, 570606.61371136,
#        94649.7592614998, 126062.045330944, 122224.956835273, 99387.6636287993,
#        55813.4674968996, 9242.8465534776, 10.8527900293168, 10.7761981428673,
#        8.55636954038023, 4.80502947545989, 0.795724618419019, 10.1521093285799,
#        150267.442403526, 149688.554088585, 118431.3265224, 66271.8466124803,
#        10730.3102032108, 14725.5569760242, 14663.9891413326, 11602.7216977237,
#        6492.01968897812, 1045.70957893716, 0.996752191990831, 1.01911516296038,
#        0.785220163833675, 0.438848863102728, 0.0706782580346163,
#        0.0261167904448117, 24596749.9217483, 23515266.0274845, 19862939.7677413,
#        12859892.7092621, 2028232.07152201, 2423880.16473576, 2317289.48004177,
#        1957354.60974503, 1266450.41369128, 199797.577118887, 13.2393433803837,
#        12.9762510599232, 10.6911596425462, 6.91740959187053, 1.09130342684825,
#        10.1790796963947, 934570.388733266, 920215.515962597, 751099.617186485,
#        465978.25575237, 73092.1858832033, 92048.7066704707, 90613.5065031957,
#        73977.4157669587, 45857.6442032151, 7198.65192333802, 0.40365797597657,
#        0.407518896231817, 0.323616008535581, 0.196408908364509,
#        0.0308638508446299, 0.0113329205858632, 18877642.2203479,
#        18294719.0297836, 15070554.2670755, 8517809.74010817, 1371587.70601248,
#        1861676.02950046, 1804111.24895182, 1486227.01223688, 840045.276470491,
#        135285.993090898, 27.8866271132606, 27.7337337354567, 22.2626589369722,
#        12.5833007526419, 2.02649117418423, 10.1204804358593, 1021683.9966238,
#        1011917.09081811, 816883.002192477, 457424.383664861, 72064.2665423668,
#        100145.337440734, 99187.5086776849, 80066.130949245, 44848.9389537958,
#        7069.23436768611, 1.20614260017504, 1.22518816860716, 0.96491913017458,
#        0.539220314718781, 0.0841501152265126, 0.0158503473625613,
#        2406923.23571178, 2300603.43107806, 1905266.17270942, 1066133.12234757,
#        161867.628233523, 237259.124281876, 226681.979786472, 187796.191961691,
#        105082.74045658, 15950.2202067386, 14.3563042606501, 14.0561948743227,
#        11.363353375571, 6.35844795897201, 0.96513133058799, 10.1274314214464,
#        232830.120750522, 228283.376211021, 184581.251774954, 103002.49530291,
#        15013.4371677858, 22779.3573034897, 22311.0354354867, 18056.3202684557,
#        10076.2226339305, 1469.68978531216, 1.12554414157936, 1.1309774146726,
#        0.893435311983246, 0.497803059230472, 0.0722378234878478,
#        0.0228832334817858, 29981149.2693914, 28876713.7017516, 24316318.0525937,
#        15170365.1499985, 2206815.93714996, 2953082.30019726, 2844002.38696323,
#        2395028.01114484, 1493810.44952453, 217332.470034315, 16.1647591855483,
#        15.9634056869564, 13.1100481148842, 8.17690932074824, 1.1896475222077,
#        10.1839086294416, 1208708.32079051, 1190215.6627484, 975482.563142825,
#        585499.439630833, 85762.3224446075, 118786.41811286, 116915.532976772,
#        95874.7039831733, 57586.3499484438, 8431.8521571757, 0.524303296189258,
#        0.529554510839223, 0.421933279707779, 0.247576330642321,
#        0.036835721420102, 0.011581658130581, 13975737.7912423, 13400434.0402312,
#        11208931.207082, 6276771.46105825, 962442.644832892, 1381044.39406666,
#        1324025.6003615, 1107627.88224636, 620364.96622576, 95139.5686046261,
#        30.6928180529913, 30.2102853133829, 24.6163129920113, 13.7872099670521,
#        2.1144153521548, 10.0994770839742, 958055.362389463, 942722.773017166,
#        769799.636311846, 423612.892329916, 63352.2965952347, 94138.159011437,
#        92628.1977091484, 75636.3963116588, 41638.9640687125, 6231.02477925082,
#        1.72906257250486, 1.74147356210514, 1.39039668839319, 0.761992075111485,
#        0.112825318466557, 0.0181338329224343, 2838861.89346154,
#        2705061.17866147, 2247812.3722773, 1260701.59896744, 185258.809075923,
#        280396.985647738, 267117.078579315, 222016.444171873, 124520.796654315,
#        18293.4432401092, 15.9442756135062, 15.5738458529508, 12.6245700125112,
#        7.08065351303032, 1.04022409608485, 10.1220941883768, 267731.32130275,
#        261708.06527891, 212176.488451343, 118653.198412659, 16916.9122670716,
#        26495.6903281006, 25894.5019242825, 20997.2680578186, 11739.7547656668,
#        1670.85335489836, 1.22878983268178, 1.22940190327099, 0.974746402061141,
#        0.543524964954799, 0.0765063114948559, 0.0237672270305701,
#        25084186.7535645, 24032797.388817, 20444279.1721047, 12723494.7447636,
#        1740884.3044844, 2473589.12656597, 2369657.55796403, 2015955.47399472,
#        1254112.51397264, 171698.926149005, 16.4894634846483, 16.2028495355435,
#        13.4387816546001, 8.3601768307825, 1.14458102304883, 10.1881164587047,
#        1146489.50457548, 1126187.07291365, 930538.838116761, 552790.060982992,
#        76276.0630727074, 112809.667777208, 110820.055502438, 91559.2800831564,
#        54396.7705482606, 7510.50915797134, 0.634950632258515, 0.639166486691924,
#        0.512989243189229, 0.296113154925582, 0.0417184079516478,
#        0.0128092762497151, 6402099.95152697, 6093681.71028094, 5145623.43800317,
#        2907586.64108658, 442977.027270133, 640569.690246206, 609972.880223616,
#        514851.108742588, 290908.618994693, 44319.4611483621, 32.5750501541044,
#        31.855998310801, 26.1818517868679, 14.7936485261597, 2.25378860675702,
#        10.097875569044, 600860.66656769, 581249.676251327, 484035.328497891,
#        269636.011712707, 40304.6932036054, 60492.3295342708, 58408.2071326885,
#        48733.996028847, 27142.1926930848, 4054.47551745325, 2.45456383861301,
#        2.43143918478216, 1.98046673300025, 1.09658154007651, 0.161237864663163,
#        0.023783268562542, 2632178.10333042, 2540372.96548253, 2089070.95495691,
#        1176662.49278153, 168887.806471568, 260660.001771813, 251612.078156784,
#        206870.703479973, 116531.085402431, 16727.3927445841, 18.972686323754,
#        18.7796554807503, 15.0575191437917, 8.48196008316762, 1.21753845392459,
#        10.1307980049875, 269172.352444765, 266461.213060981, 213694.151606975,
#        120167.222317071, 16838.8091326037, 26633.9270709812, 26371.4073577224,
#        21142.2209388918, 11893.4476830482, 1667.63586834282, 1.54017028958115,
#        1.55746270274276, 1.22277321462162, 0.687750738520587, 0.0957138414629957,
#        0.0268056463789367, 15007127.6186613, 14259214.2103931, 12312197.591396,
#        7810056.31043066, 1018541.16259034, 1485688.75587506, 1411749.84571002,
#        1218536.98060648, 771882.39217, 100855.523266125, 16.4941139855489,
#        16.0826421737881, 13.5281954408358, 8.56943697631433, 1.1196978440103,
#        10.184072854098, 845583.35098328, 822238.057695638, 693158.645389811,
#        429737.72798464, 55691.5009210396, 83948.9360359475, 81560.0257803515,
#        68758.9897347969, 42467.7744169124, 5534.86996009598, 0.767337130753212,
#        0.762218491585795, 0.627647768785782, 0.381999581612171,
#        0.0499280438214798, 0.0146278201502411, 1749030.38650039,
#        1657513.90429877, 1406754.55299101, 804822.3862465, 123386.781268237,
#        175024.816150796, 165610.030566289, 140781.35178392, 80567.978390555,
#        12353.2457060232, 24.8070763008412, 24.1040854430242, 19.9535917948363,
#        11.4192720283565, 1.75088262071551, 10.0873404255319, 257273.33332507,
#        246249.314011783, 207133.334328417, 117821.708320035, 17889.9094560955,
#        26017.2915459086, 24723.3281532135, 20945.4964380449, 11947.048344623,
#        1817.10089793935, 3.15015710855846, 3.0531497604212, 2.53784711499748,
#        1.44543546784211, 0.218870490688263, 0.0330855513254736,
#        1786429.18732493, 1712321.05409962, 1420000.00772422, 801802.558233594,
#        113313.690893723, 174836.710583542, 167529.792761029, 138977.237012781,
#        78483.3516752917, 11101.155774812, 21.2484052055914, 20.9058004900677,
#        16.8903008787164, 9.53830607269792, 1.34915519381661, 10.1786399302528,
#        210926.831818353, 207911.778239303, 167709.278970337, 94559.795703805,
#        13173.7327340356, 20343.522700745, 20046.112884064, 16176.9044619057,
#        9122.09436414926, 1272.28018236223, 2.0118858687905, 2.01440265505179,
#        1.60082171472605, 0.902451642089967, 0.125261932640821, 0.031308212028184,
#        8554113.84388507, 8026222.39990408, 7134342.48724766, 4805532.36998802,
#        569982.890916566, 839909.607119664, 787244.402877776, 700384.374599559,
#        471383.78207558, 56006.9942691918, 14.8827066585636, 14.316685712432,
#        12.4104011991873, 8.35264472839353, 0.992411158856384, 10.2183315334773,
#        553679.482862224, 537898.62916945, 463069.111126775, 311205.355591937,
#        36224.0030177597, 54381.7621314169, 52633.1092059139, 45458.0384758971,
#        30530.5253819637, 3571.95232703828, 0.787883043514617, 0.774902683917398,
#        0.656730294167995, 0.436076345555383, 0.0515185761111636,
#        0.0174160016914307, 791960.145646667, 709288.028703759, 635950.191239152,
#        369125.600879427, 59042.586918195, 80650.1637067072, 72337.2868752159,
#        64774.7856309813, 37567.6139105316, 6005.49286611675, 21.1859747620377,
#        19.512996978836, 17.0156749908772, 9.86862869953861, 1.57758167432667,
#        10.0390191897655, 124859.795060633, 114549.850390938, 100044.316695172,
#        58655.330655786, 9573.76291482054, 12684.2268805969, 11663.1083156009,
#        10168.9413146208, 5949.080175853, 969.193813100773, 2.79647961574448,
#        2.52920982229059, 2.24701316278247, 1.30264578929547, 0.209233626025012,
#        0.0502634216289927, 1227431.00141429, 1163522.47122237, 974217.980157487,
#        556619.782250809, 79391.245373036, 121818.013968303, 115304.292847043,
#        96682.3437102456, 55242.4214464478, 7885.82019321454, 23.5305906904432,
#        22.8643448556569, 18.6753385868735, 10.6707273042849, 1.52323947157147,
#        10.1116212338594, 167047.483697122, 160668.841800497, 132711.617175637,
#        75569.1692845493, 10472.8824785812, 16644.3304706026, 15931.8363217603,
#        13220.8880516791, 7529.65611062985, 1044.75460875025, 2.86975476829711,
#        2.78559672806006, 2.27807716595988, 1.2995179475178, 0.180947936626384,
#        0.0392529463357284, 5239345.86687155, 4832802.1243919, 4298138.92515355,
#        2918870.07621609, 346067.436243082, 519432.472056528, 478984.051989891,
#        426152.780113464, 288947.754611188, 34315.1267704787, 13.3881381032457,
#        12.6734400593976, 10.9838960407163, 7.44749828219508, 0.884456942814228,
#        10.2005557761016, 401975.714282936, 382817.42770243, 335851.915079536,
#        231849.145993708, 25981.0840335016, 40037.7383381676, 38055.6253564935,
#        33437.7672705181, 23009.4722114438, 2590.64400447797, 0.874065453419145,
#        0.837673852007197, 0.734362883032103, 0.505867221464956,
#        0.056109316364756, 0.021447403005249
#      ), .Dim = c(16L, 2L, 3L, 9L, 1L))
#    ),
#    .Names = c(
#      "Stratum", "HBF", "se_HBF", "Attribute", "Größen", "BAGR",
#      "AKL", "DKL", "iVB.bagr.akl.dkl", "VB.A.bagr.akl.dkl"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("biotop.baeume.fun", {
#    result <- biotop.baeume.fun(
#      get_data("wzp4.merkmale.3"), get_data("baeume.3"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
#      list(Wa = c(5), Begehbar = 1)
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = 5, Begehbar = 1), .Names = c(
#        "Wa",
#        "Begehbar"
#      )), nTE = 13220L, HBF = 1322757.73306093, se.HBF = 15749.6881095356,
#      BL = 0, se.BL = 0, iBL = 20811.9219725169, se.iBL = 1467.71561573875,
#      LK = 1.01598524438979, se.LK = 0.00113354916119642, Biotopbaumkennwerte = structure(list(
#        Attribute = structure(c(
#          1L, 11L, 8L, 7L, 4L, 5L, 6L,
#          9L, 10L, 2L, 3L
#        ), .Label = c(
#          "Gesamtzahl", "oi_Biom_t",
#          "oi_Biom_t_je_ha", "Stueckvolumen_m3", "Vorrat_LB_m3",
#          "Vorrat_LB_m3_je_ha", "Vorrat_m3_je_ha", "Vorrat_m3_mR",
#          "Vorrat_NB_m3", "Vorrat_NB_m3_je_ha", "Zahl_je_ha"
#        ), class = "factor"),
#        Wert = c(
#          6709550.79578377, 5.07239581979803, 12942265.8364758,
#          9.78430555573225, 1.92893179147084, 10805951.7042934,
#          8.16925989862702, 2136314.13218241, 1.61504565710523,
#          7873024.0402428, 5.95197732998637
#        ), SE = c(
#          327674.341242166,
#          0.241549365104805, 491955.737254008, 0.355967465425346,
#          0.0843224821838681, 464516.334767252, 0.340271554893727,
#          149666.617905277, 0.111248414389223, 301207.82430717,
#          0.218160149483105
#        )
#      ), .Names = c(
#        "Attribute", "Wert",
#        "SE"
#      ), row.names = c(NA, -11L), class = "data.frame")
#    ), .Names = c(
#      "Stratum",
#      "nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", "LK",
#      "se.LK", "Biotopbaumkennwerte"
#    ))
#  
#    if (Sys.info()[["nodename"]] == "h6") {
#      reference$Biotopbaumkennwerte$Attribute <- NULL
#      result$Biotopbaumkennwerte$Attribute <- NULL
#    }
#    testthat::expect_equal(result, reference)
#  })
#  
#  test_that("stamm.merkmale.bagr.fun", {
#    result <- stamm.merkmale.bagr.fun(
#      get_data("wzp4.merkmale.3"), get_data("baeume.3"), get_data("ecken.3"),
#      get_data("trakte.3"), get_design("a", 3), list(Wa = c(3, 5), Begehbar = 1), c(
#        "tot", "jschael",
#        "aeschael", "ruecke", "pilz", "harz", "kaefer", "sstamm", "faulkon",
#        "hoehle", "bizarr", "uralt", "horst", "mbiotop"
#      ),
#      list(
#        bagr.lab = c("FiTa", "DglKiLae", "Bu", "Ei", "BLb", "WLb"),
#        ba.grupp = list(
#          c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51), c(100),
#          c(110, 111), c(112:199), c(200:299)
#        )
#      )
#    )
#  
#    result[["Log"]] <- NULL
#  
#    reference <- structure(list(
#      Stratum = structure(list(Wa = c(3, 5), Begehbar = 1),
#        .Names = c("Wa", "Begehbar")
#      ),
#      nTE = 13232L,
#      HBF = 1323958.42086703, se.HBF = 15760.6334334331,
#      BL = 900.515854580056, se.BL = 300.037156773676,
#      iBL = 20811.9219725169, se.iBL = 1467.71561573875,
#      LK = 1.01667306953515, se.LK = 0.00115571516765233,
#      Merkmal = c(
#        "tot", "jschael", "aeschael", "ruecke", "pilz", "harz", "kaefer",
#        "sstamm", "faulkon", "hoehle", "bizarr", "uralt", "horst",
#        "mbiotop"
#      ),
#      BAGR = c("FiTa", "DglKiLae", "Bu", "Ei", "BLb", "WLb", "Alle BA"),
#      Kennwerte = c(
#        "Gesamtzahl", "Zahl_je_ha", "Vorrat_m3_mR",
#        "Vorrat_m3_mR_je_ha", "Stueckvolumen_m3_mR", "oi_Biom_t",
#        "oi_Biom_t_je_ha", "Anteil_Gesamtzahl_Proz",
#        "Anteil_Gesamtvorrat_Proz"
#      ),
#      Kennwert_Tabelle_BAGR = structure(c(
#        89695753.8057177,
#        67.7481651931167, 83095663.8384966, 62.7630464286627, 0.926416918447254,
#        38105375.1582274, 28.7813986886937, 23.2132806547925, 32.4240678949479,
#        2377246.19625395, 1.60210051626666, 1956206.9130449, 1.25877624947745,
#        0.0189693589469703, 888935.26940512, 0.570188535831128, 0.481485675613238,
#        0.402537316453643, 8882695.48788189, 6.70919520423065, 10058755.5682178,
#        7.5974860008296, 1.13239900905533, 4950511.46515792, 3.73917442355624,
#        15.0364649130486, 18.7455777176004, 575013.835860921, 0.426567464343704,
#        420111.024439687, 0.302780254574028, 0.0644900042004985,
#        205433.740447369, 0.147972818109697, 0.807401770742645, 0.552803958093853,
#        50483736.2163681, 38.1309076030555, 43831438.2736358, 33.1063555945597,
#        0.868228890305954, 30658369.1722526, 23.1565951687328, 28.8264199173178,
#        41.7819120897264, 1784980.91168493, 1.26375197581323, 1287251.58213046,
#        0.888095229398133, 0.025698688102938, 890732.24173362, 0.61308178797102,
#        0.75558977710506, 0.607375395472574, 5495043.46717953, 4.15046528695435,
#        9773075.5483392, 7.38170881676104, 1.77852561252905, 5926222.36681631,
#        4.47613933595841, 16.2891406939986, 31.1996035653732, 329543.493128396,
#        0.244445447743738, 456577.700165448, 0.334762253744116, 0.101136758195115,
#        272773.263967828, 0.199850109847114, 0.96066473373273, 0.867128607064576,
#        21536752.566999, 16.2669402811722, 9573369.22354792, 7.23086848700166,
#        0.444513126747683, 6439873.48672588, 4.86410553777703, 16.7397840281568,
#        23.0794742858551, 1083658.99082034, 0.803776752947566, 384445.478662016,
#        0.281657254358524, 0.0207799997081815, 256145.971724533,
#        0.187581004176714, 0.712855747774121, 0.654522710469491,
#        6476073.19362614, 4.89144756478461, 2232806.04645874, 1.68646236261447,
#        0.344777765738705, 1197126.81580717, 0.904202727924943, 13.9842793207218,
#        19.3724532434289, 602571.627417594, 0.452715145209704, 189543.2221267,
#        0.142587527421648, 0.0357254330436087, 89219.3116815136,
#        0.067020279387667, 1.19386664918554, 1.17628515209512, 182570054.737772,
#        137.897121133314, 158565108.498696, 119.765927690429, 0.868516519461228,
#        87277478.4649873, 65.9216158826431, 22.014877943659, 31.7655987844916,
#        3498167.23879566, 2.09070269502752, 2653648.86038485, 1.40028620322026,
#        0.013592518478361, 1460884.60733739, 0.775711380087284, 0.329028469218415,
#        0.292977792491541
#      ), .Dim = c(9L, 2L, 7L))
#    ),
#    .Names = c(
#      "Stratum", "nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL",
#      "LK", "se.LK", "Merkmale", "BAGR", "Kennwerte",
#      "Kennwert_Tabelle_BAGR"
#    )
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("ba.klass.fun", {
#    result <- ba.klass.fun(100, list(
#      c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51),
#      c(100), c(110, 111), c(112, 120:199), c(200:299)
#    ))
#  
#    expect_equal(result, 3)
#  })
#  
#  test_that("ba.klass.lab.tab.fun", {
#    result <- ba.klass.lab.tab.fun(list(bagr.lab = c(
#      "FiTa", "DglKiLae", "Bu", "Ei",
#      "BLb", "WLb"
#    ), bacode = list(
#      c(10:19, 30:39, 90:99),
#      c(20:29, 40, 50, 51), c(100), c(110, 111), c(112:199), c(200:299)
#    )))
#  
#    reference <- structure(list(
#      ICode = structure(c(
#        10L, 11L, 12L, 13L, 14L, 15L,
#        16L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 29L, 30L, 31L,
#        32L, 33L, 34L, 35L, 36L, 39L, 40L, 50L, 51L, 90L, 91L, 92L, 93L,
#        94L, 95L, 99L, 100L, 110L, 111L, 112L, 113L, 114L, 120L, 121L,
#        130L, 140L, 141L, 142L, 143L, 144L, 150L, 160L, 170L, 180L, 181L,
#        190L, 191L, 192L, 193L, 194L, 195L, 196L, 199L, 200L, 201L, 210L,
#        211L, 212L, 213L, 220L, 221L, 222L, 223L, 224L, 230L, 240L, 250L,
#        251L, 252L, 290L, 291L, 292L, 293L, 294L, 295L, 296L, 299L, 998L,
#        999L
#      ), label = "ICode", class = c("labelled", "integer")),
#      bagr.nr = c(
#        1,
#        1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
#        1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 3, 4, 4, 5, 5, 5, 5, 5,
#        5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6,
#        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
#        6, NA, NA
#      ),
#      bagr = c(
#        "FiTa", "FiTa", "FiTa", "FiTa", "FiTa",
#        "FiTa", "FiTa", "FiTa", "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae",
#        "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae", "FiTa",
#        "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "DglKiLae",
#        "DglKiLae", "DglKiLae", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa",
#        "FiTa", "FiTa", "Bu", "Ei", "Ei", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb",
#        "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb",
#        "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", NA, NA
#      )
#    ),
#    .Names = c("ICode", "bagr.nr", "bagr"),
#    row.names = c(NA, -88L), class = "data.frame"
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("dkl.lab.fun", {
#    result <- dkl.lab.fun(list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F), 5)
#  
#    reference <- c("0-399.9", "400-799.9", "800-1199.9", "1200-1599.9", ">=400")
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("akl.lab.fun", {
#    result <- akl.lab.fun(list(A.ob = 160, A.b = 20), 5)
#  
#    reference <- c("1-20", "21-40", "41-60", "61-80", ">160")
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verjg.tab.fun", {
#    vj.tab <- verjg.bagrupp.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(
#        bagr.lab = c("FiTa", "DglKiLae", "Bu", "Ei", "BLb", "WLb"),
#        bacode = list(
#          c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51), c(100),
#          c(110, 111), c(112:199), c(200:299)
#        )
#      ),
#      list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
#    )
#  
#    result <- verjg.tab.fun(vj.tab)
#  
#    reference <- structure(list(
#      BAGR = structure(c(6L, 4L, 3L, 5L, 2L, 7L, 1L),
#        .Label = c(
#          "Alle",
#          "BLb", "Bu", "DglKiLae", "Ei", "FiTa", "WLb"
#        ), class = "factor"
#      ),
#      Stückzahl_Verj_Mio = c(
#        5163.795, 190.618, 5601.324, 429.646,
#        6839.543, 917.337, 19142.264
#      ), SE_Stückzahl_Verj_Mio = c(
#        215.931,
#        30.584, 197.399, 55.582, 248.897, 54.089, 443.47
#      ), Anteil_Proz = c(
#        27,
#        1, 29.3, 2.2, 35.7, 4.8, 100
#      ), SE_Anteil_Proz = c(
#        0.98, 0.16,
#        0.78, 0.28, 0.89, 0.28, 0
#      )
#    ), .Names = c(
#      "BAGR", "Stückzahl_Verj_Mio",
#      "SE_Stückzahl_Verj_Mio", "Anteil_Proz", "SE_Anteil_Proz"
#    ), row.names = c(
#      NA,
#      -7L
#    ), class = "data.frame")
#  
#    expect_equal(result, reference)
#  })
