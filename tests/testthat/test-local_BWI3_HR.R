#' Testing of BWI3_HR_Funktionen_v3.r
#'
#' Tests the outputs of the functions of the file BWI3_HR_Funktionen_v3.r.
#'
#' @author Franziska Berg
#' @section Version: 15.09.2015
#' @name A Header for
NULL

if (interactive()) devtools::load_all()
if (FALSE) {
    dump("result")
}
context("Examples of existing scripts")


test_that("FVBN.bagrupp.akl.dkl.stratum.fun.2e", {
  FVBN <- FVBN.bagrupp.akl.dkl.stratum.fun.2e
  result <- FVBN(
    get_data("baeume.3")[1:10, TRUE], get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    list(A.ob = 200, A.b = 60),
    list(
      D.unt = 0, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(Wa = c(3, 5), Begehbar = 1)
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042091.28927, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1), .Names = c("Wa", "Begehbar")), nTE = 97L, 
    HBF = 902724.87, se.HBF = 23749.5302613181, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = c("1-60", "61-120", "121-180", 
    ">200", "Alle AKl"), DKL = c("0-6.9", "0-24.9", ">=50", "Alle DKl"
    ), T.FVBN.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 94340.6067294845, 28450121.8057453, 
    0, 0, 0, 0, 0, 94340.6067294845, 28450121.8057453, 0, 0, 
    0, 0, 0, 94340.6067294845, 28450121.8057453, 0, 0, 0, 0, 
    0, 94340.6067294845, 28450121.8057453, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 6544.308414, 890454.936067471, 
    890454.936067471, 821302.940164437, 17315119.6925016, 17315119.6925016, 
    17315119.6925016, 6544.308414, 890454.936067471, 890454.936067471, 
    821302.940164437, 17315119.6925016, 17315119.6925016, 17315119.6925016, 
    6544.308414, 890454.936067471, 890454.936067471, 821302.940164437, 
    17315119.6925016, 17315119.6925016, 17315119.6925016, 6544.308414, 
    890454.936067471, 890454.936067471, 821302.940164437, 17315119.6925016, 
    17315119.6925016, 17315119.6925016, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2393.561586, 1703037.63076889, 
    1703037.63076889, 1173242.97147497, 688454.265570117, 688454.265570117, 
    688454.265570117, 2393.561586, 1703037.63076889, 1703037.63076889, 
    1173242.97147497, 688454.265570117, 688454.265570117, 688454.265570117, 
    2393.561586, 1703037.63076889, 1703037.63076889, 1173242.97147497, 
    688454.265570117, 688454.265570117, 688454.265570117, 2393.561586, 
    1703037.63076889, 1703037.63076889, 1173242.97147497, 688454.265570117, 
    688454.265570117, 688454.265570117, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 6544.308414, 890454.936067471, 890454.936067471, 915643.546893922, 
    45765241.498247, 17315119.6925016, 17315119.6925016, 6544.308414, 
    890454.936067471, 890454.936067471, 915643.546893922, 45765241.498247, 
    17315119.6925016, 17315119.6925016, 6544.308414, 890454.936067471, 
    890454.936067471, 915643.546893922, 45765241.498247, 17315119.6925016, 
    17315119.6925016, 6544.308414, 890454.936067471, 890454.936067471, 
    915643.546893922, 45765241.498247, 17315119.6925016, 17315119.6925016, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2393.561586, 
    1703037.63076889, 1703037.63076889, 1173242.97147497, 688454.265570117, 
    688454.265570117, 688454.265570117, 2393.561586, 1703037.63076889, 
    1703037.63076889, 1173242.97147497, 688454.265570117, 688454.265570117, 
    688454.265570117, 2393.561586, 1703037.63076889, 1703037.63076889, 
    1173242.97147497, 688454.265570117, 688454.265570117, 688454.265570117, 
    2393.561586, 1703037.63076889, 1703037.63076889, 1173242.97147497, 
    688454.265570117, 688454.265570117, 688454.265570117, 0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA), .Dim = c(7L, 
    2L, 3L, 5L, 4L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NaN, NaN, 
    Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 0, NaN, 
    NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0.724950495049505, 136.065551886667, 
    136.065551886667, 125.498813351683, 2645.82880223983, 2645.82880223983, 
    2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, NaN, NaN, NaN, 0.724950495049505, 
    136.065551886667, 136.065551886667, 125.498813351683, 2645.82880223983, 
    2645.82880223983, 2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.265148514851485, 
    711.507755108539, 711.507755108539, 490.166193482254, 287.627554518297, 
    287.627554518297, 287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0.265148514851485, 711.507755108539, 
    711.507755108539, 490.166193482254, 287.627554518297, 287.627554518297, 
    287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0.724950495049505, 136.065551886667, 136.065551886667, 
    139.914485835527, 6993.13641764545, 2645.82880223983, 2645.82880223983, 
    0.725273811922906, 2.03132467589353e-06, 2.03132467589353e-06, 
    NaN, 7.49859175719016e-05, NaN, NaN, 0.724950495049505, 136.065551886667, 
    136.065551886667, 139.914485835527, 6993.13641764545, 2645.82880223983, 
    2645.82880223983, 0.725273811922906, 2.03132467589353e-06, 
    2.03132467589353e-06, NaN, 7.49859175719016e-05, NaN, NaN, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.265148514851485, 
    711.507755108539, 711.507755108539, 490.166193482254, 287.627554518297, 
    287.627554518297, 287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0.265148514851485, 711.507755108539, 
    711.507755108539, 490.166193482254, 287.627554518297, 287.627554518297, 
    287.627554518297, 0.265266767048558, 1.42440400939131e-05, 
    1.42440400939131e-05, 0, 1.14507157791607e-06, 1.14507157791607e-06, 
    1.14507157791607e-06, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, 
    NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA), .Dim = c(7L, 2L, 3L, 5L, 4L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 
    0, 0), .Dim = c(3L, 5L, 4L))), .Names = c("Log", "Stratum", 
"nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", "LK", 
"se.LK", "Attribute1", "Attribute2", "Größen", "BAGR", "AKL", 
"DKL", "T.FVBN.Bagr.Akl.Dkl", "FVBN.ha.Bagr.Akl.Dkl", "nT.Bagr.Akl.Dkl"
))

  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

  # FIXME: Es geht um unbesetzte
  # Klassen.
  A.klass <- list(A.ob = 100, A.b = 50)
  result <- FVBN(
    get_data("baeume.3")[1:10, ], get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    A.klass,
    list(
      D.unt = 10, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(
      Wa = c(3, 5), Begehbar = 1,
      BTyp = c(
        110, 117, 170, 171, 410, 417, 470,
        471
      )
    )
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042226.82537, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1, BTyp = c(110, 117, 170, 171, 410, 417, 470, 
    471)), .Names = c("Wa", "Begehbar", "BTyp")), nTE = 22L, 
    HBF = 196633.14, se.HBF = 37211.3201732967, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = c("1-50", "51-100", ">100", "Alle AKl"
    ), DKL = c("0-6.9", ">=50", "25-49.9", "Alle DKl"), T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA
    ), .Dim = c(7L, 2L, 3L, 4L, 3L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 
    0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, 
    NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA), .Dim = c(7L, 2L, 3L, 4L, 3L)), 
    nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0), .Dim = c(3L, 4L, 3L))), .Names = c("Log", 
"Stratum", "nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", 
"LK", "se.LK", "Attribute1", "Attribute2", "Größen", "BAGR", 
"AKL", "DKL", "T.FVBN.Bagr.Akl.Dkl", "FVBN.ha.Bagr.Akl.Dkl", 
"nT.Bagr.Akl.Dkl"))
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  expect_equal(result, reference)



  result <- FVBN(
    get_data("baeume.3"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), 2,
    get_bwi_species_groups("bc"),
    list(A.ob = 100, A.b = 100),
    list(
      D.unt = 0, D.ob = 50, D.b = 25,
      Ndh = T
    ),
    list(
      Wa = c(3, 5), Begehbar = 1,
      BTyp = c(
        110, 117, 170, 171, 410, 417, 470,
        471
      )
    )
  )
  reference <- structure(list(Log = structure(list(Datum = structure(1524042413.70462, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), .Names = c("Datum", 
"Version.baeume.b")), Stratum = structure(list(Wa = c(3, 5), 
    Begehbar = 1, BTyp = c(110, 117, 170, 171, 410, 417, 470, 
    471)), .Names = c("Wa", "Begehbar", "BTyp")), nTE = 22L, 
    HBF = 196633.14, se.HBF = 37211.3201732967, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Laub", 
    "Nadel", "Alle BA"), AKL = "0-100", DKL = c("0-6.9", "7-24.9", 
    "25-49.9", ">=50", "Alle DKl"), T.FVBN.Bagr.Akl.Dkl = structure(c(25001.009964, 
    0, 0, 715989.970671322, 839278583.491457, 0, 0, 12501.0781241518, 
    0, 0, 351532.984159414, 327950143.98932, 0, 0, 3512.58291, 
    0, 0, 823254.064346614, 896178836.076569, 0, 0, 2810.02761350344, 
    0, 0, 528856.666696164, 385828828.697263, 0, 0, 28513.592874, 
    0, 0, 1539244.03501794, 1735457419.56803, 0, 0, 14436.4072398458, 
    0, 0, 690909.970989775, 525423573.80515, 0, 0, 20111.101287, 
    6638810.86985571, 5353046.08500619, 3615089.85626865, 80250165.2907245, 
    80250165.2907245, 60564896.5303032, 8365.41269657964, 2307015.91345702, 
    2066306.61221709, 1213930.06616078, 29611155.3021901, 29611155.3021901, 
    26931453.0544488, 19389.815178, 3157189.9894304, 2260034.0376805, 
    2335000.59415371, 36816865.9553439, 36816865.9553439, 29091519.1617808, 
    10599.4502352793, 1242070.10691958, 1126831.12954274, 895243.121567699, 
    16341130.8701344, 16341130.8701344, 15781669.9720207, 39500.916465, 
    9796000.85928611, 7613080.12268669, 5950090.45042236, 117067031.246068, 
    117067031.246068, 89656415.692084, 14659.5684825652, 2770643.53772336, 
    2371272.95042685, 1634100.00153254, 38715820.8259585, 38715820.8259585, 
    36414432.5631145, 66460.213746, 35948052.8939664, 35948052.8939664, 
    16262001.6151415, 27513706.2979703, 27513706.2979703, 27513706.2979703, 
    18502.4203501686, 9978916.98914107, 9978916.98914107, 4475642.33681386, 
    7970713.00588864, 7970713.00588864, 7970713.00588864, 31935.00951, 
    13343894.8947869, 13343894.8947869, 8640833.87300603, 9823755.01215105, 
    9823755.01215105, 9823755.01215105, 10740.7723651134, 4677937.07847827, 
    4677937.07847827, 2994825.03307891, 3695470.85804881, 3695470.85804881, 
    3695470.85804881, 98395.223256, 49291947.7887534, 49291947.7887534, 
    24902835.4881475, 37337461.3101213, 37337461.3101213, 37337461.3101213, 
    23594.6975131845, 12466881.8683522, 12466881.8683522, 6214717.30884693, 
    9957956.00115923, 9957956.00115923, 9957956.00115923, 20953.942428, 
    12620457.0036651, 12620457.0036651, 5944126.47123023, 3512306.92948902, 
    3512306.92948902, 3512306.92948902, 7731.51595120872, 4765102.07350757, 
    4765102.07350757, 2211769.08375672, 1264725.59655637, 1264725.59655637, 
    1264725.59655637, 9269.464977, 7090855.16092761, 7090855.16092761, 
    4540011.39858352, 1597384.70335881, 1597384.70335881, 1597384.70335881, 
    4904.33277558503, 4006460.34649492, 4006460.34649492, 2652654.88712891, 
    1042737.69297755, 1042737.69297755, 1042737.69297755, 30223.407405, 
    19711312.1645927, 19711312.1645927, 10484137.8698138, 5109691.63284783, 
    5109691.63284783, 5109691.63284783, 10457.5597881809, 7237623.05327174, 
    7237623.05327174, 4030638.312509, 1914001.3904722, 1914001.3904722, 
    1914001.3904722, 132526.267425, 55207320.7674873, 53921555.9826377, 
    26537207.9133117, 950554762.009641, 111276178.518184, 91590909.7577625, 
    28611.4332734361, 14072202.4791532, 13989631.5417179, 6422717.04284627, 
    340972264.320483, 31791942.5113843, 28849467.5623885, 64106.872575, 
    23591940.0451449, 22694784.093395, 16339099.9300899, 944416841.747423, 
    48238005.6708538, 40512658.8772907, 18352.3185620041, 8754253.25461518, 
    8666880.43334075, 5745492.42193943, 400856361.801671, 17708382.5807943, 
    17086063.3619495, 196633.14, 78799260.8126322, 76616340.0760328, 
    42876307.8434015, 1894971603.75706, 159514184.189038, 132103568.635053, 
    37211.3201732967, 19282537.879301, 18876034.2951277, 10226746.104066, 
    553719945.322517, 42361746.7699505, 38906261.3827475), .Dim = c(7L, 
    2L, 3L, 1L, 5L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(12.7145454545455, 
    0, 0, 28.6384418750405, 33569.7871685972, 0, 0, 5.88465445002426, 
    0, 0, 6.08257687011909, 13084.9280380629, 0, 0, 1.78636363636364, 
    0, 0, 234.372849108525, 255133.859908397, 0, 0, 1.38851104150071, 
    0, 0, 224.392237962522, 222493.635530821, 0, 0, 14.5009090909091, 
    0, 0, 53.9828159088814, 60864.2140342298, 0, 0, 6.80965741711948, 
    0, 0, 24.0750234015063, 28233.8183979682, 0, 0, 10.2277272727273, 
    330.106779092555, 266.17369226152, 179.755937016014, 3990.34165983734, 
    3990.34165983734, 3011.51566321497, 3.78854137080018, 79.9405287733648, 
    55.5433251720864, 39.43904270818, 1066.90977674431, 1066.90977674431, 
    897.643121383423, 9.86090909090909, 162.827234836802, 116.557791651607, 
    120.424076904201, 1898.77343426754, 1898.77343426754, 1500.35051364433, 
    5.05715632361018, 83.35533382529, 60.7709367886397, 61.2627682940482, 
    926.459475998935, 926.459475998935, 767.300381486929, 20.0886363636364, 
    247.994267878972, 192.731733944257, 150.631706373053, 2963.65354838783, 
    2963.65354838783, 2269.73001427763, 6.41319022056744, 74.5715267281013, 
    54.8924918596767, 43.3898918765314, 838.758539799309, 838.758539799309, 
    723.989106517375, 33.7990909090909, 540.895836287166, 540.895836287166, 
    244.687771804228, 413.987628795826, 413.987628795826, 413.987628795826, 
    6.90139229959304, 64.794735338115, 64.794735338115, 28.6017636378615, 
    70.1914635566295, 70.1914635566295, 70.1914635566295, 16.2409090909091, 
    417.845339629802, 417.845339629802, 270.575584776334, 307.617099944025, 
    307.617099944025, 307.617099944025, 4.51563528890422, 62.2232360649459, 
    62.2232360649459, 38.0078945247886, 50.9526931148652, 50.9526931148652, 
    50.9526931148652, 50.04, 500.958747362237, 500.958747362237, 
    253.089882456555, 379.464165785553, 379.464165785553, 379.464165785553, 
    7.36949100657352, 54.177678764847, 54.177678764847, 27.3159647121912, 
    55.6499771068279, 55.6499771068279, 55.6499771068279, 10.6563636363636, 
    602.295107330296, 602.295107330296, 283.675804286229, 167.620338824433, 
    167.620338824433, 167.620338824433, 3.37541243552276, 109.455221264039, 
    109.455221264039, 48.0456910062958, 24.3959763663359, 24.3959763663359, 
    24.3959763663359, 4.71409090909091, 764.969194934324, 764.969194934324, 
    489.781385424994, 172.327605457526, 172.327605457526, 172.327605457526, 
    2.32915224651573, 122.734247441296, 122.734247441296, 90.3393112304059, 
    55.379769302317, 55.379769302317, 55.379769302317, 15.3704545454545, 
    652.186958950624, 652.186958950624, 346.888017268341, 169.064049078811, 
    169.064049078811, 169.064049078811, 4.45237524566247, 102.769248131593, 
    102.769248131593, 63.6990536213772, 27.8214740607843, 27.8214740607843, 
    27.8214740607843, 67.3977272727273, 416.576440581717, 406.874478775714, 
    200.241117696382, 7172.57627849199, 839.653758309897, 691.115139190019, 
    7.00317820268531, 68.0061956152618, 67.0967727037605, 28.5588016848545, 
    1962.44913155955, 177.588736869332, 154.771241078858, 32.6022727272727, 
    368.00952998517, 354.014837751505, 254.872828353534, 14731.9125674479, 
    752.462313840362, 631.955003418613, 7.00317820268532, 88.5572302601882, 
    88.2309311530625, 55.8553458280702, 5639.23239718849, 231.947584885477, 
    225.08739278241, 100, 400.74252393382, 389.641034446344, 
    218.052297000402, 9637.09171178909, 811.227365789091, 671.82759038, 
    0, 62.17019600073, 61.466948220954, 31.6573225582124, 2145.65509367677, 
    151.143880330936, 151.609067001973), .Dim = c(7L, 2L, 3L, 
    1L, 5L)), nT.Bagr.Akl.Dkl = structure(c(12L, 14L, 18L, 10L, 
    9L, 15L, 16L, 11L, 17L, 9L, 4L, 10L, 21L, 17L, 22L), .Dim = c(3L, 
    1L, 5L))), .Names = c("Log", "Stratum", "nTE", "HBF", "se.HBF", 
"BL", "se.BL", "iBL", "se.iBL", "LK", "se.LK", "Attribute1", 
"Attribute2", "Größen", "BAGR", "AKL", "DKL", "T.FVBN.Bagr.Akl.Dkl", 
"FVBN.ha.Bagr.Akl.Dkl", "nT.Bagr.Akl.Dkl"))

  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fvbn.kreis.fun.1", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  result <- fvbn.kreis.fun.1(316, eig.list = ("GW"), c(3), bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524119010.50474, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316), nTE = 1L, HBF = 8937.87, 
    se.HBF = 8937.87, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "GW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)

  # 
  result <- fvbn.kreis.fun.1(316, eig.list = ("oew"), c(3), bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524119438.17643, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316, EigArt = c("BW", 
    "StW", "KW")), nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "OEW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)
  # 
  result <- fvbn.kreis.fun.1(kreiscode = 316, eig.list =  c("KW"), bwi.list = c(1,2,3), bagr = bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524121804.40586, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1, Kreis = 316, EigArt = "KW"), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 0, 
    0, 1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0), .Dim = c(7L, 2L, 10L, 1L, 1L)), 
    FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 16.17, 0, 0, 167.639749253353, 103347.358181818, 0, 0, 
    NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 29.4, 0, 0, 53.6408969374879, 56841.047, 
    0, 0, 0, 0, 0, NaN, 0, 0, 0, 54.43, 0, 0, 48.8934310456017, 
    57018.5773690979, 0, 0, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 0, 0, 69.4904656720095, 
    64457.747298, 0, 0, 0, 0, 0, NaN, NaN, 0, 0), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 1), list(Log = list(Datum = structure(1524121804.52388, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1, Kreis = 316, EigArt = "KW"), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1995.83474475, 233565.905141122, 233565.905141122, 385906.375875682, 
    48162660.8611504, 1713289.50560511, 1713289.50560511, 1995.83474475, 
    233565.905141122, 233565.905141122, 385906.375875682, 48162660.8611504, 
    1713289.50560511, 1713289.50560511, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 4173.10901175, 114127.147714695, 114127.147714695, 
    190744.356201362, 24734479.0237019, 6154729.6234446, 6154729.6234446, 
    4173.10901175, 114127.147714695, 114127.147714695, 190744.356201362, 
    24734479.0237019, 6154729.6234446, 6154729.6234446, 2768.9637435, 
    217211.536915238, 217211.536915238, 158858.272170474, 2497689.08951981, 
    2497689.08951981, 2497689.08951981, 2768.9637435, 217211.536915238, 
    217211.536915238, 158858.272170474, 2497689.08951981, 2497689.08951981, 
    2497689.08951981, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.9075, 564904.589771055, 564904.589771055, 735509.004247517, 
    75394828.9743721, 10365708.2185695, 10365708.2185695, 8937.9075, 
    564904.589771055, 564904.589771055, 735509.004247517, 75394828.9743721, 
    10365708.2185695, 10365708.2185695), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 22.33, 117.02667555794, 117.02667555794, 
    193.355876227128, 24131.5875414241, 858.432548141514, 858.432548141514, 
    1.07607059257956e-07, 0, 0, NaN, 0.000277104569367169, NaN, 
    NaN, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 46.69, 
    27.3482306341276, 27.3482306341276, 45.707973519094, 5927.11068751339, 
    1474.85474405654, 1474.85474405654, 0, 5.07631858224566e-07, 
    5.07631858224566e-07, 7.37181051620592e-07, NaN, NaN, NaN, 
    30.98, 78.445063582046, 78.445063582046, 57.3710192281807, 
    902.030261459006, 902.030261459006, 902.030261459006, NaN, 
    8.38334274432894e-07, 8.38334274432894e-07, 1.07087652248254e-06, 
    1.13711649026579e-05, 1.13711649026579e-05, 1.13711649026579e-05, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 63.20322623288, 
    63.20322623288, 82.290961754473, 8435.400453, 1159.746643, 
    1159.746643, 0, 8.37673426785977e-07, 8.37673426785977e-07, 
    0, 0.000107895932187889, 1.34869915234861e-05, 1.34869915234861e-05
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 2), list(Log = list(Datum = structure(1524121804.64467, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 316, EigArt = "KW"), 
    nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, BL = 0, se.BL = 0, 
    iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Kreis = "Emmendingen", 
    Eigentumsart = "KW", BWI = 3))

    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  # 
  result <- fvbn.kreis.fun.1(kreiscode = 225, eig.list =  c("GPW"), bwi.list = c(3), bagr = bagr.xx)


  reference <- list(list(Log = list(Datum = structure(1524121567.63566, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1, Kreis = 225, EigArt2 = "GPW"), 
    nTE = 2L, HBF = 17875.74, se.HBF = 12576.0562730192, BL = 0, 
    se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(8937.87, 
    2820395.55567093, 2820395.55567093, 1249295.44292603, 15019542.5702785, 
    794481.649530066, 794481.649530066, 8937.87, 2820395.55567093, 
    2820395.55567093, 1249295.44292603, 15019542.5702785, 794481.649530066, 
    794481.649530066, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 
    0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 
    0, 270.276148279905, 7112530.44249846, 0, 0, 0, 0, 0, 270.276148279905, 
    7112530.44249846, 0, 0, 17875.74, 5586244.34607582, 5586244.34607582, 
    2820817.69198567, 24531174.3755127, 3193583.01226583, 3193583.01226583, 
    12576.0562730192, 3930261.94450396, 3930261.94450396, 1997644.35115118, 
    22237618.4600987, 2519599.67871247, 2519599.67871247), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(50, 
    315.555669938243, 315.555669938243, 139.775521788304, 1680.4386918, 
    88.8893718, 88.8893718, 35.5334527259351, 3.37174788087152e-06, 
    3.37174788087152e-06, 0, 0, 9.93413444728961e-07, 9.93413444728961e-07, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 11.94, 
    490.320515575746, 490.320515575746, 246.52909254077, 158.082117252931, 
    158.082117252931, 158.082117252931, 8.4853885109533, 0, 0, 
    NaN, NaN, NaN, NaN, 29.685, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    21.0962108833876, NaN, NaN, NaN, NaN, NaN, NaN, 8.375, 268.823781574257, 
    268.823781574257, 189.566552846588, 438.923212537313, 438.923212537313, 
    438.923212537313, 5.95185333159413, NaN, NaN, 2.50647609960353e-06, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 
    0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NaN, NaN, 
    Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, NaN, 100, 
    312.504228976021, 312.504228976021, 157.8014500091, 1372.31657965, 
    178.65459065, 178.65459065, 0, 2.16856466354402, 2.16856466354402, 
    12.7889791340691, 784.505273928749, 63.7933632087938, 63.7933632087938
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(1, 
    0, 2, 1, 1, 0, 0, 0, 1, 2), .Dim = c(10L, 1L, 1L)), Kreis = "Neckar-Odenwald-Kreis", 
    Eigentumsart = "GPW", BWI = 3))
      
  result[[1]][["Log"]] <- NULL
  reference[[1]][["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fvbn.stratum.fun.1", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1, Kreis = 316, WGNr_BW = 1),
                               c("GW"), c(1,2, 3), bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524123186.61608, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = 1:3), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 0, 
    0, 1445.25964275, 0, 0, 242282.9641166, 149363765.965011, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 2627.744805, 
    0, 0, 140954.588263024, 149363765.965011, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 4864.90305225, 
    0, 0, 237861.801928722, 277389851.077877, 0, 0, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0, 8937.9075, 0, 0, 621099.354308347, 
    576117383.007899, 0, 0), .Dim = c(7L, 2L, 10L, 1L, 1L)), 
    FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, NA, NA, 
    NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, 
    NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, 
    NA, 16.17, 0, 0, 167.639749253353, 103347.358181818, 0, 0, 
    NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 29.4, 0, 0, 53.6408969374879, 56841.047, 
    0, 0, 0, 0, 0, NaN, 0, 0, 0, 54.43, 0, 0, 48.8934310456017, 
    57018.5773690979, 0, 0, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 0, 0, 69.4904656720095, 
    64457.747298, 0, 0, 0, 0, 0, NaN, NaN, 0, 0), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 1), list(Log = list(Datum = structure(1524123186.73225, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = 1:3), nTE = 1L, 
    HBF = 8937.9075, se.HBF = 8937.9075, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1995.83474475, 233565.905141122, 233565.905141122, 385906.375875682, 
    48162660.8611504, 1713289.50560511, 1713289.50560511, 1995.83474475, 
    233565.905141122, 233565.905141122, 385906.375875682, 48162660.8611504, 
    1713289.50560511, 1713289.50560511, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 4173.10901175, 114127.147714695, 114127.147714695, 
    190744.356201362, 24734479.0237019, 6154729.6234446, 6154729.6234446, 
    4173.10901175, 114127.147714695, 114127.147714695, 190744.356201362, 
    24734479.0237019, 6154729.6234446, 6154729.6234446, 2768.9637435, 
    217211.536915238, 217211.536915238, 158858.272170474, 2497689.08951981, 
    2497689.08951981, 2497689.08951981, 2768.9637435, 217211.536915238, 
    217211.536915238, 158858.272170474, 2497689.08951981, 2497689.08951981, 
    2497689.08951981, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.9075, 564904.589771055, 564904.589771055, 735509.004247517, 
    75394828.9743721, 10365708.2185695, 10365708.2185695, 8937.9075, 
    564904.589771055, 564904.589771055, 735509.004247517, 75394828.9743721, 
    10365708.2185695, 10365708.2185695), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 22.33, 117.02667555794, 117.02667555794, 
    193.355876227128, 24131.5875414241, 858.432548141514, 858.432548141514, 
    1.07607059257956e-07, 0, 0, NaN, 0.000277104569367169, NaN, 
    NaN, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 46.69, 
    27.3482306341276, 27.3482306341276, 45.707973519094, 5927.11068751339, 
    1474.85474405654, 1474.85474405654, 0, 5.07631858224566e-07, 
    5.07631858224566e-07, 7.37181051620592e-07, NaN, NaN, NaN, 
    30.98, 78.445063582046, 78.445063582046, 57.3710192281807, 
    902.030261459006, 902.030261459006, 902.030261459006, NaN, 
    8.38334274432894e-07, 8.38334274432894e-07, 1.07087652248254e-06, 
    1.13711649026579e-05, 1.13711649026579e-05, 1.13711649026579e-05, 
    0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 100, 63.20322623288, 
    63.20322623288, 82.290961754473, 8435.400453, 1159.746643, 
    1159.746643, 0, 8.37673426785977e-07, 8.37673426785977e-07, 
    0, 0.000107895932187889, 1.34869915234861e-05, 1.34869915234861e-05
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 2), list(Log = list(Datum = structure(1524123186.85304, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, WGNr_BW = 1, Wa = c(3, 5)), nTE = 1L, 
    HBF = 8937.87, se.HBF = 8937.87, BL = 0, se.BL = 0, iBL = 0, 
    se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", 
    "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 3))
    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1, Kreis = 316),
                               eig.list = c("OEW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524123786.15925, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Kreis = 316, EigArt = c("BW", "StW", "KW"), 
    Wa = c(3, 5)), nTE = 1L, HBF = 8937.87, se.HBF = 8937.87, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 
    0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 
    1472.067189, 716595.993686421, 716595.993686421, 536230.937878803, 
    1872832.08541313, 1872832.08541313, 1872832.08541313, 1472.067189, 
    716595.993686421, 716595.993686421, 536230.937878803, 1872832.08541313, 
    1872832.08541313, 1872832.08541313, 0, 0, 0, 0, 0, 0, NA, 
    0, 0, 0, 0, 0, 0, NA, 5538.798039, 798145.97518026, 798145.97518026, 
    704426.609188584, 17140970.3266787, 17140970.3266787, 17140970.3266787, 
    5538.798039, 798145.97518026, 798145.97518026, 704426.609188584, 
    17140970.3266787, 17140970.3266787, 17140970.3266787, 1927.004772, 
    610622.329549536, 610622.329549536, 416345.118578676, 3096032.69211744, 
    3096032.69211744, 3096032.69211744, 1927.004772, 610622.329549536, 
    610622.329549536, 416345.118578676, 3096032.69211744, 3096032.69211744, 
    3096032.69211744, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 8937.87, 2125364.29841622, 2125364.29841622, 1657002.66564606, 
    22109835.1042092, 22109835.1042092, 22109835.1042092, 8937.87, 
    2125364.29841622, 2125364.29841622, 1657002.66564606, 22109835.1042092, 
    22109835.1042092, 22109835.1042092), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 
    0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, 
    NA, NA, NA, NA, NA, NA, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, 
    NA, NA, NA, NA, 16.47, 486.79571084878, 486.79571084878, 
    364.270694901551, 1272.24633454766, 1272.24633454766, 1272.24633454766, 
    1.88980474022245e-07, NaN, NaN, 6.46619722527542e-06, 0, 
    0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    61.97, 144.100934816602, 144.100934816602, 127.180410664651, 
    3094.70939470712, 3094.70939470712, 3094.70939470712, 9.85487157717246e-07, 
    2.14158023235779e-06, 2.14158023235779e-06, 2.13471290801615e-06, 
    4.21210600715042e-05, 4.21210600715042e-05, 4.21210600715042e-05, 
    21.56, 316.876397205692, 316.876397205692, 216.058166865129, 
    1606.65543599258, 1606.65543599258, 1606.65543599258, 4.49357110329524e-07, 
    NaN, NaN, 2.56735379847257e-06, 0, 0, 0, 0, 0, 0, 0, 0, NA, 
    NA, NA, NA, NA, NA, NA, NA, NA, 100, 237.793154120189, 237.793154120189, 
    185.391224715292, 2473.7252952, 2473.7252952, 2473.7252952, 
    0, 3.2496365015335e-06, 3.2496365015335e-06, 0, 4.67203091198574e-05, 
    4.67203091198574e-05, 4.67203091198574e-05), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 1, 0, 1, 1, 0, 1), .Dim = c(10L, 1L, 1L)), Eigentumsart = "OEW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1),
                               eig.list = c("GPW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524124117.38309, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt2 = "GPW", Wa = c(3, 5)), nTE = 6L, HBF = 53627.22, 
    se.HBF = 21333.1991845241, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(39874.519431, 
    18127497.1104581, 18127497.1104581, 8538774.79785192, 391831605.967679, 
    21980022.7790017, 21980022.7790017, 17996.6821212237, 9612640.35504385, 
    9612640.35504385, 4389033.69165976, 343759649.519323, 12123185.9637436, 
    12123185.9637436, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 4814.830569, 355634.585665191, 
    355634.585665191, 313000.43594746, 13006336.1642741, 13006336.1642741, 
    13006336.1642741, 4814.830569, 355634.585665191, 355634.585665191, 
    313000.43594746, 13006336.1642741, 13006336.1642741, 13006336.1642741, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 89703.2322167132, 
    56900243.5399877, 0, 0, 0, 0, 0, 89703.2322167132, 56900243.5399877, 
    0, 0, 0, 134472.514861265, 0, 549471.874259159, 238544850.720191, 
    3831343.93690191, 0, 0, 134472.514861265, 0, 442862.095283705, 
    220688717.181538, 3831343.93690191, 0, 53627.22, 21383453.0013894, 
    21248980.4865282, 11062202.3131866, 702682137.754868, 41216804.2429135, 
    37385460.3060116, 21333.1991845241, 10069946.1317884, 9965264.60374343, 
    4829439.93192113, 458538130.874455, 24619774.9882662, 23874547.5936278
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(74.355, 
    454.613556956503, 454.613556956503, 214.141133728963, 9826.616384574, 
    551.22978515231, 551.22978515231, 15.8521337522922, 109.209508681063, 
    109.209508681063, 44.8627988446531, 7295.8235427284, 235.960221917379, 
    235.960221917379, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 3.98, 490.320515575746, 490.320515575746, 246.52909254077, 
    158.082117252931, 158.082117252931, 158.082117252931, 3.65152982100243, 
    0, 0, NaN, NaN, NaN, NaN, 9.895, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    9.07836371327111, NaN, NaN, NaN, NaN, NaN, NaN, 2.79166666666667, 
    268.823781574257, 268.823781574257, 189.566552846588, 438.923212537313, 
    438.923212537313, 438.923212537313, 2.56126987025924, NaN, 
    NaN, 2.50647609960353e-06, 0, 0, 0, 8.97833333333333, 73.8623261127657, 
    73.8623261127657, 65.0075701443566, 2701.30713384073, 2701.30713384073, 
    2701.30713384073, 8.23734972602181, 0, 0, 8.18462142054601e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, 
    NaN, 0, Inf, NaN, Inf, Inf, Inf, NaN, 0, NaN, NaN, NaN, NaN, 
    NaN, NaN, 100, 398.742522946172, 396.234980790132, 206.279615336887, 
    13103.087159, 768.579916, 697.1359005, 0, 100.494753004501, 
    98.4143131739766, 37.0989933067113, 6777.95397726179, 342.4680961761, 
    348.266226831989), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(5, 
    0, 2, 1, 1, 1, 0, 1, 3, 6), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GPW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
  #
  result <- fvbn.stratum.fun.1(list(Begehbar = 1),
                               eig.list = c("STW"), bwi.list = 3, bagr = bagr.xx)
  reference <- list(list(Log = list(Datum = structure(1524124197.12304, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = "StW", Wa = c(3, 5)), nTE = 22L, HBF = 223446.75, 
    se.HBF = 42845.6895644946, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(93526.765467, 
    35791985.3847305, 30352424.6672482, 17115335.9548203, 608809685.26172, 
    39807256.2792336, 37847940.9355765, 25909.3109510919, 12240990.2802847, 
    11769974.6212068, 5613700.92575079, 279423683.673827, 16614855.9875758, 
    16602754.9429665, 1123.490259, 0, 0, 2119.53405846176, 42675182.6907422, 
    0, 0, 1123.490259, 0, 0, 1803.79620083324, 30023120.6726591, 
    0, 0, 6285.110184, 2465501.14664696, 2465501.14664696, 1394251.74335744, 
    14477099.0249684, 252038.104219953, 252038.104219953, 6285.110184, 
    2465501.14664696, 2465501.14664696, 1362045.53435845, 14224747.869921, 
    252038.104219953, 252038.104219953, 9771.773271, 3134004.96785197, 
    3134004.96785197, 1739353.39134915, 18576648.2891592, 18576648.2891592, 
    18576648.2891592, 5867.39709559324, 1781231.26204829, 1781231.26204829, 
    957899.312133893, 11795699.437277, 11795699.437277, 11795699.437277, 
    44424.789048, 15910499.5853375, 13227454.4682965, 11719117.3768543, 
    366337898.075028, 32048967.188222, 28696738.0032671, 16053.8794627622, 
    6331508.10070777, 5050925.39005954, 4650934.0865651, 149900194.30754, 
    14881495.7434152, 14306161.7638617, 17873.058639, 8950011.52740006, 
    8950011.52740006, 5188001.00973616, 76692590.7215723, 5567286.2965877, 
    5567286.2965877, 9833.73296472472, 6205638.65416471, 6205638.65416471, 
    3567386.27972677, 33786263.2721981, 3695451.60093428, 3695451.60093428, 
    29177.676615, 5045431.53859164, 5045431.53859164, 3782219.77828842, 
    132156819.8823, 18356332.730822, 18356332.730822, 12526.8878314269, 
    4240518.45107686, 4240518.45107686, 2831313.02904606, 55478531.6365285, 
    17335895.6452154, 17335895.6452154, 0, 0, 0, 29801.5018087855, 
    106687956.637477, 0, 0, 0, 0, 0, 29487.0499343884, 87767797.765109, 
    0, 0, 21264.086517, 5544131.50383598, 5544131.50383598, 3152206.8069098, 
    125597242.284512, 26021816.018031, 26021816.018031, 10618.8412004161, 
    3978075.41256916, 3978075.41256916, 2089507.56997955, 55002825.1456963, 
    14282115.3002807, 14282115.3002807, 223446.75, 76841565.6543946, 
    68718959.8198714, 44122407.0971828, 1492011122.86748, 140630344.906275, 
    135318800.377663, 42845.6895644946, 18665307.370065, 17519424.3777374, 
    10798653.5438382, 414163305.360245, 38684912.6292571, 38499952.9123186
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(41.8564, 
    382.692432546053, 324.531961687029, 182.999335744795, 6509.47012036391, 
    425.624216559475, 404.67496920901, 9.62741009971136, 76.6892869075473, 
    90.0669937372844, 32.4560427320527, 2526.83768758004, 135.952175817736, 
    141.05128114459, 0.5028, 0, 0, 1.88656202533374, 37984.4705807478, 
    0, 0, 0.496770882472722, 0, 0, 2.37777160091284, 41234.6084782228, 
    0, 0, 2.8128, 392.276519339849, 392.276519339849, 221.834097182065, 
    2303.39621759101, 40.1008250995449, 40.1008250995449, 2.77907147617198, 
    7.55694578528675e-06, 7.55694578528675e-06, 7.29594697507463, 
    3216.90799335689, 0, 0, 4.3732, 320.720188745359, 320.720188745359, 
    177.997722942579, 1901.05191493643, 1901.05191493643, 1901.05191493643, 
    2.53756388607163, 81.1090641288114, 81.1090641288114, 45.6284226199987, 
    1473.29386286625, 1473.29386286625, 1473.29386286625, 19.8816, 
    358.144628850045, 297.749404144712, 263.796804171474, 8246.24958104378, 
    721.420807504426, 645.962279579108, 5.53376764856157, 79.0620481902541, 
    68.6077066832057, 57.594291836203, 2056.8074791837, 201.74786547491, 
    187.466181793881, 7.9988, 500.754331319131, 500.754331319131, 
    290.26934418576, 4290.96061679252, 311.490406260939, 311.490406260939, 
    3.74151037438523, 121.955268736614, 121.955268736614, 68.2247887114975, 
    1724.56481152646, 168.954768174307, 168.954768174307, 13.058, 
    172.920949298541, 172.920949298541, 129.62717450724, 4529.38119871956, 
    629.122495702252, 629.122495702252, 4.935464852545, 114.803916072782, 
    114.803916072782, 71.9618687791725, 1663.7374204288, 504.14263201485, 
    504.14263201485, 0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, 
    NaN, NaN, NaN, NaN, NaN, 9.5164, 260.727471147355, 260.727471147355, 
    148.240875731469, 5906.54304308352, 1223.7448336766, 1223.7448336766, 
    4.51944987299216, 109.445932515066, 109.445932515066, 54.3366205251103, 
    2651.18936465766, 449.01516077109, 449.01516077109, 100, 
    343.892071173085, 307.540654853433, 197.462738201306, 6677.255869094, 
    629.368495654, 605.597532198, 0, 46.4273772592529, 48.8015845757447, 
    25.2889043279041, 1342.67701544117, 124.015190137454, 126.90258902678
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(15L, 
    3L, 2L, 5L, 12L, 5L, 7L, 2L, 8L, 21L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "StW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
  testthat::expect_equal(result, reference)
})

test_that("fvbn.stratum.fun.2", {
  bagr.xx <- list(
    bagr.lab = c(
      "Fichte", "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB",
      "Buche", "Eichen", "Esche", "Bergahorn", "sonst.Laubb."
    ),
    ba.grupp = list(
      c(10), c(30), c(40), c(11:19, 20:29, 50, 51, 31:39, 90:99),
      c(100), c(110, 111), c(120), c(140),
      c(
        112, 113, 114, 121, 130, 141:144, 150, 160, 170, 180, 181, 190:199,
        200, 201, 210:213, 220:224, 230, 240, 250:252, 290:299
      )
    )
  )

  result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
    eig.list = c("GW"), bwi.list = c(1,2,3), bagr = bagr.xx, 
    a.klass = list(A.ob = 500, A.b = 500), 
    d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
  )

  reference <- list(list(Log = list(Datum = structure(1524125023.47903, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = 1:3), nTE = 93L, HBF = 866977.0275, se.HBF = 29670.8941169293, 
    BL = 8937.9075, se.BL = 8937.9075, iBL = 17875.815, se.iBL = 12576.1090375045, 
    LK = 1.03191489361702, se.LK = 0.018836834900987, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(401259.103910681, 
    153204416.570847, 149897433.645013, 72370541.0959742, 3182574853.34878, 
    332216294.226677, 297945972.572234, 44767.1164429632, 19858813.1824595, 
    19521745.885207, 9011552.14912735, 1466339208.70812, 51033755.4141896, 
    48919781.149832, 60966.931352984, 24836686.5971171, 23550705.9818487, 
    11117639.9900908, 189925241.446909, 33448915.0369674, 25286241.7311232, 
    18786.423689262, 8284769.6325322, 8226205.2802496, 3642597.37820494, 
    79143240.2080717, 11140901.4535105, 9785519.42168748, 9223.15986702128, 
    4583682.99394145, 4583682.99394145, 2273801.8449666, 857112.791334021, 
    857112.791334021, 857112.791334021, 9223.15986702128, 4583682.99394145, 
    4583682.99394145, 2273801.8449666, 857112.791334021, 857112.791334021, 
    857112.791334021, 74667.9353354441, 16348548.0044897, 15301618.2972952, 
    8563144.98675021, 50731998.0575054, 18725476.7345993, 18232333.13326, 
    20277.7749635525, 4333875.27084672, 4141919.24851652, 2284756.63798002, 
    24423919.62162, 5831275.05903773, 5749756.7517156, 166402.405688824, 
    58692953.6381697, 54453359.1061677, 42612510.3023129, 1196028302.13499, 
    97137737.7579702, 48927586.4809899, 31424.1393637099, 12643146.742044, 
    12261638.648457, 8779309.447363, 375539476.921702, 17952908.9961853, 
    10614387.0692621, 78250.2106277952, 29699485.0010423, 28076602.8757115, 
    18402434.2784737, 143706240.268485, 28127135.5409785, 25356290.4001262, 
    20762.3913432623, 8635625.71410211, 8573736.90981153, 5279984.79700082, 
    81728507.2665601, 9572241.62858821, 9395618.29225362, 29577.7513775505, 
    8090812.24723444, 7635456.42934729, 5698555.39801539, 1196058714.04302, 
    6483005.90584916, 6280401.32300355, 11667.7597390237, 3833447.11193014, 
    3815521.88082682, 2564579.84124191, 457098803.104325, 3389658.36233675, 
    3387394.42881582, 8535.11214094149, 633058.582856155, 602473.598781492, 
    739019.405187874, 825869632.695983, 7925191.48580799, 6147051.410327, 
    5579.4796505178, 447177.683390464, 446547.527968444, 394016.431474761, 
    399830026.213536, 5885193.55785922, 5629790.01382416, 38094.417198758, 
    6719401.35302795, 6208079.43344833, 5064256.38794104, 1107190377.72684, 
    31415626.2511999, 26083326.5647623, 14028.7521918772, 3242165.23962201, 
    3234545.25944051, 2164470.41354698, 566738009.8894, 18087237.8986722, 
    17814465.5043873, 866977.0275, 302809044.988725, 290309412.361555, 
    166841903.689713, 7892942472.51384, 556336495.731384, 455116316.40716, 
    34234.9205468565, 22502234.7358508, 22112489.3778977, 12135730.1983569, 
    1905675529.21028, 53493935.7864608, 51602516.2490566), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(46.2825531914894, 
    381.809197791932, 385.490055641678, 180.358627108143, 7931.47076871609, 
    827.934596346573, 766.225323223907, 4.91407168542041, 29.362072784423, 
    29.5391373651381, 12.5577102861658, 3564.22852575939, 98.8524580414515, 
    95.4132015882004, 7.03212765957447, 407.379640830512, 398.61485101096, 
    182.355249696304, 3115.21733556322, 548.640292280846, 427.990204966567, 
    2.17311448375731, 75.6059294370348, 75.5523923633274, 33.1026607437513, 
    1328.55813337385, 115.47272343188, 98.3547437997634, 1.06382978723404, 
    496.975338173532, 512.836253221623, 246.531761104662, 92.9304927694845, 
    92.9304927694845, 95.89635956, 1.06412040486192, NaN, 6.7490006145452e-06, 
    NaN, NaN, NaN, 1.45922134278008e-06, 8.61244680851064, 218.950047715183, 
    211.469190174946, 114.683028910341, 679.434858210462, 250.783373753077, 
    251.971827278679, 2.33945255477755, 39.3432939540712, 40.846601892838, 
    20.4820938593719, 348.66178560547, 54.0740330099364, 55.6163657117802, 
    19.1934042553191, 352.716977829795, 337.68281195531, 256.081095257716, 
    7187.5661724001, 583.75200379987, 303.415716794887, 3.48385652766114, 
    41.6456488277797, 41.4585936667348, 27.5197191332947, 1958.05606844104, 
    98.0501264553991, 47.8573784261529, 9.02563829787234, 379.545112566033, 
    370.256698827668, 235.174245932789, 1836.49652972868, 359.451243840965, 
    334.382917321814, 2.34589665915637, 43.6424212161994, 41.5071387735538, 
    26.0200587935621, 928.099760239073, 89.1802768613803, 86.6872972781565, 
    3.41159574468085, 273.543858826785, 266.387431161774, 192.66357760856, 
    40437.7837508915, 219.185218750934, 219.111979824753, 1.348158851944, 
    97.2109559878152, 97.9397905491559, 60.881284560147, 15595.306436479, 
    86.7504661373397, 88.934322891125, 0.984468085106383, 74.1710914165357, 
    72.8404582537903, 86.5857873902937, 96761.4272733953, 928.539819388217, 
    743.192801383186, 0.643966977970586, 56.0994243524354, 56.5841628319658, 
    28.0656373930428, 46264.5354343144, 738.404233703578, 670.396000493589, 
    4.39393617021276, 176.388086421415, 168.166626482521, 132.939594836646, 
    29064.373709934, 824.677959693899, 706.554270585672, 1.62137934169783, 
    73.018806445916, 73.7106143213379, 47.5367571229367, 8440.86348294393, 
    384.539082964168, 385.214574522852, 100, 349.269975309381, 
    345.539266751902, 192.440974094568, 9103.98110002268, 641.696928620619, 
    541.699826329787, 1.82542523782751, 21.4614896112152, 21.8258507641704, 
    11.2417732496218, 2164.11224468799, 59.8584080457514, 60.1638950503592
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(56L, 
    17L, 1L, 19L, 43L, 17L, 15L, 7L, 18L, 90L), .Dim = c(10L, 
    1L, 1L)), Eigentumsart = "GW", BWI = 1), list(Log = list(
    Datum = structure(1524125023.68643, class = c("POSIXct", 
    "POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = 1:3), nTE = 96L, HBF = 893790.75, se.HBF = 25407.5770896024, 
    BL = 17875.815, se.BL = 12576.1090375045, iBL = 8937.9075, 
    se.iBL = 8937.9075, LK = 1.03092783505155, se.LK = 0.018244082884591, 
    Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", "oiB", "N", 
    "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", "V_DhmR/ha", 
    "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", "N_Dh_HB/ha"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(375733.045492268, 
    144042421.429319, 142506081.276618, 68317117.4512753, 3114476252.66766, 
    286870701.694332, 260142611.721956, 45008.1880367813, 21677943.0449781, 
    21517025.5680339, 10033742.059875, 1351147324.32039, 62973270.5302968, 
    62338851.9212093, 88341.5405829897, 33095324.232304, 32147403.7719761, 
    14723341.0585363, 295222256.002283, 58330452.4449994, 52323344.902014, 
    23482.7084861681, 9844472.11622135, 9570286.04505333, 4341455.94491622, 
    165136044.961724, 24540714.9307886, 23720364.8400641, 9214.33762886598, 
    1914363.01650978, 1914363.01650978, 981552.109916594, 28160346.432681, 
    290722.332295093, 290722.332295093, 9214.33762886598, 1914363.01650978, 
    1914363.01650978, 976416.571363756, 27868203.8118028, 290722.332295094, 
    290722.332295094, 72950.8324414948, 14008450.3734457, 12993139.4794716, 
    7432046.32607872, 26555106.1137209, 17265231.4135923, 16808332.4616997, 
    20852.1121393157, 4184862.6771744, 4092520.73940551, 2254492.24370382, 
    11440623.6056402, 6915658.72951198, 6911781.58342641, 187791.88661134, 
    80955037.6620772, 73414505.8629425, 58435632.2910256, 1568612557.63024, 
    113659791.020672, 81688472.5268385, 31388.1799403295, 14932617.6544687, 
    14486224.554503, 10468508.8616297, 417607419.139136, 24758395.3393115, 
    22235284.2485843, 80933.2131293814, 28430028.2004384, 28430028.2004384, 
    17122173.8453321, 95842193.8478669, 20942579.2289071, 20942579.2289071, 
    21434.4890768358, 8850231.96478366, 8850231.96478366, 5271372.82088834, 
    37918306.4247991, 8804599.19322902, 8804599.19322902, 25555.9654136598, 
    15561856.4522371, 15350289.5164233, 11703096.1546837, 2313052328.00242, 
    18785658.0978014, 15402752.3035673, 10159.5113667182, 9364157.64591169, 
    9365270.74926683, 6202596.21553357, 725553398.564719, 9490371.50736188, 
    8926127.23481756, 14403.8525814433, 4492882.3346713, 4342363.52984515, 
    3277489.47486824, 1003581825.14245, 23438822.3385675, 19607462.3267621, 
    7101.63210507569, 2294866.33567304, 2292806.09238209, 1551353.38857832, 
    317120207.413011, 15692932.8751823, 15267824.4697895, 38866.0761185567, 
    13092202.7331433, 11591374.9982217, 9012544.30088877, 1436283569.30706, 
    34673731.5782404, 23087702.0865095, 13693.4094952242, 4523285.65611488, 
    4461033.71653515, 2707010.3709793, 442791649.912859, 14970596.0139169, 
    13885169.7645838, 893790.75, 335592566.434146, 322689549.652446, 
    191004993.012605, 9881786435.14639, 574257690.149407, 490293979.890549, 
    30588.5506360105, 26561698.6626637, 25933461.2363719, 15400691.7429401, 
    1886568825.30319, 69316092.6103236, 68542395.0188894), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(42.0381443298969, 
    383.363729002334, 391.004963802702, 181.823553373564, 8289.06663928699, 
    763.496064921539, 713.773416324889, 4.82532356101857, 36.5294985523241, 
    37.3247531086957, 16.0617163410444, 3507.86910225911, 130.597959800237, 
    135.399122372012, 9.88391752577319, 374.629240263403, 375.153672377236, 
    166.663847623361, 3341.82825037951, 660.283396237614, 610.602807314809, 
    2.64229689907272, 66.8353311691141, 66.3038196771532, 28.8525303438999, 
    1825.67413576913, 209.492401314734, 220.570092318751, 1.03092783505155, 
    207.759156828876, 214.184697761728, 106.524435011114, 3056.144409606, 
    31.551083106, 32.5268898, 1.03134428743575, NaN, 3.89821153930605e-06, 
    0.786281554524048, 4298.96975929466, 4.9165330045986e-08, 
    5.98494940510821e-07, 8.1619587628866, 192.025915327014, 
    183.616673117979, 101.87747113152, 364.013750425914, 236.669422894368, 
    237.532283260285, 2.344505870523, 49.2890470055952, 47.1936164704938, 
    25.659650737705, 151.62962104281, 82.8887147645695, 84.8210832243776, 
    21.0107216494845, 431.089112117097, 403.026238014758, 311.172294743307, 
    8352.93039510643, 605.243352477233, 448.448128672646, 3.42078571709459, 
    44.3350873573478, 46.0290971515571, 29.604498113228, 1874.63088036363, 
    110.74860400331, 95.4746010287652, 9.05505154639175, 351.277641170499, 
    362.141898113917, 211.55929912186, 1184.21337967457, 258.763719110322, 
    266.76672073229, 2.35699375246097, 61.5121890116356, 63.414627847047, 
    35.9338398154871, 537.882412993721, 104.248003776625, 107.472168841881, 
    2.85927835051546, 608.932442987235, 619.230793375632, 457.93989642936, 
    90509.2916883541, 735.079179899045, 621.347142599603, 1.13030245267235, 
    215.169747545311, 222.641086418281, 132.137792561725, 41611.3353820502, 
    239.292868819615, 210.401408733175, 1.61154639175258, 311.922265884584, 
    310.796254510228, 227.54255893251, 69674.5415483758, 1627.2606378077, 
    1403.36611841095, 0.795871535834655, 66.3490057579068, 67.0507713579393, 
    45.0609754485182, 40600.976010061, 572.124650311832, 573.142306859609, 
    4.34845360824742, 336.854245157318, 307.46276253192, 231.887167446412, 
    36954.6842065002, 892.133578714557, 612.404366619251, 1.53703855399451, 
    88.2254047019351, 84.4826187837478, 63.8116792396658, 16265.410273187, 
    332.299297253863, 293.098781916817, 100, 375.471066839913, 
    372.200807422716, 213.702136671928, 11056.0401695211, 642.4967926211, 
    565.521304877423, 1.76967603980552, 26.6110853860687, 27.1636643670394, 
    15.2634286357124, 2064.80885455967, 71.4047915189674, 73.7918961236771
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(54L, 
    18L, 2L, 18L, 46L, 18L, 21L, 19L, 33L, 92L), .Dim = c(10L, 
    1L, 1L)), Eigentumsart = "GW", BWI = 2), list(Log = list(
    Datum = structure(1524125023.91695, class = c("POSIXct", 
    "POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, Wa = c(3, 5)), nTE = 97L, HBF = 902724.87, 
    se.HBF = 23749.5302613181, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(329903.038209, 
    144299884.122483, 134163532.92777, 68408615.2800265, 2147247442.02653, 
    233976761.628424, 189918694.616375, 41954.8149210379, 21131336.4407612, 
    19735144.944894, 9665222.60758577, 592989902.867983, 43444897.7729498, 
    35038580.1418026, 73741.896435, 41666847.6994295, 41272260.54267, 
    18616041.1447896, 368446211.082146, 48382341.0267089, 39641776.5179797, 
    20128.4249748835, 12453027.22519, 12373211.1644436, 5513119.11212982, 
    119658615.416587, 17537825.3629695, 15645752.7559506, 26295.21354, 
    3512023.28778686, 3512023.28778686, 1939659.57364047, 57489686.3940141, 
    589442.782523505, 589442.782523505, 14103.3263030828, 2668666.18601838, 
    2668666.18601838, 1454899.37701584, 24082849.3877344, 419102.811548309, 
    419102.811548309, 51592.067001, 12059909.3610462, 12059909.3610462, 
    6430962.48498199, 55066819.2500534, 26616697.4443081, 26616697.4443081, 
    15028.9452094005, 3250630.29733915, 3250630.29733915, 1740343.26890642, 
    26027469.1984718, 12165682.4526368, 12165682.4526368, 190524.999642, 
    73112666.4927309, 68206059.1754734, 53212721.7668321, 2461964491.17629, 
    121941966.727928, 98472131.8211852, 29479.9064238981, 12714939.8000087, 
    12114172.9887067, 9014989.69617412, 856005980.7703, 34678581.4784261, 
    32925510.4587541, 74672.328702, 30821100.2284374, 30375909.0650126, 
    18482335.1513085, 481167465.140534, 40190577.8843869, 39701244.9813839, 
    19162.4019334276, 10572193.3841335, 10575739.7586214, 6169221.88900068, 
    289133656.40049, 20319255.7655703, 20323020.822646, 68639.266452, 
    23834640.4155144, 23394835.4629845, 16650419.3701906, 1315605100.33008, 
    49574678.7588594, 46270487.4897497, 19263.0216461386, 11814532.2834294, 
    11779094.679639, 7791411.87321356, 493139340.677042, 25053463.7612241, 
    24808419.2513869, 16763.868972, 5706638.13364283, 5376784.45076459, 
    4109689.87986344, 1709676400.91064, 31119214.6398002, 13036450.0818778, 
    7048.8149559089, 2645673.18826535, 2642189.33150088, 1732310.91808527, 
    639972194.132348, 18047660.6305558, 8314538.26768923, 70592.191047, 
    15929567.6217167, 13622353.1738338, 10428136.6331752, 1448094491.39748, 
    68263574.9345905, 56566652.6159554, 18123.8103531699, 5497846.94629767, 
    5371590.79761946, 2996064.2210912, 473539173.3416, 23264518.3956268, 
    22870280.5406463, 902724.87, 350943277.362788, 331983667.447342, 
    198278581.284808, 10044758107.7078, 620655255.82753, 510813578.351338, 
    23749.5302613181, 26734715.3478642, 25254921.4830741, 14922176.6155414, 
    1512253825.15038, 68014193.5578388, 63304970.2071242), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(36.5452475247525, 
    437.400894838277, 406.675651294775, 207.359761375366, 6508.72284682084, 
    709.228877971699, 575.680344283636, 4.46055270659472, 37.6979887172356, 
    39.6588968571518, 15.9652263947197, 1720.50543798547, 90.9238180044362, 
    72.612473299265, 8.16881188118812, 565.036291630456, 559.68536934834, 
    252.44863564363, 4996.42983018363, 656.103834668202, 537.574681889583, 
    2.2430510680613, 65.9595407969579, 65.8788129974556, 28.4768838762563, 
    1784.08662855439, 156.59322590411, 144.431124658231, 2.91287128712871, 
    133.561314588467, 133.561314588467, 73.7647393769925, 2186.31753290619, 
    22.4163527566281, 22.4163527566281, 1.56472695478332, 94.1979781863492, 
    94.1979781863492, 51.1467645103759, 1218.00420532482, 16.0567263710947, 
    16.0567263710947, 5.71514851485149, 233.755111242441, 233.755111242441, 
    124.650219671512, 1067.35051435303, 515.906785510109, 515.906785510109, 
    1.67357121423767, 44.0675825138691, 44.0675825138691, 23.8279860398046, 
    462.347084732477, 248.757781648105, 248.757781648105, 21.1055445544554, 
    383.743165621892, 357.990076387004, 279.295220400576, 12922.0023398628, 
    640.031318499198, 516.84625118077, 3.21078850758625, 39.9942124894101, 
    38.5811960467845, 28.0688167425763, 4087.66079643678, 170.077164335634, 
    157.941509284197, 8.27188118811881, 412.75129307186, 406.789363516917, 
    247.512505269084, 6443.71848989419, 538.22585398104, 531.672785240466, 
    2.07929367758985, 67.4192623330501, 67.631251607318, 36.9257748515851, 
    3804.61677892102, 253.765528461915, 253.460114289196, 7.60356435643564, 
    347.244975762994, 340.837492477352, 242.578632186204, 19166.9458071801, 
    722.24954201, 674.11104286942, 2.12079220380676, 134.063564134808, 
    134.171635029026, 86.3633031160064, 8796.441568734, 303.135505217231, 
    303.856331656835, 1.8570297029703, 340.412952593127, 320.736487486583, 
    245.151634549739, 101985.788827522, 1856.32652532523, 777.651633024099, 
    0.782805218068872, 75.6487324422285, 74.3155077948572, 54.4159307851792, 
    49742.9374747492, 1073.16588635261, 278.689892268648, 7.81990099009901, 
    225.656228903717, 192.972522481475, 147.723657227641, 20513.5223871058, 
    967.013120320077, 801.316006444588, 2.02121957823721, 69.5601102145013, 
    64.7903206680538, 40.0644378759215, 7912.96849513548, 289.365124892991, 
    270.020500193081, 100, 388.759952257422, 367.757307325921, 
    219.644531655374, 11127.1534013545, 687.535345988119, 565.857433784158, 
    0, 27.338908452774, 26.9512762362584, 15.1673918857392, 1678.39740773579, 
    71.654204426588, 67.9400017605441), .Dim = c(7L, 2L, 10L, 
    1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(58L, 22L, 9L, 18L, 
    51L, 22L, 28L, 20L, 41L, 95L), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GW", 
    BWI = 3))

    for (bwi in 1:3) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)
    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("OEW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )
    reference <- 
list(list(Log = list(Datum = structure(1524125635.68141, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = c("BW", "StW", "KW"), Wa = c(3, 5)), 
    nTE = 61L, HBF = 572023.68, se.HBF = 46711.0661569284, BL = 0, 
    se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, Attribute1 = c("BAF", 
    "V_DhmR", "V_DhmR_HB", "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(179220.381666, 
    69647304.7433155, 63162950.6847649, 33207607.2698058, 968914063.210337, 
    94072827.5242634, 75371854.0300651, 32115.1614534862, 14858925.1935441, 
    14602620.5817975, 6812005.00412025, 317242398.304396, 24758100.014916, 
    20922698.2408392, 18584.513091, 6912539.51909799, 6718262.28224375, 
    3115297.59906625, 174131656.758164, 10543456.562824, 5705514.74452772, 
    8995.47296850128, 3914075.10424077, 3880160.58282068, 1758510.13921542, 
    94263343.8899534, 7025260.34970415, 3160812.5423896, 15222.980184, 
    2465501.14664696, 2465501.14664696, 1395716.92461437, 28702159.9099653, 
    252038.104219953, 252038.104219953, 10874.4320137334, 2465501.14664696, 
    2465501.14664696, 1362031.01467851, 17272443.1708969, 252038.104219953, 
    252038.104219953, 37347.783582, 9705855.63518456, 9705855.63518456, 
    5171650.81931257, 53245996.5327475, 24795874.7270021, 24795874.7270021, 
    11381.1736735364, 2871562.26531143, 2871562.26531143, 1529851.78776502, 
    26024093.8765517, 12115346.5083464, 12115346.5083464, 162608.456484, 
    55977042.8998121, 52426362.5305425, 40722736.2392938, 1606095148.19234, 
    91126155.4313136, 84157208.7894814, 28892.9667686377, 11455165.6721069, 
    10857536.1134251, 8112874.83433158, 406265343.990699, 33068310.6422791, 
    32800550.8966371, 59872.109769, 26044923.8424391, 25599732.6790142, 
    15590640.0834321, 438931900.660987, 26405135.1748336, 25915802.2718306, 
    17432.1086749031, 9987918.71447106, 9989522.65872232, 5832026.37030096, 
    288986104.201224, 15839903.2094483, 15840431.7491654, 43517.595243, 
    9126560.04294418, 8686755.09041427, 6872128.93202838, 895443757.590187, 
    41940101.7017559, 38635910.4326462, 15248.3031456564, 5003444.85179845, 
    4905882.00464707, 3385657.8769101, 465566903.943051, 24639239.5241597, 
    24379584.1926606, 10391.167662, 3803717.28375676, 3652848.99100614, 
    2796715.93262468, 1392886675.39446, 27280828.3432977, 11221183.4439826, 
    6093.00564966406, 2284685.48999235, 2282139.31682375, 1522682.50748381, 
    609444132.666295, 17932541.0080649, 8203926.06282769, 45258.692319, 
    7935202.52045951, 7087300.21677217, 5071081.55015133, 499387120.975172, 
    51297703.0083906, 45690542.2808568, 15081.5104256403, 4089448.71903656, 
    4072149.52845484, 2211662.0982553, 137307195.882531, 21765357.4646655, 
    21593206.7763001, 572023.68, 191618647.633657, 179505569.25659, 
    113943575.350329, 6057738479.22436, 367714120.577901, 311745928.824613, 
    46711.0661569284, 22430333.1167373, 21673846.874439, 13159314.6660489, 
    1084899440.97344, 63214285.4764786, 59943064.1592654), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(31.3309375, 
    388.612634879397, 352.431738497673, 185.289234188176, 5406.27162046799, 
    524.900274454164, 420.55403146351, 5.18761111853181, 47.3608598523109, 
    53.6871779073573, 20.0596134652111, 1551.37160606422, 112.675836679594, 
    89.5223718783261, 3.24890625, 371.951607515914, 361.497890708648, 
    167.628690825099, 9369.71853421825, 567.324874813639, 307.003724907421, 
    1.55673209316712, 86.5292494665492, 88.0172697373736, 38.4203044999443, 
    3259.50712379615, 329.025951286817, 99.7321846121071, 2.66125, 
    161.95916416145, 161.95916416145, 91.6848677292067, 1885.44946935768, 
    16.5564233266792, 16.5564233266792, 1.8922793409455, 135.156606464604, 
    135.156606464604, 74.9222576966568, 1449.93282947436, 13.8165074116751, 
    13.8165074116751, 6.5290625, 259.877687624343, 259.877687624343, 
    138.472763931434, 1425.68022586512, 663.918239553917, 663.918239553917, 
    1.93868060139393, 56.4457716448895, 56.4457716448895, 29.6613438245056, 
    574.024615757516, 335.494856958598, 335.494856958598, 28.426875, 
    344.244353031664, 322.408586023944, 250.434307783376, 9877.07025157311, 
    560.40231487149, 517.545093343667, 4.38101699696098, 40.4035948302025, 
    39.0096468634602, 28.1131917584576, 2050.52269611057, 186.653939764346, 
    184.854734288696, 10.46671875, 435.009288012837, 427.573586061753, 
    260.399042953127, 7331.15806933286, 441.025634084225, 432.852664985744, 
    2.8293104661225, 76.1728282322194, 76.5114706911072, 41.7928019210469, 
    4694.40480626337, 251.051652655063, 250.57800402885, 7.60765625, 
    209.72114823859, 199.614777468927, 157.916100226926, 20576.5909763643, 
    963.750443184292, 887.822735077738, 2.56258645411583, 80.7928721343327, 
    79.7082003772574, 50.3197625665295, 12589.3565399561, 444.357172936376, 
    449.688676219691, 1.8165625, 366.052921816166, 351.534024839618, 
    269.143567267434, 134045.250803544, 2625.38621555135, 1079.87704644762, 
    1.05786848921078, 27.1237513975228, 25.657217206992, 42.5067916239032, 
    81479.6751268899, 1766.76984805136, 273.334987175727, 7.91203125, 
    175.329911534546, 156.595337903673, 112.046576918495, 11034.0598763947, 
    1133.43316786145, 1009.54181262713, 2.58017391560777, 72.3242055161393, 
    71.346304857039, 38.941706484008, 4084.94911611847, 427.494255828608, 
    409.873281923745, 100, 334.983767863695, 313.80793406418, 
    199.19380846319, 10590.0134750092, 642.830241884219, 544.987803345156, 
    0, 26.7014347052787, 27.1656614476559, 14.9976206602448, 
    1712.48005365472, 97.3106179298456, 94.4560269672278), .Dim = c(7L, 
    2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(33L, 7L, 
    4L, 15L, 37L, 15L, 18L, 14L, 24L, 60L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "OEW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)


    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("GPW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )

    reference <- list(list(Log = list(Datum = structure(1524125707.03081, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt2 = "GPW", Wa = c(3, 5)), nTE = 6L, HBF = 53627.22, 
    se.HBF = 21333.1991845241, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(39874.519431, 
    18127497.1104581, 18127497.1104581, 8538774.79785192, 391831605.967679, 
    21980022.7790017, 21980022.7790017, 17996.6821212237, 9612640.35504385, 
    9612640.35504385, 4389033.69165976, 343759649.519323, 12123185.9637436, 
    12123185.9637436, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, 
    NA, 2134.363356, 1046522.1411399, 1046522.1411399, 526182.661306953, 
    337404.678303552, 337404.678303552, 337404.678303552, 2134.363356, 
    1046522.1411399, 1046522.1411399, 526182.661306953, 337404.678303552, 
    337404.678303552, 337404.678303552, 5306.413419, 1316872.38715129, 
    1316872.38715129, 761270.509651177, 1404587.71664737, 1404587.71664737, 
    1404587.71664737, 5306.413419, 1316872.38715129, 1316872.38715129, 
    761270.509651177, 1404587.71664737, 1404587.71664737, 1404587.71664737, 
    1497.093225, 402454.262113699, 402454.262113699, 283798.801953232, 
    657108.967784847, 657108.967784847, 657108.967784847, 1497.093225, 
    402454.262113699, 402454.262113699, 283798.801953232, 657108.967784847, 
    657108.967784847, 657108.967784847, 4814.830569, 355634.585665191, 
    355634.585665191, 313000.43594746, 13006336.1642741, 13006336.1642741, 
    13006336.1642741, 4814.830569, 355634.585665191, 355634.585665191, 
    313000.43594746, 13006336.1642741, 13006336.1642741, 13006336.1642741, 
    0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 89703.2322167132, 
    56900243.5399877, 0, 0, 0, 0, 0, 89703.2322167132, 56900243.5399877, 
    0, 0, 0, 134472.514861265, 0, 549471.874259159, 238544850.720191, 
    3831343.93690191, 0, 0, 134472.514861265, 0, 442862.095283705, 
    220688717.181538, 3831343.93690191, 0, 53627.22, 21383453.0013894, 
    21248980.4865282, 11062202.3131866, 702682137.754868, 41216804.2429135, 
    37385460.3060116, 21333.1991845241, 10069946.1317884, 9965264.60374343, 
    4829439.93192113, 458538130.874455, 24619774.9882662, 23874547.5936278
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(74.355, 
    454.613556956503, 454.613556956503, 214.141133728963, 9826.616384574, 
    551.22978515231, 551.22978515231, 15.8521337522922, 109.209508681063, 
    109.209508681063, 44.8627988446531, 7295.8235427284, 235.960221917379, 
    235.960221917379, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, 
    NA, NA, NA, 3.98, 490.320515575746, 490.320515575746, 246.52909254077, 
    158.082117252931, 158.082117252931, 158.082117252931, 3.65152982100243, 
    0, 0, NaN, NaN, NaN, NaN, 9.895, 248.16618743578, 248.16618743578, 
    143.462344438787, 264.696246926057, 264.696246926057, 264.696246926057, 
    9.07836371327111, NaN, NaN, NaN, NaN, NaN, NaN, 2.79166666666667, 
    268.823781574257, 268.823781574257, 189.566552846588, 438.923212537313, 
    438.923212537313, 438.923212537313, 2.56126987025924, NaN, 
    NaN, 2.50647609960353e-06, 0, 0, 0, 8.97833333333333, 73.8623261127657, 
    73.8623261127657, 65.0075701443566, 2701.30713384073, 2701.30713384073, 
    2701.30713384073, 8.23734972602181, 0, 0, 8.18462142054601e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
    0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, NaN, NaN, NaN, NaN, 
    NaN, 0, Inf, NaN, Inf, Inf, Inf, NaN, 0, NaN, NaN, NaN, NaN, 
    NaN, NaN, 100, 398.742522946172, 396.234980790132, 206.279615336887, 
    13103.087159, 768.579916, 697.1359005, 0, 100.494753004501, 
    98.4143131739766, 37.0989933067113, 6777.95397726179, 342.4680961761, 
    348.266226831989), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(5, 
    0, 2, 1, 1, 1, 0, 1, 3, 6), .Dim = c(10L, 1L, 1L)), Eigentumsart = "GPW", 
    BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)

    result <- fvbn.stratum.fun.2(auswahl = list(Begehbar = 1),
                                 eig.list = c("StW"), bwi.list = c(3), bagr = bagr.xx, 
                                 a.klass = list(A.ob = 500, A.b = 500), 
                                 d.klass = list(D.unt = 0, D.ob = 500, D.b = 500, Ndh = F)
                                 )

    reference <- list(list(Log = list(Datum = structure(1524125764.91314, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Begehbar = 1, EigArt = "StW", Wa = c(3, 5)), nTE = 22L, HBF = 223446.75, 
    se.HBF = 42845.6895644946, BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, 
    LK = 1, se.LK = 0, Attribute1 = c("BAF", "V_DhmR", "V_DhmR_HB", 
    "oiB", "N", "N_Dh", "N_Dh_HB"), Attribute2 = c("BA_Proz", 
    "V_DhmR/ha", "V_DhmR_HB/ha", "oiB/ha", "N/ha", "N_Dh/ha", 
    "N_Dh_HB/ha"), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Weißtanne", "Douglasie", "Kiefer/Lärche/sNB", "Buche", 
    "Eichen", "Esche", "Bergahorn", "sonst.Laubb.", "Alle BA"
    ), AKL = "0-500", DKL = "0-500", T.FVBN.Bagr.Akl.Dkl = structure(c(93526.765467, 
    35791985.3847305, 30352424.6672482, 17115335.9548203, 608809685.26172, 
    39807256.2792336, 37847940.9355765, 25909.3109510919, 12240990.2802847, 
    11769974.6212068, 5613700.92575079, 279423683.673827, 16614855.9875758, 
    16602754.9429665, 1123.490259, 0, 0, 2119.53405846176, 42675182.6907422, 
    0, 0, 1123.490259, 0, 0, 1803.79620083324, 30023120.6726591, 
    0, 0, 6285.110184, 2465501.14664696, 2465501.14664696, 1394251.74335744, 
    14477099.0249684, 252038.104219953, 252038.104219953, 6285.110184, 
    2465501.14664696, 2465501.14664696, 1362045.53435845, 14224747.869921, 
    252038.104219953, 252038.104219953, 9771.773271, 3134004.96785197, 
    3134004.96785197, 1739353.39134915, 18576648.2891592, 18576648.2891592, 
    18576648.2891592, 5867.39709559324, 1781231.26204829, 1781231.26204829, 
    957899.312133893, 11795699.437277, 11795699.437277, 11795699.437277, 
    44424.789048, 15910499.5853375, 13227454.4682965, 11719117.3768543, 
    366337898.075028, 32048967.188222, 28696738.0032671, 16053.8794627622, 
    6331508.10070777, 5050925.39005954, 4650934.0865651, 149900194.30754, 
    14881495.7434152, 14306161.7638617, 17873.058639, 8950011.52740006, 
    8950011.52740006, 5188001.00973616, 76692590.7215723, 5567286.2965877, 
    5567286.2965877, 9833.73296472472, 6205638.65416471, 6205638.65416471, 
    3567386.27972677, 33786263.2721981, 3695451.60093428, 3695451.60093428, 
    29177.676615, 5045431.53859164, 5045431.53859164, 3782219.77828842, 
    132156819.8823, 18356332.730822, 18356332.730822, 12526.8878314269, 
    4240518.45107686, 4240518.45107686, 2831313.02904606, 55478531.6365285, 
    17335895.6452154, 17335895.6452154, 0, 0, 0, 29801.5018087855, 
    106687956.637477, 0, 0, 0, 0, 0, 29487.0499343884, 87767797.765109, 
    0, 0, 21264.086517, 5544131.50383598, 5544131.50383598, 3152206.8069098, 
    125597242.284512, 26021816.018031, 26021816.018031, 10618.8412004161, 
    3978075.41256916, 3978075.41256916, 2089507.56997955, 55002825.1456963, 
    14282115.3002807, 14282115.3002807, 223446.75, 76841565.6543946, 
    68718959.8198714, 44122407.0971828, 1492011122.86748, 140630344.906275, 
    135318800.377663, 42845.6895644946, 18665307.370065, 17519424.3777374, 
    10798653.5438382, 414163305.360245, 38684912.6292571, 38499952.9123186
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), FVBN.ha.Bagr.Akl.Dkl = structure(c(41.8564, 
    382.692432546053, 324.531961687029, 182.999335744795, 6509.47012036391, 
    425.624216559475, 404.67496920901, 9.62741009971136, 76.6892869075473, 
    90.0669937372844, 32.4560427320527, 2526.83768758004, 135.952175817736, 
    141.05128114459, 0.5028, 0, 0, 1.88656202533374, 37984.4705807478, 
    0, 0, 0.496770882472722, 0, 0, 2.37777160091284, 41234.6084782228, 
    0, 0, 2.8128, 392.276519339849, 392.276519339849, 221.834097182065, 
    2303.39621759101, 40.1008250995449, 40.1008250995449, 2.77907147617198, 
    7.55694578528675e-06, 7.55694578528675e-06, 7.29594697507463, 
    3216.90799335689, 0, 0, 4.3732, 320.720188745359, 320.720188745359, 
    177.997722942579, 1901.05191493643, 1901.05191493643, 1901.05191493643, 
    2.53756388607163, 81.1090641288114, 81.1090641288114, 45.6284226199987, 
    1473.29386286625, 1473.29386286625, 1473.29386286625, 19.8816, 
    358.144628850045, 297.749404144712, 263.796804171474, 8246.24958104378, 
    721.420807504426, 645.962279579108, 5.53376764856157, 79.0620481902541, 
    68.6077066832057, 57.594291836203, 2056.8074791837, 201.74786547491, 
    187.466181793881, 7.9988, 500.754331319131, 500.754331319131, 
    290.26934418576, 4290.96061679252, 311.490406260939, 311.490406260939, 
    3.74151037438523, 121.955268736614, 121.955268736614, 68.2247887114975, 
    1724.56481152646, 168.954768174307, 168.954768174307, 13.058, 
    172.920949298541, 172.920949298541, 129.62717450724, 4529.38119871956, 
    629.122495702252, 629.122495702252, 4.935464852545, 114.803916072782, 
    114.803916072782, 71.9618687791725, 1663.7374204288, 504.14263201485, 
    504.14263201485, 0, NaN, NaN, Inf, Inf, NaN, NaN, 0, NaN, 
    NaN, NaN, NaN, NaN, NaN, 9.5164, 260.727471147355, 260.727471147355, 
    148.240875731469, 5906.54304308352, 1223.7448336766, 1223.7448336766, 
    4.51944987299216, 109.445932515066, 109.445932515066, 54.3366205251103, 
    2651.18936465766, 449.01516077109, 449.01516077109, 100, 
    343.892071173085, 307.540654853433, 197.462738201306, 6677.255869094, 
    629.368495654, 605.597532198, 0, 46.4273772592529, 48.8015845757447, 
    25.2889043279041, 1342.67701544117, 124.015190137454, 126.90258902678
    ), .Dim = c(7L, 2L, 10L, 1L, 1L)), nT.Bagr.Akl.Dkl = structure(c(15L, 
    3L, 2L, 5L, 12L, 5L, 7L, 2L, 8L, 21L), .Dim = c(10L, 1L, 
    1L)), Eigentumsart = "StW", BWI = 3))
    for (bwi in 1) {
        result[[bwi]][["Log"]] <- NULL
        reference[[bwi]][["Log"]] <- NULL
    }
    testthat::expect_equal(result, reference)
})

test_that("VB.A.bagrupp.akl.dkl.stratum.fun.2", {
              f <-VB.A.bagrupp.akl.dkl.stratum.fun.2 
              result <- f(
                          list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
                          list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
                          list(Wa = c(3, 5), Begehbar = 1), T, get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524126362.99942, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), nTE = 95L, HBF = 884849.13, 
    se.HBF = 26933.7163569887, Attribute = c("V_DhmR", "V_EoR", 
    "oiB", "N_Dh", "V_DhmR/J", "V_EoR/J", "oiB/J", "N_Dh/J", 
    "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "N_Dh/ha/J"), Größen = c("Wert", 
    "Standardfehler"), Nutzungsart = 2, BAGR = "Alle Baumarten", 
    AKL = "0-500", DKL = "0-400", T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(87353346.282143, 
    71952886.4436022, 48032987.0999775, 142557527.092939, 8611027.56346521, 
    7088938.71511899, 4726178.36129894, 14361199.112133, 9.72522703867787, 
    8.00619182318149, 5.33770879841691, 16.2194257170568, 15827144.3573303, 
    13191580.6485632, 8646455.03964554, 34614331.2330218, 1546500.57345153, 
    1289914.16736829, 843400.886733816, 3615004.41938595, 1.69113105810846, 
    1.41305147341148, 0.926285928887626, 3.98763948849859, 9808968.82335751, 
    7801165.98852727, 5117190.19333058, 20477241.8510485, 945285.69758706, 
    751649.182177319, 494086.795006435, 2038205.26799751, 1.06759825789591, 
    0.84890669507616, 0.55801775372748, 2.30193305463401, 4697742.85041113, 
    3726553.39389314, 2403192.47375069, 10896293.1664166, 444820.391957819, 
    352854.525811099, 228116.045673434, 1112010.66415225, 0.502953958993117, 
    0.398971275431713, 0.257940010856577, 1.25696988742553), .Dim = c(12L, 
    2L, 2L, 1L, 1L, 1L)), BAF.bagr.akl.dkl = structure(c(885432.034565217, 
    28448.678281859), .Dim = c(2L, 1L, 1L, 1L)), mPL.NArt.Bagr.Akl.Dkl = structure(c(10.0934782608696, 
    0.093159065434869, 10.15, 0.227525112389105), .Dim = c(2L, 
    2L, 1L, 1L, 1L)), mPL.Stratum = 10.2042105263158, SE.mPL.Stratum = 0.060339541401623, 
    nT.NArt.Bagr.Akl.Dkl = structure(c(100L, 100L), .Dim = c(2L, 
    1L, 1L, 1L)))
                  result[["Log"]] <- NULL
                  reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)

              result <- f(
                          list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
                          list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = T),
                          list(Wa = c(3, 5), Begehbar = 1), T, get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524126770.46689, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), nTE = 95L, HBF = 884849.13, 
    se.HBF = 26933.7163569887, Attribute = c("V_DhmR", "V_EoR", 
    "oiB", "N_Dh", "V_DhmR/J", "V_EoR/J", "oiB/J", "N_Dh/J", 
    "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "N_Dh/ha/J"), Größen = c("Wert", 
    "Standardfehler"), Nutzungsart = 2, BAGR = "Alle Baumarten", 
    AKL = "0-500", DKL = c("-400--0.1", ">=400", "400-799.9"), 
    T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 87353346.282143, 71952886.4436022, 48032987.0999775, 
    142557527.092939, 8611027.56346521, 7088938.71511899, 4726178.36129894, 
    14361199.112133, 11.5650941959408, 9.52084328906863, 6.34752328132648, 
    19.2878979046774, 15827144.3573303, 13191580.6485632, 8646455.03964554, 
    34614331.2330218, 1546500.57345153, 1289914.16736829, 843400.886733816, 
    3615004.41938595, 2.09373875284463, 1.74844964526501, 1.14849556079841, 
    4.91312384565579, 9808968.82335751, 7801165.98852727, 5117190.19333058, 
    20477241.8510485, 945285.69758706, 751649.182177319, 494086.795006435, 
    2038205.26799751, 1.26957184309263, 1.00950711516297, 0.663586347053853, 
    2.73742427849903, 4697742.85041113, 3726553.39389314, 2403192.47375069, 
    10896293.1664166, 444820.391957819, 352854.525811099, 228116.045673434, 
    1112010.66415225, 0.594322594731361, 0.471409233545092, 0.304676854871226, 
    1.48969602546028), .Dim = c(12L, 2L, 2L, 1L, 1L, 2L)), BAF.bagr.akl.dkl = structure(c(140861.569545783, 
    25302.5314411181, 744570.465019435, 29957.6426499402), .Dim = c(2L, 
    1L, 1L, 2L)), mPL.NArt.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 10.0934782608696, 0.093159065434869, 10.15, 0.227525112389105
    ), .Dim = c(2L, 2L, 1L, 1L, 2L)), mPL.Stratum = 10.2042105263158, 
    SE.mPL.Stratum = 0.060339541401623, nT.NArt.Bagr.Akl.Dkl = structure(c(0, 
    0, 100, 100), .Dim = c(2L, 1L, 1L, 2L)))
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)
              result <- f(
                          list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
                          list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = T),
                          list(Wa = c(3, 5), Begehbar = 1), N.art = FALSE, get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524127048.4787, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), nTE = 95L, HBF = 884849.13, 
    se.HBF = 26933.7163569887, Attribute = c("V_DhmR", "V_EoR", 
    "oiB", "N_Dh", "V_DhmR/J", "V_EoR/J", "oiB/J", "N_Dh/J", 
    "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "N_Dh/ha/J"), Größen = c("Wert", 
    "Standardfehler"), Nutzungsart = 1, BAGR = "Alle Baumarten", 
    AKL = "0-500", DKL = c("-400--0.1", ">=400", "400-799.9"), 
    T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 97162315.1055005, 
    79754052.4321295, 53150177.2933081, 163034768.943988, 9556313.26105227, 
    7840587.89729631, 5220265.15630538, 16399404.3801305, 12.8346660390334, 
    10.5303504042316, 7.01110962838033, 22.0253221831764, 16187482.3901694, 
    13448743.9310547, 8799083.18376207, 36437060.0697904, 1581956.31021457, 
    1315264.38720073, 858342.316813155, 3801894.20033075, 2.13404940596099, 
    1.77694148902531, 1.16521104107603, 5.16026573052994), .Dim = c(12L, 
    2L, 1L, 1L, 1L, 2L)), BAF.bagr.akl.dkl = structure(c(140861.569545783, 
    25302.5314411181, 744570.465019435, 29957.6426499402), .Dim = c(2L, 
    1L, 1L, 2L)), mPL.NArt.Bagr.Akl.Dkl = structure(c(0, 0, NA, 
    NA, 10.13, 0.0900343368842268, NA, NA), .Dim = c(2L, 2L, 
    1L, 1L, 2L)), mPL.Stratum = 10.2042105263158, SE.mPL.Stratum = 0.060339541401623, 
    nT.NArt.Bagr.Akl.Dkl = structure(c(0, 100), .Dim = c(1L, 
    1L, 1L, 2L)))
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)
})

test_that("VB.A.bagrupp.akl.dkl.stratum.fun.3", {
              f <- VB.A.bagrupp.akl.dkl.stratum.fun.3
              result <- f(
                          list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
                          list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 500, d.B = 500, Ndh = F),
                          list(Wa = c(1:3), Begehbar = 1), F, get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524129680.51224, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), nTE = 95L, HBF = 884849.13, 
    se.HBF = 26933.7163569887, Attribute = c("V_DhmR", "V_EoR", 
    "oiB", "V_EoR_HB", "V_DhmR/J", "V_EoR/J", "oiB/J", "V_EoR_HB/J", 
    "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "V_EoR_HB/ha/J"), 
    Größen = c("Wert", "Standardfehler"), Nutzungsart = "insgesamt", 
    BAGR = c("Alle Baumarten", "Alle BA"), AKL = "0-500", DKL = "0-500", 
    T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(97162315.1055005, 
    79754052.4321295, 53150177.2933081, 76608278.0039962, 9556313.26105227, 
    7840587.89729631, 5220265.15630538, 7530810.56156054, 10.7928252965738, 
    8.85509851825765, 5.89572655214439, 8.64177736783732, 16187482.3901694, 
    13448743.9310547, 8799083.18376207, 13135429.5096796, 1581956.31021457, 
    1315264.38720073, 858342.316813155, 1284603.15552081, 1.72810302200297, 
    1.43925747937161, 0.941784570083864, 1.43214225094993, 97162315.1055005, 
    79754052.4321295, 53150177.2933081, 76608278.0039962, 9556313.26105227, 
    7840587.89729631, 5220265.15630538, 7530810.56156054, 10.7928252965738, 
    8.85509851825765, 5.89572655214439, 8.64177736783732, 16187482.3901694, 
    13448743.9310547, 8799083.18376207, 13135429.5096796, 1581956.31021457, 
    1315264.38720073, 858342.316813155, 1284603.15552081, 1.72810302200297, 
    1.43925747937161, 0.941784570083864, 1.43214225094993), .Dim = c(12L, 
    2L, 1L, 2L, 1L, 1L)), BAF.bagr.akl.dkl = structure(c(885432.034565217, 
    28448.678281859, 885432.034565217, 28448.678281859), .Dim = c(2L, 
    2L, 1L, 1L)), mPL.NArt.Bagr.Akl.Dkl = structure(c(10.13, 
    0.0900343368842268, NA, NA, 10.13, 0.0900343368842268, NA, 
    NA), .Dim = c(2L, 2L, 2L, 1L, 1L)), mPL.Stratum = 10.2042105263158, 
    SE.mPL.Stratum = 0.060339541401623, nT.NArt.Bagr.Akl.Dkl = structure(c(100L, 
    100L), .Dim = c(1L, 2L, 1L, 1L)))

              result[["Log"]] <- NULL
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)

              f <- VB.A.bagrupp.akl.dkl.stratum.fun.3
              result <- f(
                          list(bagr.lab = c("Alle Baumarten"), ba.grupp = list(c(10:299))),
                          list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 500, d.B = 500, Ndh = T),
                          list(Wa = c(1:3), Begehbar = 1), T, get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524129801.14248, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), nTE = 95L, HBF = 884849.13, 
    se.HBF = 26933.7163569887, Attribute = c("V_DhmR", "V_EoR", 
    "oiB", "V_EoR_HB", "V_DhmR/J", "V_EoR/J", "oiB/J", "V_EoR_HB/J", 
    "V_DhmR/ha/J", "V_EoR/ha/J", "oiB/ha/J", "V_EoR_HB/ha/J"), 
    Größen = c("Wert", "Standardfehler"), Nutzungsart = c("geerntet", 
    "ungenutzt"), BAGR = c("Alle Baumarten", "Alle BA"), AKL = "0-500", 
    DKL = c("-500--0.1", ">=500", "500-999.9"), T.VBN.A.NArt.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    87353346.282143, 71952886.4436022, 48032987.0999775, 69367755.3583596, 
    8611027.56346521, 7088938.71511899, 4726178.36129894, 6833592.77189688, 
    11.5650941959408, 9.52084328906863, 6.34752328132648, 9.32866441054395, 
    15827144.3573303, 13191580.6485632, 8646455.03964554, 12869278.1546703, 
    1546500.57345153, 1289914.16736829, 843400.886733816, 1258491.04927963, 
    2.09373875284463, 1.74844964526501, 1.14849556079841, 1.73815692630429, 
    9808968.82335751, 7801165.98852727, 5117190.19333058, 7240522.64563656, 
    945285.69758706, 751649.182177319, 494086.795006435, 697217.789663656, 
    1.26957184309263, 1.00950711516297, 0.663586347053853, 0.951784953821304, 
    4697742.85041113, 3726553.39389314, 2403192.47375069, 3631952.97853277, 
    444820.391957819, 352854.525811099, 228116.045673434, 343421.637192864, 
    0.594322594731361, 0.471409233545092, 0.304676854871226, 
    0.466606401315606, 87353346.282143, 71952886.4436022, 48032987.0999775, 
    69367755.3583596, 8611027.56346521, 7088938.71511899, 4726178.36129894, 
    6833592.77189688, 11.5650941959408, 9.52084328906863, 6.34752328132648, 
    9.32866441054395, 15827144.3573303, 13191580.6485632, 8646455.03964554, 
    12869278.1546703, 1546500.57345153, 1289914.16736829, 843400.886733816, 
    1258491.04927963, 2.09373875284463, 1.74844964526501, 1.14849556079841, 
    1.73815692630429, 9808968.82335751, 7801165.98852727, 5117190.19333058, 
    7240522.64563656, 945285.69758706, 751649.182177319, 494086.795006435, 
    697217.789663656, 1.26957184309263, 1.00950711516297, 0.663586347053853, 
    0.951784953821304, 4697742.85041113, 3726553.39389314, 2403192.47375069, 
    3631952.97853277, 444820.391957819, 352854.525811099, 228116.045673434, 
    343421.637192864, 0.594322594731361, 0.471409233545092, 0.304676854871226, 
    0.466606401315606), .Dim = c(12L, 2L, 2L, 2L, 1L, 2L)), BAF.bagr.akl.dkl = structure(c(140861.569545783, 
    25302.5314411181, 140861.569545783, 25302.5314411181, 744570.465019435, 
    29957.6426499402, 744570.465019435, 29957.6426499402), .Dim = c(2L, 
    2L, 1L, 2L)), mPL.NArt.Bagr.Akl.Dkl = structure(c(0, 0, 0, 
    0, 0, 0, 0, 0, 10.0934782608696, 0.093159065434869, 10.15, 
    0.227525112389105, 10.0934782608696, 0.093159065434869, 10.15, 
    0.227525112389105), .Dim = c(2L, 2L, 2L, 1L, 2L)), mPL.Stratum = 10.2042105263158, 
    SE.mPL.Stratum = 0.060339541401623, nT.NArt.Bagr.Akl.Dkl = structure(c(0, 
    0, 0, 0, 100, 100, 100, 100), .Dim = c(2L, 2L, 1L, 2L)))
              result[["Log"]] <- NULL
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)

})

test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.2", {
              f <- iVB.ew.bagrupp.akl.dkl.stratum.fun.2
              result <- f(
                          get_data("baeume.23"), get_data("baeume.3"),
                          list(
                               bagr.lab = c("Fichte", "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche"),
                               ba.grupp = list(c(10), c(30), c(40), c(20), c(100), c(110, 111))
                               ),
                          list(A.ob = 160, A.b = 80), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
                          list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
                          )
  reference <- 
list(Log = list(Datum = structure(1524130471.5794, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), HBF = 884849.13, se_HBF = 26933.7163569886, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J", 
    "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J", 
    "V_EoR/ha/J", "oiB/ha/J", "mBAF_mLK", "mBAFoLK", "mPL", "nT"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche", "Alle BA"
    ), AKL = c("1-80", "81-160", ">160"), DKL = "0-400", iVB.bagr.akl.dkl = structure(c(38578989.1346066, 
    37274584.4339574, 30871378.9420156, 17318001.896712, 3829088.07859518, 
    3700973.25512877, 3065288.06147166, 1719269.48704421, 16.3588992778089, 
    16.0616655000608, 13.095739148806, 7.3451839687859, 234067.586918234, 
    230422.757535, 10.1965909090909, 51, 7064309.85331519, 6833070.5060542, 
    5721847.16744474, 3138833.24995666, 704060.089683501, 680751.100500394, 
    570582.864427224, 313281.324793148, 1.41618719470543, 1.39756907324721, 
    1.16243081576028, 0.618174113825567, 36047.2432839542, 35501.2978662783, 
    0.0936981995751906, NA, 7446158.54406565, 7335776.8373938, 
    5896665.98328949, 3270665.31931315, 728632.949146747, 717919.129807848, 
    576926.164537153, 319965.524875538, 17.4671663905912, 17.5066836634948, 
    13.8303727862662, 7.67037926132582, 41714.4334034185, 41008.2882405, 
    10.2333333333333, 20, 3130571.0040534, 3123663.56038139, 
    2501492.11734182, 1385306.97104375, 305100.301234151, 304382.45972759, 
    243795.191463436, 135009.946102188, 3.47934075309124, 3.54530903189101, 
    2.76057634632153, 1.5355944313375, 14993.2994931396, 14721.219114285, 
    0.154454033603507, NA, 419339.695874563, 419339.695874563, 
    333357.933156108, 212965.223708274, 39560.3486674116, 39560.3486674116, 
    31448.8616185008, 20091.0588404032, 3.95403741435943, 3.95403741435943, 
    3.1432982687789, 2.00809146089482, 10005.051678, 10005.051678, 
    10.1862068965517, 8, 419339.695874563, 419339.695874563, 
    333357.933156108, 212965.223708274, 39560.3486674116, 39560.3486674116, 
    31448.8616185008, 20091.0588404032, 4.34793961695165, 4.34793961695165, 
    3.45643443359612, 2.20813803773816, 6362.82020976011, 6362.82020976011, 
    0.229130872852132, NA, 780268.924036483, 780268.924036483, 
    525936.900938942, 427685.280902269, 77841.3872161733, 77841.3872161733, 
    52467.1431168967, 42706.4774786378, 7.13625356336798, 7.25401074055178, 
    4.81002266811989, 3.91519554038089, 10907.8785562989, 10730.806722, 
    10.1478260869565, 6, 455158.258112427, 455158.258112427, 
    305848.423550792, 238431.461597121, 45490.0017710298, 45490.0017710298, 
    30565.2275233528, 23836.5640112237, 2.25004487474974, 2.28387632148609, 
    1.40531351556867, 1.41538553570945, 6683.58810834758, 6582.13474673117, 
    0.110776018273835, NA, 12335737.5549831, 10958353.9075574, 
    10512807.8503593, 8843525.19459513, 1204914.21832757, 1068876.75149967, 
    1025452.01171263, 865349.767687009, 13.4904311640577, 12.1257548298968, 
    11.4811407863169, 9.68860794921854, 89316.2126306087, 88149.2959815, 
    10.2755319148936, 52, 2607533.08989603, 2595847.51217382, 
    2235755.81569215, 1854620.59700244, 251950.6161075, 250638.182868285, 
    215302.463947416, 179993.304173252, 1.97594273083231, 1.80429665312526, 
    1.60658445946242, 1.38757035513467, 19830.2943522438, 19546.9975731115, 
    0.0889470510655592, NA, 769126.504836601, 769126.504836601, 
    453068.025115089, 518505.259118446, 72086.7537699952, 72086.7537699952, 
    42353.6649094619, 48842.277377274, 7.95408931446569, 7.97993161039812, 
    4.67332506828783, 5.38928188971173, 9062.8544538587, 9033.505209, 
    10.4037037037037, 16, 426315.93938982, 426315.93938982, 261581.727721741, 
    281265.08474093, 39467.9445700063, 39467.9445700063, 24120.8983857223, 
    26267.4155527574, 2.05166664468829, 2.04657435912396, 1.35957882599328, 
    1.28256299130323, 3943.54161236942, 3927.88631652839, 0.193994193319678, 
    NA, 69158101.606427, 65551186.3409732, 54970840.6258483, 
    36048999.5146055, 6832138.93914413, 6477311.97588649, 5428477.32783235, 
    3560329.20420961, 13.3987986629504, 12.8823592579162, 10.6460180932925, 
    6.98231324127651, 509906.829038038, 502804.7926785, 10.2691823899371, 
    92, 7614446.81591268, 7418935.75857717, 6134426.80050372, 
    3638317.68968125, 757550.779419839, 737449.300686193, 609676.156862497, 
    361395.483694679, 1.01252234482123, 0.996380220214172, 0.822426708359502, 
    0.466204937405265, 41511.6899750324, 40848.1028673558, 0.0692614225788511, 
    NA, 12804419.8066037, 11546821.2719741, 10440249.5602134, 
    5727539.57476748, 1270664.81122989, 1143255.83568211, 1036061.92955204, 
    568278.867770883, 11.3990282943125, 10.4644731829733, 9.29442536320217, 
    5.09798243842936, 111471.327066, 109251.160158, 10.2814814814815, 
    22, 2847975.01365716, 2669915.86258264, 2321370.73887026, 
    1272745.77242554, 284173.598845435, 265662.702064329, 231593.99070855, 
    126952.274255374, 1.34234144348497, 1.29427488157895, 1.09568912103919, 
    0.59494704947126, 24919.0535583837, 24458.1460446788, 0.128698408590354, 
    NA, 5998573.86652069, 5998573.86652069, 4753249.44203081, 
    2677429.6861996, 572306.5679586, 572306.5679586, 453648.64063116, 
    254856.466687711, 15.0859480268728, 15.3512623742604, 11.9581360728298, 
    6.71799281367214, 37936.4006119565, 37280.749557, 10.5368421052632, 
    11, 2417154.57885441, 2417154.57885441, 1918552.37029263, 
    1065667.16272775, 231853.991273688, 231853.991273688, 184073.771523544, 
    101726.612758561, 1.74176690773075, 1.77449993176208, 1.38215263625505, 
    0.812444913205468, 14806.6124263448, 14552.3705211404, 0.18148513197229, 
    NA, 528757.069777056, 528757.069777056, 436448.430110282, 
    320806.639885173, 48068.8245251869, 48068.8245251869, 39677.1300100256, 
    29164.2399895612, 6.19665909515467, 6.31529752311039, 5.11486708848959, 
    3.75962705079037, 7757.21623330435, 7611.490092, 11, 1, 528757.069777056, 
    528757.069777056, 436448.430110282, 320806.639885173, 48068.8245251869, 
    48068.8245251869, 39677.1300100256, 29164.2399895612, NaN, 
    NaN, 6.3947911909159e-08, 5.48253703981273e-08, 7757.21623330435, 
    7611.490092, NaN, NA, 167431.362416497, 167431.362416497, 
    176845.870684453, 117489.217030861, 16306.3034229244, 16306.3034229244, 
    17355.5729386317, 11554.3395779929, 1.16356414465556, 1.18218433436576, 
    1.23843656392139, 0.824479644431641, 14014.0992637337, 13793.3678775, 
    10.3052631578947, 6, 154348.510960393, 154348.510960393, 
    115442.091288308, 65053.6953641447, 15320.6811377471, 15320.6811377471, 
    11461.580766801, 6456.60924512208, 0.633169809847534, 0.64298897223873, 
    0.289899190915599, 0.200265799717663, 9359.04040709663, 9209.40823809113, 
    0.220731925967768, NA, 8319125.56077182, 7927794.84303215, 
    7933515.23819171, 5616108.70708897, 815992.575389373, 775661.306538146, 
    778661.914297062, 550149.56342279, 8.29911182291852, 8.03392716542363, 
    7.91943761977919, 5.59533613893099, 98322.8799419185, 96548.2124205, 
    10.2166666666667, 23, 2059909.54342739, 1930559.12607307, 
    2072313.68535593, 1346808.91204463, 198527.065244867, 185410.190166605, 
    200958.357759498, 129815.199117499, 1.3750074570421, 1.19257952787766, 
    1.48047754658107, 0.845627041084856, 21127.8315482122, 20761.9608730525, 
    0.146606415020033, NA, 3875447.39572174, 3881984.39886629, 
    2799534.11289896, 2098583.91993314, 373213.562481529, 373777.097235369, 
    268083.38247138, 202670.216226871, 8.84254660752433, 9.01544251206746, 
    6.35169790841476, 4.80186416867377, 42206.5700127554, 41459.6506755, 
    10.5767441860465, 13, 1351472.12330615, 1351266.6317957, 
    920428.639941417, 738540.569585549, 132502.048926611, 132484.792024733, 
    89477.464134225, 72491.3802473924, 1.3007508888216, 1.31566919696107, 
    0.666698882900024, 0.651025156110223, 13225.4263999362, 12996.4675387268, 
    0.219382230688503, NA, 37936434.4000149, 36152117.7058311, 
    31686633.8792672, 20442412.2997465, 3697062.98899148, 3516497.18076525, 
    3088314.08163934, 1990828.99729162, 10.6865077240184, 10.3555921710205, 
    8.92689477726118, 5.75457045771361, 345956.142499402, 339574.707336, 
    10.3388888888889, 51, 6231980.17715785, 6023915.17567493, 
    5218239.30209528, 3630675.51366997, 602672.861708755, 581876.23168294, 
    504190.542543992, 349034.920500968, 1.27388398583891, 1.23889898160136, 
    1.07635969445, 0.771828729966195, 38425.9434877203, 37773.9632686653, 
    0.0930553655526422, NA, 324398.377039459, 324398.377039459, 
    267164.10717868, 131200.092117574, 29934.7002382877, 29934.7002382877, 
    24639.3487019914, 12146.5535492077, 10.866217134681, 11.1324528418398, 
    8.94401851101594, 4.40916686163786, 2754.8409779837, 2688.9581895, 
    10.5818181818182, 3, 232933.245203445, 232933.245203445, 
    193072.194361287, 92333.6973546429, 21421.8532220582, 21421.8532220582, 
    17738.277623815, 8545.64340660511, 2.93890804987776, 2.93960737822178, 
    2.60297574255426, 0.695098110412408, 1835.44594362468, 1789.28616513626, 
    0.220985909383427, NA, 136578.837037062, 136578.837037062, 
    115677.081613538, 62440.8331235108, 12416.2579124602, 12416.2579124602, 
    10516.0983285035, 5676.43937486462, 23.3010668034124, 23.5652950750519, 
    19.7351175685397, 10.6527340211342, 532.862208293478, 526.8874365, 
    11, 1, 136578.837037062, 136578.837037062, 115677.081613538, 
    62440.8331235108, 12416.2579124602, 12416.2579124602, 10516.0983285035, 
    5676.43937486462, NaN, NaN, NaN, 1.52570186845145e-07, 532.862208293478, 
    526.8874365, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, NA, 190477.039412579, 190477.039412579, 187153.67213519, 
    109049.959585294, 17969.5320200546, 17969.5320200546, 17656.0068052066, 
    10287.7320363485, 16.2793018429665, 16.2793018429665, 15.9952670889064, 
    9.320058803555, 1103.826945, 1103.826945, 10.6, 1, 190477.039412579, 
    190477.039412579, 187153.67213519, 109049.959585294, 17969.5320200546, 
    17969.5320200546, 17656.0068052066, 10287.7320363485, 0, 
    0, NaN, NaN, 1103.826945, 1103.826945, NaN, NA, 418710.752550494, 
    418710.752550494, 470544.180337288, 278890.100987009, 38973.9436804871, 
    38973.9436804871, 43540.176488618, 25960.8302194148, 11.8580158933346, 
    12.1514294300329, 13.2473148992392, 7.8987115050435, 3286.71710605435, 
    3207.3546495, 10.7142857142857, 2, 322489.486175105, 322489.486175105, 
    487432.268423501, 214303.556105352, 29932.9940867468, 29932.9940867468, 
    45133.8857369242, 19892.6638512357, 0.807019025425608, 0.726403181352631, 
    5.10252482998579, 0.572605841121077, 2622.02878766126, 2546.30614464259, 
    0.0696165604426995, NA, 2224985.50920597, 2224985.50920597, 
    1726014.63855255, 1156164.56324798, 204774.780427974, 204774.780427974, 
    159209.188428091, 106135.250647099, 9.3543695396381, 9.50857649493597, 
    7.27287598379857, 4.8483917485351, 21890.8157904457, 21535.797765, 
    10.6333333333333, 6, 1021811.14583966, 1021811.14583966, 
    754980.093951897, 523533.185935449, 92306.6393352392, 92306.6393352392, 
    68473.2023004525, 47063.8622469885, 1.97776796505207, 2.00889408017422, 
    1.58011406416745, 0.863684639573858, 9716.0228122709, 9565.20428061737, 
    0.269973129606571, NA, 3295150.51524556, 3295150.51524556, 
    2766553.67981725, 1737745.54906136, 304069.214279263, 304069.214279263, 
    255560.81875241, 160206.805826934, 10.2833564253835, 10.4624796258096, 
    8.6428446688465, 5.41805486621054, 29569.0630277772, 29062.8249855, 
    10.6685714285714, 9, 1176899.02573341, 1176899.02573341, 
    1031487.35999045, 620275.595318577, 106993.551297085, 106993.551297085, 
    94410.2745444025, 56317.9609898109, 1.66734969020068, 1.69310789773542, 
    1.69826531788661, 0.765677118713801, 10675.2359338299, 10490.9288786009, 
    0.189435659534734, NA), .Dim = c(16L, 2L, 7L, 3L, 1L)), VB.A.bagr.akl.dkl = structure(c(22004364.3319384, 
    21482655.807392, 17328665.4130458, 10520984.2027641, 2126132.97545832, 
    2079132.20748116, 1672171.29210655, 1024150.77125236, 9.08341476686831, 
    9.02312006731954, 7.14396774932654, 4.37544892369112, 10.1732954545455, 
    7802714.92682462, 7383042.91924797, 6194611.88367344, 3538361.53033952, 
    722465.784648793, 685834.02339916, 572363.950645394, 332164.573851684, 
    2.97943480053915, 2.86442476439373, 2.36452169977378, 1.35384212639589, 
    0.084030327556412, 464051.167173066, 464051.167173066, 373972.220852227, 
    206878.494039255, 47352.159915619, 47352.159915619, 38160.4306992069, 
    21110.0504121689, 1.13515049953282, 1.15469730504025, 0.914801606680331, 
    0.506061060640917, 10.2318181818182, 464051.167173066, 464051.167173066, 
    373972.220852227, 206878.494039255, 47352.159915619, 47352.159915619, 
    38160.4306992069, 21110.0504121689, 1.02025124474676, 1.03752380340477, 
    0.82220593506858, 0.454837862688036, 0.133980692144502, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.148275862069, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0.239662268268708, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 10.104347826087, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0.0593639545141648, 5952415.65447242, 3982641.84887815, 
    5261145.56416457, 4658980.66484553, 578318.128590264, 381760.212794887, 
    511001.246019281, 452753.617693582, 6.47495131686847, 4.33083677576968, 
    5.72125967916558, 5.06910900449918, 10.2313829787234, 2107284.74884825, 
    1751553.13218524, 1873211.09774277, 1637507.29108607, 205547.670377995, 
    169638.194200193, 182713.976330327, 159242.320062844, 2.27336588631628, 
    1.7711365081253, 2.02421820638611, 1.73286257299236, 0.0802844669176204, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.3074074074074, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.171510213531419, 32097927.3019743, 
    28970781.5605925, 25628357.7015626, 17646574.5830419, 3098327.87387682, 
    2792788.73791019, 2472803.55991134, 1712128.92786878, 6.07626275514284, 
    5.55441948560728, 4.84952038115747, 3.357728962169, 10.2270440251572, 
    9200496.09546694, 8759060.3291953, 7293446.66342885, 4510439.98611592, 
    845812.192022949, 805353.711425124, 670404.921417564, 419690.589756086, 
    1.5817269213822, 1.53337793353989, 1.25484913637043, 0.7775064052144, 
    0.0611961033586396, 29221908.8623045, 28994632.6001681, 23495800.136807, 
    13196230.7516395, 2976826.94048525, 2951574.02247009, 2393832.3007165, 
    1343424.1125727, 26.7048667925405, 27.016408962628, 21.4748703879622, 
    12.0517459326315, 10.2333333333333, 9489618.44519874, 9399276.24991024, 
    7652057.20329698, 4263522.61997562, 978801.890512869, 967909.041088606, 
    789327.910234503, 439478.684391137, 7.76374101397991, 7.88142263271598, 
    6.27184600166249, 3.47623063776799, 0.121796767913655, 3725595.6006477, 
    3725595.6006477, 2953756.50635454, 1646671.64767726, 364664.980197737, 
    364664.980197737, 289246.337592679, 161224.989408276, 9.61253504062809, 
    9.78158927948019, 7.62450661967958, 4.24987576068201, 10.4921052631579, 
    1908748.02103903, 1908748.02103903, 1513842.12932116, 844348.446077912, 
    188190.825524982, 188190.825524982, 149338.949503258, 83272.098508672, 
    4.08653627720286, 4.15468653968781, 3.25345547271879, 1.81315134105948, 
    0.160744430461514, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.9, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 382103.849253367, 
    382103.849253367, 300734.201900582, 222911.44870283, 37461.1616915066, 
    37461.1616915066, 29483.7452843707, 21854.0635983166, 2.67310520544479, 
    2.7158821561349, 2.10386302605049, 1.5594340518817, 10.4631578947368, 
    382103.849253367, 382103.849253367, 300734.201900581, 222911.44870283, 
    37461.1616915066, 37461.1616915066, 29483.7452843707, 21854.0635983166, 
    3.02931239368978, 3.07812508475471, 2.38421530378186, 1.76723792647026, 
    0.179023835379752, 18325429.522914, 18028977.492266, 16543761.3877891, 
    12191648.1653803, 1796328.18439525, 1767546.43384691, 1621798.16553778, 
    1194417.90115378, 18.2696864194416, 18.3073967868887, 16.4946161716969, 
    12.1479141158126, 10.1611111111111, 8136348.85370481, 8137583.37255576, 
    7359922.71558027, 5316385.17103121, 806886.494838769, 807010.015668584, 
    729937.553044818, 526878.048217329, 7.34834159892906, 7.50389859074089, 
    6.64996473466124, 4.77382633808472, 0.130848207846765, 3356610.1991898, 
    3356610.1991898, 2583413.12802036, 2022427.08241137, 323737.904572186, 
    323737.904572186, 249170.912098215, 195367.711571757, 7.67032015333982, 
    7.80850536117745, 5.90360486585175, 4.62884597143795, 10.4744186046512, 
    1811159.34808223, 1811159.34808223, 1394778.7899536, 1104474.77102487, 
    177078.385283548, 177078.385283548, 136380.522970022, 108268.673712191, 
    3.86909722281777, 3.93993521853643, 2.97822890839198, 2.35583367527132, 
    0.187786191146739, 58341308.4500679, 57817580.1572835, 48447522.8705594, 
    31320620.1814251, 5834338.66073849, 5780303.99217499, 4841126.6835313, 
    3120244.45890804, 16.8643881232679, 17.0221864800299, 13.9934693702965, 
    9.01919080368239, 10.2861111111111, 12795356.4298065, 12709189.8601685, 
    10801134.376441, 6997581.11257371, 1296280.30462598, 1286391.15820543, 
    1092168.4341585, 702731.226216708, 3.56701065626028, 3.61918415529128, 
    3.01242873231012, 1.93009794604841, 0.0847154458654687, 1316666.25051296, 
    1316666.25051296, 1041195.77250982, 668598.281197344, 123052.920608688, 
    123052.920608688, 97308.0161224128, 62485.8206726489, 44.6678852217276, 
    45.762303441233, 35.3225528805782, 22.6821878910713, 10.4363636363636, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    123052.920608688, 123052.920608688, 97308.0161224128, 62485.8206726489, 
    26.5306835300096, 27.4720880065798, 20.9799829854224, 13.4721835546741, 
    0.155339571388783, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.5, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.91771055403855e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 10.8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 1.21667471666295e-07, 3594585.19592882, 3594585.19592882, 
    3235123.87056896, 2477219.37753743, 332831.962586002, 332831.962586002, 
    299548.506534163, 229372.164586799, 101.265777323185, 103.771487396284, 
    91.1391205474834, 69.7876200431978, 10.8, 3594585.19592882, 
    3594585.19592882, 3235123.87056896, 2477219.37753743, 332831.962586002, 
    332831.962586002, 299548.506534163, 229372.164586799, 33.8765271253328, 
    35.5737430535069, 30.4888479703491, 23.3461122394854, 1.12642190757164e-07, 
    1811827.90701659, 1811827.90701659, 1401852.21692864, 1037164.87010638, 
    167761.843242277, 167761.843242277, 129801.131197096, 96033.7842691089, 
    7.66357201340561, 7.7899061401349, 5.92947893946228, 4.38694405856831, 
    10.4958333333333, 1811827.90701659, 1811827.90701659, 1401852.21692864, 
    1037164.87010638, 167761.843242277, 167761.843242277, 129801.131197096, 
    96033.7842691089, 7.90726309258865, 8.04765332560717, 6.11802823726011, 
    4.52644286279147, 0.235301368434735, 6723079.35345837, 6723079.35345837, 
    5678171.86000741, 4182982.52884115, 623646.726436967, 623646.726436967, 
    526657.653853672, 387891.769528557, 21.0911899998696, 21.4585721363328, 
    17.8111039013624, 13.1181623565201, 10.5457142857143, 5551495.81216955, 
    5551495.81216955, 4742162.00916957, 3570777.42056449, 514287.608987023, 
    514287.608987023, 439278.884033358, 330730.610091939, 16.0854770049392, 
    16.4165628478359, 13.7393378427446, 10.3462538821149, 0.164298155380745
    ), .Dim = c(13L, 2L, 7L, 3L, 1L)))
              result[["Log"]] <- NULL
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)

              result <- f(
                          get_data("baeume.23"), get_data("baeume.3"),
                          list(
                               bagr.lab = c("Fichte", "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche"),
                               ba.grupp = list(c(10), c(30), c(40), c(20), c(100), c(110, 111))
                               ),
                          list(A.ob = 160, A.b = 80), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = T),
                          list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
                          )
  reference <- list(Log = list(Datum = structure(1524130555.51314, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), HBF = 884849.13, se_HBF = 26933.7163569886, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J", 
    "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J", 
    "V_EoR/ha/J", "oiB/ha/J", "mBAF_mLK", "mBAFoLK", "mPL", "nT"
    ), Größen = c("Wert", "Standardfehler"), BAGR = c("Fichte", 
    "Tanne", "Douglasie", "Kiefer", "Buche", "Eiche", "Alle BA"
    ), AKL = c("1-80", "81-160", ">160"), DKL = c("-400--0.1", 
    ">=400", "400-799.9"), iVB.bagr.akl.dkl = structure(c(120942.0591476, 
    120942.0591476, 84666.5397415973, 80995.757804819, 12094.20591476, 
    12094.20591476, 8466.65397415973, 8099.5757804819, 0.223042015799198, 
    0.227042936719649, 0.156142501854232, 0.149372825461182, 
    54223.8908280326, 53268.3645195, 10.0885245901639, 33, 120942.0591476, 
    120942.0591476, 84666.5397415973, 80995.757804819, 12094.20591476, 
    12094.20591476, 8466.65397415973, 8099.5757804819, 0.221633674446808, 
    0.225383378603327, 0.155156580249107, 0.14842964923375, 16306.3682331666, 
    16039.691590507, 0.116783077377965, NA, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 7128.63138032609, 6951.4283925, 10.2321428571429, 
    17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3276.46648127269, 
    3179.57524218374, 0.179151666672739, NA, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 8937.87, 8937.87, 10.1428571428571, 6, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6288.0281365096, 6288.0281365096, 
    0.304239227463348, NA, 180148.896398806, 180148.896398806, 
    118229.296972142, 136471.940770133, 18014.8896398806, 18014.8896398806, 
    11822.9296972142, 13647.1940770133, 3.57286303768253, 3.66167416833521, 
    2.34482194211075, 2.70662525613806, 5042.14391928261, 4919.8505415, 
    10, 3, 127050.129010826, 127050.129010826, 83468.557231055, 
    96399.2280302705, 12705.0129010826, 12705.0129010826, 8346.8557231055, 
    9639.92280302706, 2.9869940226946, 3.05621530416224, 1.96785359325477, 
    2.27552157359254, 3640.32577026922, 3548.36532293884, 5.26835606386175e-08, 
    NA, 243461.644804428, 168190.979471334, 178539.790717102, 
    273059.082366939, 24131.8508933742, 17162.3448440136, 17701.5887519371, 
    27212.4595650016, 1.06032332786927, 0.766999347826731, 0.777785656680837, 
    1.19568141759871, 22758.9549895761, 22375.957545, 10.290780141844, 
    40, 183570.488237687, 168190.979471334, 134879.318189556, 
    214829.683722759, 18458.1599715921, 17162.3448440136, 13566.7424752894, 
    21727.8377204635, 0.787540670381674, 0.716888285320727, 0.578458402352218, 
    0.915896508611721, 9470.65219010231, 9308.83826261282, 0.111389578960664, 
    NA, 165574.79768128, 165574.79768128, 91431.5376139407, 135109.927198566, 
    16557.479768128, 16557.479768128, 9143.15376139407, 13510.9927198566, 
    3.7010664291212, 3.72550720487125, 2.04375423775105, 3.02009015138998, 
    4473.7051023587, 4444.3558575, 10.356862745098, 15, 165574.79768128, 
    165574.79768128, 91431.5376139407, 135109.927198566, 16557.479768128, 
    16557.479768128, 9143.15376139407, 13510.9927198566, 2.47892108572305, 
    2.48289501092391, 1.36887720634614, 2.02281296497637, 2326.0701567567, 
    2315.56507625586, 0.199114687703598, NA, 1354656.13475807, 
    1128517.17667436, 911759.332695305, 1238746.197748, 137750.169731434, 
    114017.520043116, 92624.6840455129, 126770.50726885, 0.977911648830965, 
    0.820829596891213, 0.65755822787001, 0.899965176290663, 140861.569545783, 
    138905.225244, 10.2547297297297, 85, 461933.560333997, 436280.531863105, 
    307422.153481801, 430753.32319555, 46883.4072928578, 43880.5481997132, 
    31226.9984055816, 44327.348563381, 0.307345714840528, 0.280105773328343, 
    0.203893675737082, 0.293901827489257, 25302.5314411181, 24943.0249509039, 
    0.0718396793958668, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 38458047.075459, 37153642.3748098, 
    30786712.402274, 17237006.1389072, 3816993.87268042, 3688879.04921401, 
    3056821.4074975, 1711169.91126373, 21.2239514403996, 20.8229611833067, 
    16.9971006710424, 9.51476169843333, 179843.696090201, 177154.3930155, 
    10.2362204724409, 38, 7064041.38653056, 6832559.73480579, 
    5722510.97724008, 3138153.34601115, 704028.153328185, 680695.078331943, 
    570646.157155352, 313209.93057916, 1.79825955786152, 1.65423258783266, 
    1.465180125808, 0.800629446632623, 31125.1420082234, 30635.5877577947, 
    0.113466683072476, NA, 7446158.54406565, 7335776.8373938, 
    5896665.98328949, 3270665.31931315, 728632.949146747, 717919.129807848, 
    576926.164537153, 319965.524875538, 21.0674006825185, 21.080015392259, 
    16.6810115940625, 9.25135478026221, 34585.8020230924, 34056.859848, 
    10.2866666666667, 10, 3130571.0040534, 3123663.56038139, 
    2501492.11734182, 1385306.97104375, 305100.301234151, 304382.45972759, 
    243795.191463436, 135009.946102188, 5.02372854024218, 5.04022110978755, 
    3.98350771996353, 2.21137143017173, 13181.2295032086, 12957.4347118608, 
    0.191748473896277, NA, 419339.695874563, 419339.695874563, 
    333357.933156108, 212965.223708274, 39560.3486674116, 39560.3486674116, 
    31448.8616185008, 20091.0588404032, 37.0699286569007, 37.0699286569007, 
    29.4690794143308, 18.8262779005499, 1067.181678, 1067.181678, 
    10.3, 2, 419339.695874563, 419339.695874563, 333357.933156108, 
    212965.223708274, 39560.3486674116, 39560.3486674116, 31448.8616185008, 
    20091.0588404032, NaN, NaN, NaN, NaN, 1067.181678, 1067.181678, 
    0.213200716355601, NA, 600120.027637677, 600120.027637677, 
    407707.6039668, 291213.340132137, 59826.4975762927, 59826.4975762927, 
    40644.2134196825, 29059.2834016246, 10.1993188029257, 10.2954652759307, 
    6.92909173953986, 4.95407399070579, 5865.7346370163, 5810.9561805, 
    10.1789473684211, 5, 411316.213530023, 411316.213530023, 
    279633.876646128, 198458.480484419, 41102.2216521655, 41102.2216521655, 
    27941.3918045738, 19837.508473111, 4.31122223898046, 4.29946554483009, 
    2.81342413226457, 2.13334181736955, 3732.71940092512, 3701.36583907795, 
    0.12887180532235, NA, 12092275.9101787, 10790162.928086, 
    10334268.0596422, 8570466.11222819, 1180782.36743419, 1051714.40665566, 
    1007750.42296069, 838137.308122007, 17.7408506492647, 15.9899806160975, 
    15.1411049475003, 12.5927259900398, 66557.2576410326, 65773.3384365, 
    10.2528, 32, 2566771.57153337, 2555457.74288392, 2212697.33190813, 
    1790211.81649161, 247561.74171849, 246243.798986344, 212793.099941636, 
    173079.801585706, 2.55243081388689, 2.25492016037154, 2.0082588615799, 
    1.84170795458088, 16659.7935746059, 16439.3582875724, 0.0944725735891946, 
    NA, 603551.707155321, 603551.707155321, 361636.487501149, 
    383395.33191988, 55529.2740018672, 55529.2740018672, 33210.5111480678, 
    35331.2846574174, 12.100123519344, 12.100123519344, 7.23674663959513, 
    7.69887444300959, 4589.1493515, 4589.1493515, 10.66, 3, 395410.058119148, 
    395410.058119148, 246441.176761502, 248800.784815849, 36085.2151346737, 
    36085.2151346737, 22457.8449015526, 22739.2578298431, 1.47151877007776, 
    1.47151877007776, 1.15936077950649, 0.781650717847329, 2848.04029366003, 
    2848.04029366003, 0.327747130907648, NA, 67803445.4716689, 
    64422669.1642988, 54059081.293153, 34810253.3168574, 6694388.76941269, 
    6363294.45584337, 5335852.64378684, 3433558.69694076, 18.1397500637809, 
    17.4864029124979, 14.4585318644333, 9.30389595483427, 369045.259492255, 
    363899.5674345, 10.2375, 75, 7635645.80971301, 7432585.14530681, 
    6155159.80522109, 3631077.6096572, 759126.929871393, 738527.9091173, 
    611418.72179923, 359925.130101587, 1.31105509895564, 1.24331113005436, 
    1.05666779186204, 0.638620132225829, 36976.1629178671, 36387.4631760727, 
    0.0741067514847165, NA, 12804419.8066037, 11546821.2719741, 
    10440249.5602134, 5727539.57476748, 1270664.81122989, 1143255.83568211, 
    1036061.92955204, 568278.867770883, 11.3990282943125, 10.4644731829733, 
    9.29442536320217, 5.09798243842936, 111471.327066, 109251.160158, 
    10.2814814814815, 22, 2847975.01365716, 2669915.86258264, 
    2321370.73887026, 1272745.77242554, 284173.598845435, 265662.702064329, 
    231593.99070855, 126952.274255374, 1.34234144348497, 1.29427488157895, 
    1.09568912103919, 0.59494704947126, 24919.0535583837, 24458.1460446788, 
    0.128698408590354, NA, 5998573.86652069, 5998573.86652069, 
    4753249.44203081, 2677429.6861996, 572306.5679586, 572306.5679586, 
    453648.64063116, 254856.466687711, 15.0859480268728, 15.3512623742604, 
    11.9581360728298, 6.71799281367214, 37936.4006119565, 37280.749557, 
    10.5368421052632, 11, 2417154.57885441, 2417154.57885441, 
    1918552.37029263, 1065667.16272775, 231853.991273688, 231853.991273688, 
    184073.771523544, 101726.612758561, 1.74176690773075, 1.77449993176208, 
    1.38215263625505, 0.812444913205468, 14806.6124263448, 14552.3705211404, 
    0.18148513197229, NA, 528757.069777056, 528757.069777056, 
    436448.430110282, 320806.639885173, 48068.8245251869, 48068.8245251869, 
    39677.1300100256, 29164.2399895612, 6.19665909515467, 6.31529752311039, 
    5.11486708848959, 3.75962705079037, 7757.21623330435, 7611.490092, 
    11, 1, 528757.069777056, 528757.069777056, 436448.430110282, 
    320806.639885173, 48068.8245251869, 48068.8245251869, 39677.1300100256, 
    29164.2399895612, NaN, NaN, 6.3947911909159e-08, 5.48253703981273e-08, 
    7757.21623330435, 7611.490092, NaN, NA, 167431.362416497, 
    167431.362416497, 176845.870684453, 117489.217030861, 16306.3034229244, 
    16306.3034229244, 17355.5729386317, 11554.3395779929, 1.16356414465556, 
    1.18218433436576, 1.23843656392139, 0.824479644431641, 14014.0992637337, 
    13793.3678775, 10.3052631578947, 6, 154348.510960393, 154348.510960393, 
    115442.091288308, 65053.6953641447, 15320.6811377471, 15320.6811377471, 
    11461.580766801, 6456.60924512208, 0.633169809847534, 0.64298897223873, 
    0.289899190915599, 0.200265799717663, 9359.04040709663, 9209.40823809113, 
    0.220731925967768, NA, 8319125.56077182, 7927794.84303215, 
    7933515.23819171, 5616108.70708897, 815992.575389373, 775661.306538146, 
    778661.914297062, 550149.56342279, 8.29911182291852, 8.03392716542363, 
    7.91943761977919, 5.59533613893099, 98322.8799419185, 96548.2124205, 
    10.2166666666667, 23, 2059909.54342739, 1930559.12607307, 
    2072313.68535593, 1346808.91204463, 198527.065244867, 185410.190166605, 
    200958.357759498, 129815.199117499, 1.3750074570421, 1.19257952787766, 
    1.48047754658107, 0.845627041084856, 21127.8315482122, 20761.9608730525, 
    0.146606415020033, NA, 3875447.39572174, 3881984.39886629, 
    2799534.11289896, 2098583.91993314, 373213.562481529, 373777.097235369, 
    268083.38247138, 202670.216226871, 8.84254660752433, 9.01544251206746, 
    6.35169790841476, 4.80186416867377, 42206.5700127554, 41459.6506755, 
    10.5767441860465, 13, 1351472.12330615, 1351266.6317957, 
    920428.639941417, 738540.569585549, 132502.048926611, 132484.792024733, 
    89477.464134225, 72491.3802473924, 1.3007508888216, 1.31566919696107, 
    0.666698882900024, 0.651025156110223, 13225.4263999362, 12996.4675387268, 
    0.219382230688503, NA, 37936434.4000149, 36152117.7058311, 
    31686633.8792672, 20442412.2997465, 3697062.98899148, 3516497.18076525, 
    3088314.08163934, 1990828.99729162, 10.6865077240184, 10.3555921710205, 
    8.92689477726118, 5.75457045771361, 345956.142499402, 339574.707336, 
    10.3388888888889, 51, 6231980.17715785, 6023915.17567493, 
    5218239.30209528, 3630675.51366997, 602672.861708755, 581876.23168294, 
    504190.542543992, 349034.920500968, 1.27388398583891, 1.23889898160136, 
    1.07635969445, 0.771828729966195, 38425.9434877203, 37773.9632686653, 
    0.0930553655526422, NA, 324398.377039459, 324398.377039459, 
    267164.10717868, 131200.092117574, 29934.7002382877, 29934.7002382877, 
    24639.3487019914, 12146.5535492077, 10.866217134681, 11.1324528418398, 
    8.94401851101594, 4.40916686163786, 2754.8409779837, 2688.9581895, 
    10.5818181818182, 3, 232933.245203445, 232933.245203445, 
    193072.194361287, 92333.6973546429, 21421.8532220582, 21421.8532220582, 
    17738.277623815, 8545.64340660511, 2.93890804987776, 2.93960737822178, 
    2.60297574255426, 0.695098110412408, 1835.44594362468, 1789.28616513626, 
    0.220985909383427, NA, 136578.837037062, 136578.837037062, 
    115677.081613538, 62440.8331235108, 12416.2579124602, 12416.2579124602, 
    10516.0983285035, 5676.43937486462, 23.3010668034124, 23.5652950750519, 
    19.7351175685397, 10.6527340211342, 532.862208293478, 526.8874365, 
    11, 1, 136578.837037062, 136578.837037062, 115677.081613538, 
    62440.8331235108, 12416.2579124602, 12416.2579124602, 10516.0983285035, 
    5676.43937486462, NaN, NaN, NaN, 1.52570186845145e-07, 532.862208293478, 
    526.8874365, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, NA, 190477.039412579, 190477.039412579, 187153.67213519, 
    109049.959585294, 17969.5320200546, 17969.5320200546, 17656.0068052066, 
    10287.7320363485, 16.2793018429665, 16.2793018429665, 15.9952670889064, 
    9.320058803555, 1103.826945, 1103.826945, 10.6, 1, 190477.039412579, 
    190477.039412579, 187153.67213519, 109049.959585294, 17969.5320200546, 
    17969.5320200546, 17656.0068052066, 10287.7320363485, 0, 
    0, NaN, NaN, 1103.826945, 1103.826945, NaN, NA, 418710.752550494, 
    418710.752550494, 470544.180337288, 278890.100987009, 38973.9436804871, 
    38973.9436804871, 43540.176488618, 25960.8302194148, 11.8580158933346, 
    12.1514294300329, 13.2473148992392, 7.8987115050435, 3286.71710605435, 
    3207.3546495, 10.7142857142857, 2, 322489.486175105, 322489.486175105, 
    487432.268423501, 214303.556105352, 29932.9940867468, 29932.9940867468, 
    45133.8857369242, 19892.6638512357, 0.807019025425608, 0.726403181352631, 
    5.10252482998579, 0.572605841121077, 2622.02878766126, 2546.30614464259, 
    0.0696165604426995, NA, 2224985.50920597, 2224985.50920597, 
    1726014.63855255, 1156164.56324798, 204774.780427974, 204774.780427974, 
    159209.188428091, 106135.250647099, 9.3543695396381, 9.50857649493597, 
    7.27287598379857, 4.8483917485351, 21890.8157904457, 21535.797765, 
    10.6333333333333, 6, 1021811.14583966, 1021811.14583966, 
    754980.093951897, 523533.185935449, 92306.6393352392, 92306.6393352392, 
    68473.2023004525, 47063.8622469885, 1.97776796505207, 2.00889408017422, 
    1.58011406416745, 0.863684639573858, 9716.0228122709, 9565.20428061737, 
    0.269973129606571, NA, 3295150.51524556, 3295150.51524556, 
    2766553.67981725, 1737745.54906136, 304069.214279263, 304069.214279263, 
    255560.81875241, 160206.805826934, 10.2833564253835, 10.4624796258096, 
    8.6428446688465, 5.41805486621054, 29569.0630277772, 29062.8249855, 
    10.6685714285714, 9, 1176899.02573341, 1176899.02573341, 
    1031487.35999045, 620275.595318577, 106993.551297085, 106993.551297085, 
    94410.2745444025, 56317.9609898109, 1.66734969020068, 1.69310789773542, 
    1.69826531788661, 0.765677118713801, 10675.2359338299, 10490.9288786009, 
    0.189435659534734, NA), .Dim = c(16L, 2L, 7L, 3L, 2L)), VB.A.bagr.akl.dkl = structure(c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.083606557377, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0.101359887669538, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 10.2267857142857, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0.149292969945838, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 10.147619047619, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0.323980770388958, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 10.0333333333333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0.0273536646621266, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 10.2439716312057, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0.0967610758331688, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.2549019607843, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.172669426293727, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.2064189189189, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0628628544163266, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 22004364.3319384, 21482655.807392, 17328665.4130458, 
    10520984.2027641, 2126132.97545832, 2079132.20748116, 1672171.29210655, 
    1024150.77125236, 11.8221156575427, 11.7362723672297, 9.29791440267034, 
    5.69467150374121, 10.2007874015748, 7802714.92682462, 7383042.91924797, 
    6194611.88367344, 3538361.53033952, 722465.784648793, 685834.02339916, 
    572363.950645394, 332164.573851684, 3.80858482830348, 3.65565382586501, 
    3.02128651077805, 1.7353813710409, 0.101865276529843, 464051.167173066, 
    464051.167173066, 373972.220852227, 206878.494039255, 47352.159915619, 
    47352.159915619, 38160.4306992069, 21110.0504121689, 1.36912134881252, 
    1.39038537689492, 1.10335537899997, 0.61036752590193, 10.25, 
    464051.167173066, 464051.167173066, 373972.220852227, 206878.494039255, 
    47352.159915619, 47352.159915619, 38160.4306992069, 21110.0504121689, 
    1.18842844836931, 1.20690088255361, 0.957737546202284, 0.529812885009638, 
    0.138696836914708, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.15, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.177667263629678, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.1263157894737, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0673161800920783, 5952415.65447242, 
    3982641.84887815, 5261145.56416457, 4658980.66484553, 578318.128590264, 
    381760.212794887, 511001.246019281, 452753.617693582, 8.68903180640859, 
    5.8041787427812, 7.67761870200986, 6.80246803640027, 10.2032, 
    2107284.74884825, 1751553.13218524, 1873211.09774277, 1637507.29108607, 
    205547.670377995, 169638.194200193, 182713.976330327, 159242.320062844, 
    3.01559162472929, 2.31856974765408, 2.67837699271608, 2.31222155579138, 
    0.0860244825062293, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.56, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.33596536618041, 32097927.3019743, 
    28970781.5605925, 25628357.7015626, 17646574.5830419, 3098327.87387682, 
    2792788.73791019, 2472803.55991134, 1712128.92786878, 8.3955227555005, 
    7.67461406343353, 6.70054280960961, 4.63934675715488, 10.1859375, 
    9200496.09546694, 8759060.3291953, 7293446.66342885, 4510439.98611592, 
    845812.192022949, 805353.711425124, 670404.921417564, 419690.589756086, 
    2.20308900733341, 2.1305354318275, 1.74765431346952, 1.08826046406314, 
    0.0634144625231997, 29221908.8623045, 28994632.6001681, 23495800.136807, 
    13196230.7516395, 2976826.94048525, 2951574.02247009, 2393832.3007165, 
    1343424.1125727, 26.7048667925405, 27.016408962628, 21.4748703879622, 
    12.0517459326315, 10.2333333333333, 9489618.44519874, 9399276.24991024, 
    7652057.20329698, 4263522.61997562, 978801.890512869, 967909.041088606, 
    789327.910234503, 439478.684391137, 7.76374101397991, 7.88142263271598, 
    6.27184600166249, 3.47623063776799, 0.121796767913655, 3725595.6006477, 
    3725595.6006477, 2953756.50635454, 1646671.64767726, 364664.980197737, 
    364664.980197737, 289246.337592679, 161224.989408276, 9.61253504062809, 
    9.78158927948019, 7.62450661967958, 4.24987576068201, 10.4921052631579, 
    1908748.02103903, 1908748.02103903, 1513842.12932116, 844348.446077912, 
    188190.825524982, 188190.825524982, 149338.949503258, 83272.098508672, 
    4.08653627720286, 4.15468653968781, 3.25345547271879, 1.81315134105948, 
    0.160744430461514, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.9, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 382103.849253367, 
    382103.849253367, 300734.201900582, 222911.44870283, 37461.1616915066, 
    37461.1616915066, 29483.7452843707, 21854.0635983166, 2.67310520544479, 
    2.7158821561349, 2.10386302605049, 1.5594340518817, 10.4631578947368, 
    382103.849253367, 382103.849253367, 300734.201900581, 222911.44870283, 
    37461.1616915066, 37461.1616915066, 29483.7452843707, 21854.0635983166, 
    3.02931239368978, 3.07812508475471, 2.38421530378186, 1.76723792647026, 
    0.179023835379752, 18325429.522914, 18028977.492266, 16543761.3877891, 
    12191648.1653803, 1796328.18439525, 1767546.43384691, 1621798.16553778, 
    1194417.90115378, 18.2696864194416, 18.3073967868887, 16.4946161716969, 
    12.1479141158126, 10.1611111111111, 8136348.85370481, 8137583.37255576, 
    7359922.71558027, 5316385.17103121, 806886.494838769, 807010.015668584, 
    729937.553044818, 526878.048217329, 7.34834159892906, 7.50389859074089, 
    6.64996473466124, 4.77382633808472, 0.130848207846765, 3356610.1991898, 
    3356610.1991898, 2583413.12802036, 2022427.08241137, 323737.904572186, 
    323737.904572186, 249170.912098215, 195367.711571757, 7.67032015333982, 
    7.80850536117745, 5.90360486585175, 4.62884597143795, 10.4744186046512, 
    1811159.34808223, 1811159.34808223, 1394778.7899536, 1104474.77102487, 
    177078.385283548, 177078.385283548, 136380.522970022, 108268.673712191, 
    3.86909722281777, 3.93993521853643, 2.97822890839198, 2.35583367527132, 
    0.187786191146739, 58341308.4500679, 57817580.1572835, 48447522.8705594, 
    31320620.1814251, 5834338.66073849, 5780303.99217499, 4841126.6835313, 
    3120244.45890804, 16.8643881232679, 17.0221864800299, 13.9934693702965, 
    9.01919080368239, 10.2861111111111, 12795356.4298065, 12709189.8601685, 
    10801134.376441, 6997581.11257371, 1296280.30462598, 1286391.15820543, 
    1092168.4341585, 702731.226216708, 3.56701065626028, 3.61918415529128, 
    3.01242873231012, 1.93009794604841, 0.0847154458654687, 1316666.25051296, 
    1316666.25051296, 1041195.77250982, 668598.281197344, 123052.920608688, 
    123052.920608688, 97308.0161224128, 62485.8206726489, 44.6678852217276, 
    45.762303441233, 35.3225528805782, 22.6821878910713, 10.4363636363636, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    123052.920608688, 123052.920608688, 97308.0161224128, 62485.8206726489, 
    26.5306835300096, 27.4720880065798, 20.9799829854224, 13.4721835546741, 
    0.155339571388783, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.5, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.91771055403855e-07, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 10.8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 1.21667471666295e-07, 3594585.19592882, 3594585.19592882, 
    3235123.87056896, 2477219.37753743, 332831.962586002, 332831.962586002, 
    299548.506534163, 229372.164586799, 101.265777323185, 103.771487396284, 
    91.1391205474834, 69.7876200431978, 10.8, 3594585.19592882, 
    3594585.19592882, 3235123.87056896, 2477219.37753743, 332831.962586002, 
    332831.962586002, 299548.506534163, 229372.164586799, 33.8765271253328, 
    35.5737430535069, 30.4888479703491, 23.3461122394854, 1.12642190757164e-07, 
    1811827.90701659, 1811827.90701659, 1401852.21692864, 1037164.87010638, 
    167761.843242277, 167761.843242277, 129801.131197096, 96033.7842691089, 
    7.66357201340561, 7.7899061401349, 5.92947893946228, 4.38694405856831, 
    10.4958333333333, 1811827.90701659, 1811827.90701659, 1401852.21692864, 
    1037164.87010638, 167761.843242277, 167761.843242277, 129801.131197096, 
    96033.7842691089, 7.90726309258865, 8.04765332560717, 6.11802823726011, 
    4.52644286279147, 0.235301368434735, 6723079.35345837, 6723079.35345837, 
    5678171.86000741, 4182982.52884115, 623646.726436967, 623646.726436967, 
    526657.653853672, 387891.769528557, 21.0911899998696, 21.4585721363328, 
    17.8111039013624, 13.1181623565201, 10.5457142857143, 5551495.81216955, 
    5551495.81216955, 4742162.00916957, 3570777.42056449, 514287.608987023, 
    514287.608987023, 439278.884033358, 330730.610091939, 16.0854770049392, 
    16.4165628478359, 13.7393378427446, 10.3462538821149, 0.164298155380745
    ), .Dim = c(13L, 2L, 7L, 3L, 2L)))
              result[["Log"]] <- NULL
              result[["Log"]] <- NULL
              reference[["Log"]] <- NULL
              testthat::expect_equal(result, reference)


})

test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.bwi12", {
  result <- iVB.ew.bagrupp.akl.dkl.stratum.fun.bwi12(
    get_data("baeume.12"), get_data("baeume.2"),
    list(bagr.lab = c("alle Baumarten"), bacode = list(c(10:299))),
    list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
    list(Wa = c(1:3), Begehbar = c(1)), get_design("a", 1)
  )
  reference <- list(Log = list(Datum = structure(1524130845.26895, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1), HBF = 858039.12, se_HBF = 30909.6515812594, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J", 
    "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J", 
    "V_EoR/ha/J", "oiB/ha/J"), Größen = c("Wert", "Standardfehler"
    ), BAGR = "alle Baumarten", AKL = "0-500", DKL = "0-400", 
    iVB.bagr.akl.dkl = structure(c(163503646.418157, 156504147.449057, 
    132134968.353139, 84265808.7772924, 11553196.9325707, 11059405.8811184, 
    9336133.13269424, 5964704.72882491, 13.5192024940656, 13.3768608212537, 
    10.924861323589, 6.97971752034801, 854576.809367424, 826756.44375, 
    14.2421052631579, 90, 10403430.6021151, 10247068.2258989, 
    8473915.03110738, 5362098.92385475, 750696.207313107, 739378.951449026, 
    610331.811616922, 390179.561210823, 0.733025247377116, 0.764037020529381, 
    0.596184441817989, 0.373904964320081, 31051.5654606426, 30045.8699153233, 
    0.0967635299847044, NA), .Dim = c(16L, 2L, 1L, 1L, 1L)), 
    VB.A.bagr.akl.dkl = structure(c(145456546.007399, 137071583.019799, 
    115702055.587573, 73690242.5892995, 10191614.1780867, 9600982.64429291, 
    8107373.1528599, 5171086.44714829, 11.925919433305, 11.6128307397821, 
    9.48700346650075, 6.0510493503516, 14.2715170278638, 17989237.7956065, 
    17471012.4933591, 14385383.2887411, 8733516.37803129, 1281152.52133769, 
    1246629.29614107, 1024113.01235424, 621690.806890441, 1.4354537486358, 
    1.44946128071602, 1.14388764150576, 0.682920737800067, 0.0972281243895618
    ), .Dim = c(13L, 2L, 1L, 1L, 1L)))
  result[["Log"]] <- NULL
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

  result <- iVB.ew.bagrupp.akl.dkl.stratum.fun.bwi12(
    get_data("baeume.12"), get_data("baeume.2"),
    list(bagr.lab = c("alle Baumarten"), bacode = list(c(10:299))),
    list(A.ob = 500, A.b = 500), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = T),
    list(Wa = c(1:3), Begehbar = c(1)), get_design("a", 1)
  )
  reference <- list(Log = list(Datum = structure(1524131057.99052, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 1:3, Begehbar = 1), HBF = 858039.12, se_HBF = 30909.6515812594, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "V_DhmR/J", 
    "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "V_DhmR/ha/J", "V_DhmR_HB/ha/J", 
    "V_EoR/ha/J", "oiB/ha/J"), Größen = c("Wert", "Standardfehler"
    ), BAGR = "alle Baumarten", AKL = "0-500", DKL = c("-400--0.1", 
    ">=400", "400-799.9"), iVB.bagr.akl.dkl = structure(c(1606382.41094549, 
    1382933.99676872, 1124494.66306303, 1435046.85313196, 113082.022988258, 
    97289.2818311767, 79150.0401096303, 100727.939021069, 1.12548379828598, 
    1.0015981150595, 0.787765247057215, 1.0025259577707, 100474.145572306, 
    97134.050442375, 14.2217228464419, 75, 577593.687773298, 
    560982.436925584, 406897.751019448, 462440.875180962, 40774.6058181584, 
    39610.1290481608, 28707.0311355358, 32328.7467837182, 0.392040966224781, 
    0.38281066823497, 0.276474578248762, 0.295142319320967, 19266.5322169762, 
    18630.9221594689, 0.101311971066377, NA, 161897264.007212, 
    155121213.452289, 131010473.690076, 82830761.9241604, 11440114.9095825, 
    10962116.5992872, 9256983.0925846, 5863976.78980384, 15.1705005947183, 
    15.0243697285554, 12.2754944877103, 7.77609876126498, 754102.663795118, 
    729622.393307625, 14.2576802507837, 89, 10286856.1887972, 
    10116291.3107544, 8395992.0040997, 5296483.80036305, 741954.539286788, 
    729692.062296091, 604442.227315958, 385371.154969968, 0.798018384078164, 
    0.829699278459267, 0.642008647271307, 0.406043261932553, 
    32320.035257875, 31236.3711121031, 0.096692151022623, NA), .Dim = c(16L, 
    2L, 1L, 1L, 2L)), VB.A.bagr.akl.dkl = structure(c(0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 14.2483146067416, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0.10245272724622, 145456546.007399, 
    137071583.019799, 115702055.587573, 73690242.5892995, 10191614.1780867, 
    9600982.64429291, 8107373.1528599, 5171086.44714829, 13.5148895069487, 
    13.1588376842005, 10.7510204407163, 6.85727115870953, 14.2887147335423, 
    17989237.7956065, 17471012.4933591, 14385383.2887411, 8733516.37803129, 
    1281152.52133769, 1246629.29614107, 1024113.01235424, 621690.806890441, 
    1.69430453677608, 1.70295350297995, 1.34937942961697, 0.809111369399737, 
    0.0968873782847206), .Dim = c(13L, 2L, 1L, 1L, 2L)))
  result[["Log"]] <- NULL
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

})

test_that("iVB.ew.bagrupp.akl.dkl.stratum.fun.2g", {
              f  <- iVB.ew.bagrupp.akl.dkl.stratum.fun.2g
              result <- f(
                          get_data("baeume.23"), get_data("baeume.3"),
                          list(
                               bagr.lab = c("Fichte", "Tanne"),
                               ba.grupp = list(c(10), c(30))
                               ),
                          list(A.ob = 160, A.b = 20), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F),
                          list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
                          )
              reference <- list(Log = list(Datum = structure(1524131406.79033, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), HBF = 884849.13, se_HBF = 26933.7163569886, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "G", 
    "V_DhmR/J", "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "G/J", "V_DhmR/ha/J", 
    "V_DhmR_HB/ha/J", "V_EoR/ha/J", "oiB/ha/J", "G/ha/J", "mBAF_mLK", 
    "mBAFoLK", "mPL", "nT"), Größen = c("Wert", "Standardfehler"
    ), BAGR = c("Fichte", "Tanne", "Alle BA"), AKL = c("1-20", 
    "21-40", "41-60", "61-80", "81-100", "101-120", "121-140", 
    "141-160", ">160"), DKL = "0-400", iVB.bagr.akl.dkl = structure(c(2391074.67549267, 
    2391074.67549267, 1686501.48298991, 1253578.39415747, 349561.538880035, 
    229724.766021695, 229724.766021695, 161939.247599799, 120194.929621338, 
    33529.3230297664, 4.40623776791369, 4.4607905933742, 3.10607707318058, 
    2.30539983816656, 0.643109456698206, 52136.2618455489, 51498.6662595, 
    10.0414414414414, 30, 1294523.7156053, 1294523.7156053, 938509.249815871, 
    675537.167481855, 184440.061979743, 123769.063952986, 123769.063952986, 
    89589.5188303419, 64429.9463654374, 17622.0919705002, 2.05949559550806, 
    2.08076697924967, 1.50877466864207, 1.07009776290851, 0.285299038214341, 
    16151.1576984052, 15929.8464501732, 0.124225966679478, NA, 
    242794.59892886, 242794.59892886, 183889.431937306, 107160.601065544, 
    26330.5648912416, 24279.459892886, 24279.459892886, 18388.9431937306, 
    10716.0601065544, 2633.05648912416, 8.59299684234438, 8.70524104150001, 
    6.50822264971705, 3.79263258178884, 0.931892480169534, 2825.49386882609, 
    2789.0623335, 10.1217391304348, 13, 242794.59892886, 242794.59892886, 
    183889.431937306, 107160.601065544, 26330.5648912416, 24279.459892886, 
    24279.459892886, 18388.9431937306, 10716.0601065544, 2633.05648912416, 
    7.87864338358833, 7.93802903872362, 5.96718074716802, 3.47734325347895, 
    0.854422346220755, 1489.77287905724, 1462.16324084914, 0.199081211015896, 
    NA, 6752343.88109245, 6601475.58834183, 4761545.58674608, 
    4622818.37437701, 883904.370183647, 663050.05600362, 646286.912364662, 
    467632.497363508, 456687.774463844, 86500.0972641128, 4.72879049040447, 
    4.65295802412392, 3.33509677966844, 3.25704037789391, 0.616907929737608, 
    140215.570418918, 138898.074948, 10.255593220339, 84, 1998515.76539129, 
    1997854.92278351, 1416998.51223318, 1345747.5240516, 268604.541314572, 
    193853.430822207, 193693.093088764, 137551.120926469, 131814.561013903, 
    25965.2069894341, 1.07684689380115, 1.07926154419309, 0.763108958892724, 
    0.729738401752327, 0.135699500276882, 27650.3485659486, 27308.9830931435, 
    0.0720779834991265, NA, 17047467.688815, 16105733.334322, 
    13764151.107228, 7666028.95559144, 1447836.29342588, 1746991.12886251, 
    1652584.11217009, 1411475.45472157, 785081.803667861, 147808.688913825, 
    22.6310429246249, 21.771654164595, 18.2846730444802, 10.1701832966478, 
    1.91475773870663, 77194.4596049348, 75905.3078685, 10, 13, 
    5388393.2192747, 5095319.80109243, 4392040.5684367, 2414898.26188865, 
    446149.826446617, 553281.762466594, 523833.163505411, 451212.560977387, 
    247779.376512843, 45557.9218417422, 2.52755999564122, 2.28180817237563, 
    2.11461759635387, 1.09937099291231, 0.182254532894384, 23602.577710417, 
    23208.5905453442, 0.183369092544011, NA, 3312244.3897663, 
    3245650.11241295, 2629231.25085388, 1456109.30299663, 274235.816280284, 
    326237.283919724, 319577.856184389, 258909.469891421, 143389.159873193, 
    27016.2374775538, 18.9746113334525, 18.9835320959627, 15.058691338752, 
    8.33979962478353, 1.5713182738334, 17193.3579131902, 16834.478145, 
    10.0333333333333, 3, 2595091.29833061, 2584794.90654957, 
    2084051.85083017, 1153085.61335636, 212300.832620285, 254638.353070441, 
    253587.615106834, 204475.891466778, 113132.450961877, 20832.9617767758, 
    5.81227829891866, 6.02609872135782, 4.81905396064143, 2.63741027274089, 
    0.450229634764937, 10712.1686709916, 10506.2125795887, 0.036185497070948, 
    NA, 25795881.657727, 23595012.8967804, 20585159.4271001, 
    12796639.5726228, 2239105.82917513, 2612547.93501472, 2395046.0308953, 
    2086850.47885408, 1292558.00543847, 226073.628442274, 19.6365916660236, 
    18.2842111452862, 15.685312476792, 9.7152030848009, 1.69922835431239, 
    133044.877616674, 130989.847572, 10.1960396039604, 31, 6279897.57919011, 
    5947731.72504363, 5100854.37841743, 2947117.41411614, 515823.534823482, 
    640712.023080766, 606980.164011656, 520742.422160401, 300346.817653518, 
    52392.609191474, 2.12358968389448, 1.90927685056822, 1.77647076339117, 
    0.990349322849053, 0.164884472321764, 29211.1709108182, 28735.3958701998, 
    0.112132464955512, NA, 12834082.1172679, 12558754.7843982, 
    10328173.2133269, 5601265.33681743, 795496.353960922, 1233795.74974101, 
    1208028.21690215, 992373.429245042, 539014.339970322, 76742.3101329607, 
    18.7683590174315, 18.69462515256, 15.0958704496594, 8.19942413501623, 
    1.16739519381942, 65738.0727103043, 64619.012526, 10.2846153846154, 
    15, 4496456.98677789, 4437307.96245157, 3617410.34050788, 
    1950590.57097274, 277373.121640257, 426015.241567852, 420690.599604195, 
    342484.980068859, 184944.656352995, 26349.3826678969, 2.31305540496335, 
    2.34411910828445, 1.8348128826526, 0.972656844799484, 0.1479911835939, 
    20727.267440634, 20376.4323429585, 0.206080721824215, NA, 
    2332255.5562827, 2332255.5562827, 1889425.5213581, 1034065.33935132, 
    162663.812676846, 229079.451283324, 229079.451283324, 185556.838256645, 
    101528.251355242, 15992.8462833436, 18.8741823808365, 19.0899793101182, 
    15.2882922830811, 8.36505728537052, 1.31767339169667, 12137.185424038, 
    11999.984262, 10.2, 4, 1453076.4109285, 1453076.4109285, 
    1168915.72535814, 643939.32812627, 96321.8062498305, 139978.802990954, 
    139978.802990954, 112608.389827966, 62006.6036308391, 9321.29557891174, 
    8.57362427259052, 8.61121811447737, 6.7946851314838, 3.79076234456618, 
    0.556433649840891, 6520.95985833661, 6434.7952097917, 0.360946555596131, 
    NA, 22518334.2886302, 21664383.3863359, 18056144.4281781, 
    11053289.454655, 1462783.97582768, 2177040.3738076, 2096092.6699746, 
    1742685.00905546, 1068612.49866518, 141583.376013527, 15.6640138348956, 
    15.3166208376707, 12.5387854171796, 7.68876919538153, 1.0187059401146, 
    138983.557902489, 136850.8558245, 10.3040816326531, 30, 5306158.54096391, 
    5247118.69745806, 4197586.22667146, 2451643.14738752, 330254.526347647, 
    507255.986322036, 501953.72913485, 399912.688193291, 234816.140049002, 
    31569.6575616312, 1.81396258288192, 1.86080607779366, 1.39151137665, 
    0.771205151433106, 0.105841441452296, 29360.2766408784, 28882.7089224127, 
    0.133549995318539, NA, 6306364.65303104, 6219021.63974456, 
    5092553.13847073, 2797129.21014564, 375672.570303302, 618576.43396997, 
    610636.160034835, 499499.929905253, 274978.413784691, 37002.5904799456, 
    15.8614251937804, 15.9020782162264, 12.8080869839205, 7.05094682019848, 
    0.948813741750534, 38998.7927574457, 38399.770881, 10.2882352941176, 
    10, 2626065.75821748, 2597580.31087454, 2132652.64176113, 
    1150872.01972439, 149857.10033714, 255338.675483107, 252933.521618649, 
    207268.698347338, 112479.505787164, 14739.3150821994, 1.64087206382882, 
    1.59203177517802, 1.34405873125147, 0.691100666909126, 0.0906350832039918, 
    16373.0836427549, 16108.4520763466, 0.2382078979313, NA, 
    1558863.99908778, 1515076.56976929, 1194119.7791402, 673330.075899648, 
    68037.9995161064, 149036.754050813, 144982.362447249, 114070.913195356, 
    64332.0535405488, 6429.82007368989, 15.5922344055912, 15.4486964372889, 
    11.9341059776129, 6.73042341122973, 0.672688172882288, 9558.39619736413, 
    9384.7635, 10.5428571428571, 6, 1009419.52952343, 1009133.62646663, 
    770994.191857809, 430945.912664431, 49723.8907232717, 96026.4869744781, 
    96002.7247811445, 73271.246196565, 40973.3475726345, 4689.24037243382, 
    10.5219679658196, 10.4870150807235, 8.01815130101226, 4.50301614406146, 
    0.493679223018473, 5357.95554833856, 5224.2979815171, 0.15417075730525, 
    NA, 14091541.7789773, 13690314.4695151, 11567991.183824, 
    7576252.11295067, 864770.906291539, 1379500.57431819, 1339886.36265193, 
    1131309.3425593, 742470.925642112, 84643.6587193913, 14.1251351387445, 
    13.9475585818877, 11.5838279772173, 7.60239057273824, 0.866692729461238, 
    97662.8230999565, 96066.014334, 10.2549019607843, 28, 3583491.24081569, 
    3541154.48984026, 2960314.69058977, 1922374.49595581, 208051.554600287, 
    346368.365486296, 342667.347172916, 285710.801524555, 186031.845893899, 
    20223.8454893618, 1.73193887748288, 1.73358321499726, 1.42023859088297, 
    0.953611180998547, 0.0919661468663043, 22793.1933694342, 
    22404.6746491643, 0.121174654329416, NA, 7419292.64263111, 
    6165560.51374081, 6043638.75221566, 3392205.70081125, 448386.823307874, 
    734017.292332615, 607037.917422527, 597789.113096563, 335499.480284842, 
    44338.2373267707, 15.3981012782548, 13.0095228009764, 12.5403275953448, 
    7.03805622863564, 0.930120687875482, 47669.3378662989, 46661.044122, 
    10.2545454545455, 12, 2322931.95807485, 2069678.37892225, 
    1893852.94386554, 1064690.45622364, 141674.06685857, 228214.968774715, 
    201515.394902323, 185871.74687851, 104600.264966278, 13923.1502650246, 
    2.58516979621238, 2.76826226640314, 2.1083441768668, 1.15536420636211, 
    0.147286458327446, 13896.4802403142, 13603.8626890217, 0.165851785071856, 
    NA, 1422266.43342572, 1422266.43342572, 1126232.7899378, 
    636832.089839481, 82695.3906922505, 137110.487370652, 137110.487370652, 
    108653.809796828, 61379.0592397385, 7947.74936377981, 17.4408341576373, 
    17.814886169921, 13.8210658688649, 7.80758652004626, 1.01097575567237, 
    7861.46385725544, 7696.399857, 10.1733333333333, 5, 937510.718978186, 
    937510.718978186, 736338.49977741, 419453.820291701, 55682.1280993357, 
    89140.7835749428, 89140.7835749428, 70060.8607709948, 39873.6284376269, 
    5284.71399533562, 2.26875119968563, 2.31465480916265, 1.6602063560395, 
    1.05507066583916, 0.161860860542385, 5054.59243246139, 4947.04176670475, 
    0.254658161854144, NA, 16300794.8957923, 15013519.4117563, 
    13419073.6758353, 8820015.28668942, 929793.745436776, 1591629.66652546, 
    1461114.01938099, 1310564.74953242, 859074.392237619, 90537.766927494, 
    14.4868523704278, 13.5659562805433, 11.9286279011182, 7.8192082978257, 
    0.824065604588824, 109867.183417598, 107704.4617545, 10.4175824175824, 
    27, 5349013.8971585, 5138196.00628317, 4476568.59837624, 
    3218691.87456312, 250409.153110003, 512037.661324223, 491113.575856246, 
    428111.053670103, 306824.484485802, 24067.3807009312, 3.18428722264291, 
    3.1899954771984, 2.71525617374063, 2.04144527286228, 0.122760259766991, 
    22606.2855174831, 22177.396573067, 0.106313611932145, NA, 
    2263867.68703122, 2263867.68703122, 1843617.73046542, 967412.076626677, 
    119911.869411749, 220871.610517835, 220871.610517835, 179938.641480171, 
    94430.4518956204, 11676.6592822384, 6.04711193464995, 6.16502455669932, 
    4.92643261779257, 2.58535495491524, 0.319688281970324, 36525.1400841848, 
    35826.558108, 10.4, 8, 1082344.12507754, 1082344.12507754, 
    879930.797296785, 458298.588783317, 57559.0934514455, 104395.166816356, 
    104395.166816356, 84897.9730418228, 44299.223787751, 5575.01477675497, 
    1.68164287533841, 1.70113144950598, 1.35578831782543, 0.696483687663301, 
    0.0930913382994414, 15206.676639706, 14931.5716650656, 0.133010187577499, 
    NA, 2612919.61777649, 2612919.61777649, 2070923.41568407, 
    1121363.51042288, 144796.202582413, 255083.775953488, 255083.775953488, 
    202216.181885309, 109197.765452456, 14041.5736435248, 14.9281367737145, 
    15.1299690201422, 11.8341937261923, 6.39052472845431, 0.821747800639993, 
    17087.4490112283, 16859.504181, 10.6952380952381, 6, 1536089.06300151, 
    1536089.06300151, 1219723.13375759, 641751.70236586, 81535.0088487146, 
    153704.778610226, 153704.778610226, 122076.499053129, 63993.4235353725, 
    8054.86161839425, 2.17600694650223, 2.21033341220392, 1.72714532222123, 
    0.944229121699134, 0.156321767443304, 10114.2760500498, 9966.60405400827, 
    0.208064342034062, NA, 9902428.59712367, 10017551.9659907, 
    8326700.88959859, 5261489.0499212, 539515.838886495, 957977.582864072, 
    969186.839747563, 806359.866122682, 509609.64202284, 52203.7611682038, 
    7.88291025801362, 8.1125805353398, 6.63529353297081, 4.19342492615978, 
    0.429569096167585, 121525.877056663, 119467.145568, 10.4571428571429, 
    26, 2430604.54106388, 2458370.20142995, 2030194.23549468, 
    1293576.95980312, 133669.915810852, 235675.987742046, 238384.881001432, 
    196642.859975242, 124076.757678088, 12848.5004241554, 1.13981087572573, 
    1.17133244993447, 0.940146494698205, 0.589353781842704, 0.0624152898235024, 
    26033.4828077344, 25603.7890076916, 0.132277517216761, NA, 
    2614961.40900453, 2611095.00326527, 2143853.01782398, 1130288.0524537, 
    138996.678595767, 267872.875410827, 267443.274773132, 219625.944123802, 
    115859.322158839, 14229.8656481912, 11.6363541643355, 11.8219289251862, 
    9.54051531190535, 5.03291012131195, 0.618143050651598, 23020.3439692337, 
    22622.642757, 10.4769230769231, 7, 1419430.79503076, 1416906.86505603, 
    1157705.05561355, 610632.586274042, 74311.638316429, 148128.229208792, 
    147828.942488189, 121002.936164541, 63918.3107714946, 7783.19399596327, 
    1.73800682651279, 1.75742663412788, 1.45066385870739, 0.744183795726878, 
    0.0876586893674529, 12285.3332952831, 12080.7415290415, 0.312410096618915, 
    NA, 1629663.01498817, 1629663.01498817, 1286736.78422315, 
    731573.500471668, 90530.1790775896, 149773.686422614, 149773.686422614, 
    118291.698750316, 67219.5887713737, 8321.00536298831, 13.1651141686449, 
    13.4541961137318, 10.397845953104, 5.90860505394408, 0.731416767645955, 
    11376.5581144239, 11132.117085, 10.92, 5, 1070183.63800976, 
    1070183.63800976, 852274.50071877, 483011.132362123, 62325.9169709117, 
    98780.5063611661, 98780.5063611661, 78689.0021281181, 44579.8727396144, 
    5756.22573143095, 2.67586208917276, 2.71476697100547, 2.14635220770453, 
    1.22034842258843, 0.166746081879441, 6545.41032065837, 6403.56906951206, 
    0.146059348668036, NA, 6991302.32741352, 6987435.92167426, 
    6119375.70879499, 3601342.03697123, 411166.704518876, 688611.619078658, 
    688182.018440963, 603127.649857468, 354790.887041745, 40485.2292584537, 
    9.1692612719912, 9.3296496536047, 8.03099286838122, 4.72424549640902, 
    0.539084201373055, 75100.0106390381, 73762.9004295, 10.44, 
    17, 2271450.36838318, 2269949.31461198, 2016233.79482682, 
    1125887.21008469, 124906.298324661, 225381.738757468, 225193.258384243, 
    200270.118636889, 111613.778170307, 12377.0417413394, 1.38869389313149, 
    1.41266627420877, 1.48041720237766, 0.642127215462905, 0.058008115644283, 
    20276.0022077472, 19932.8453282484, 0.207168934573451, NA, 
    506298.067936819, 506298.067936819, 409140.059708364, 237633.744875857, 
    33564.0097018546, 47903.032968614, 47903.032968614, 38708.2308514995, 
    22489.613431582, 3176.18611790028, 11.2540761310837, 11.568223687385, 
    9.09389969498924, 5.28358657130325, 0.746195765949955, 4256.50514628261, 
    4140.915171, 10.5818181818182, 3, 341728.126624759, 341728.126624759, 
    272250.972377669, 167011.581612634, 25166.7720608238, 32261.1869087795, 
    32261.1869087795, 25700.3791759647, 15769.9424678525, 2375.99928762875, 
    1.8298369860437, 1.84330181257854, 1.60068600793599, 0.708142696025579, 
    0.0859859017522293, 3225.88398529191, 3127.47206252007, 0.220985909383427, 
    NA, 333724.800330302, 333724.800330302, 269356.452185785, 
    187660.585465569, 18471.0934132341, 30338.6182118456, 30338.6182118456, 
    24486.9501987077, 17060.0532241426, 1679.19031029401, 18.832987900134, 
    19.0482053087059, 15.2005089217738, 10.5901914748534, 1.04237347182285, 
    1610.92962904891, 1592.728434, 10.9, 2, 333724.800330302, 
    333724.800330302, 269356.452185785, 187660.585465569, 18471.0934132341, 
    30338.6182118456, 30338.6182118456, 24486.9501987077, 17060.0532241426, 
    1679.19031029401, NaN, NaN, 1.71055846383819e-07, 1.24094876557872e-07, 
    NaN, 1610.92962904891, 1592.728434, 0.0710669054518899, NA, 
    4741908.57968547, 4133610.40640992, 3821483.60503837, 2759565.92616467, 
    210612.589515778, 458844.120523291, 398014.303195736, 368261.816126762, 
    267354.075989416, 20358.3225116138, 11.6271771153847, 10.3005240004129, 
    9.33180827522826, 6.77479138340873, 0.515882869643616, 39463.0713861033, 
    38640.199584, 10.5294117647059, 13, 1920361.86885687, 1587947.38814699, 
    1442195.21374328, 1133257.85026994, 80229.3710289501, 188319.540102625, 
    154218.227870786, 140096.090202816, 111038.22262242, 7828.98217665414, 
    1.88117837339288, 1.22082589521115, 0.966499195348647, 1.05341203050788, 
    0.0713413077930795, 13444.2227848404, 13187.7278783247, 0.182141864454003, 
    NA, 324398.377039459, 324398.377039459, 267164.10717868, 
    131200.092117574, 19282.0262619474, 29934.7002382877, 29934.7002382877, 
    24639.3487019914, 12146.5535492077, 1789.16175221584, 10.866217134681, 
    11.1324528418398, 8.94401851101594, 4.40916686163786, 0.649460991220389, 
    2754.8409779837, 2688.9581895, 10.5818181818182, 3, 232933.245203445, 
    232933.245203445, 193072.194361287, 92333.6973546429, 13629.1072605723, 
    21421.8532220582, 21421.8532220582, 17738.277623815, 8545.64340660511, 
    1267.09328830496, 2.93890804987776, 2.93960737822178, 2.60297574255426, 
    0.695098110412408, 0.0651732259646401, 1835.44594362468, 
    1789.28616513626, 0.220985909383427, NA, 136578.837037062, 
    136578.837037062, 115677.081613538, 62440.8331235108, 4529.47620899025, 
    12416.2579124602, 12416.2579124602, 10516.0983285035, 5676.43937486462, 
    411.770564453659, 23.3010668034124, 23.5652950750519, 19.7351175685397, 
    10.6527340211342, 0.772752426508868, 532.862208293478, 526.8874365, 
    11, 1, 136578.837037062, 136578.837037062, 115677.081613538, 
    62440.8331235108, 4529.47620899025, 12416.2579124602, 12416.2579124602, 
    10516.0983285035, 5676.43937486462, 411.770564453659, NaN, 
    NaN, NaN, 1.52570186845145e-07, NaN, 532.862208293478, 526.8874365, 
    NaN, NA, 3295150.51524556, 3295150.51524556, 2766553.67981725, 
    1737745.54906136, 138244.427561578, 304069.214279263, 304069.214279263, 
    255560.81875241, 160206.805826934, 12706.2387612749, 10.2833564253835, 
    10.4624796258096, 8.6428446688465, 5.41805486621054, 0.429713946273464, 
    29569.0630277772, 29062.8249855, 10.6685714285714, 9, 1176899.02573341, 
    1176899.02573341, 1031487.35999045, 620275.595318577, 48217.0441855282, 
    106993.551297085, 106993.551297085, 94410.2745444025, 56317.9609898109, 
    4380.20981242287, 1.66734969020068, 1.69310789773542, 1.69826531788661, 
    0.765677118713801, 0.061970667675652, 10675.2359338299, 10490.9288786009, 
    0.189435659534734, NA), .Dim = c(19L, 2L, 3L, 9L, 1L)), VB.A.bagr.akl.dkl = structure(c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.0405405405405, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.106771598748818, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.195652173913, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.179347242746652, 
    199984.832941677, 199984.832941677, 140330.268358303, 249136.508166555, 
    59099.376430081, 20200.488175927, 20200.488175927, 14174.7745816468, 
    25165.3038552076, 5969.63398283646, 0.144067367950467, 0.145433895923248, 
    0.101092728427358, 0.179475815560439, 0.0425746867127605, 
    10.2077966101695, 199984.832941677, 199984.832941677, 140330.268358303, 
    249136.508166555, 59099.376430081, 20200.488175927, 20200.488175927, 
    14174.7745816468, 25165.3038552076, 5969.63398283646, 0.138947819443004, 
    0.140315964176212, 0.0975003179162305, 0.17309799970422, 
    0.0410617613576518, 0.0630605930800826, 7948342.27569383, 
    7948342.27569383, 6108128.0122294, 4322605.03693823, 1084210.12559878, 
    826531.221122707, 826531.221122707, 634734.549793608, 450249.444984214, 
    113391.533102899, 10.7071313842045, 10.8889779164668, 8.22254023205872, 
    5.83266528826676, 1.46890766103181, 10.0309523809524, 2981210.96975089, 
    2981210.96975089, 2285274.65469812, 1630310.68782677, 425711.898139759, 
    317808.299588429, 317808.299588429, 243105.290771265, 174791.624055141, 
    46018.7823780042, 3.09082775132459, 3.15173680158103, 2.35778203199995, 
    1.7052690482494, 0.466145198062036, 0.171557700782197, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.0833333333333, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.126649239748664, 
    9039578.62138326, 8321690.43974731, 7021541.55285696, 5134028.56923882, 
    1261811.7069763, 937803.916901873, 864550.020816572, 727874.450478063, 
    533104.197252204, 131516.63492575, 7.04877883088332, 6.60012998596218, 
    5.47089420890897, 4.00695018705021, 0.988513329349464, 10.1277227722772, 
    3212380.39283811, 3047275.75154993, 2483544.76791203, 1839597.00401772, 
    462467.368386189, 340520.307568628, 324369.763704787, 262618.189907534, 
    195295.131860617, 49589.5589619303, 2.0282591774068, 2.02100494803027, 
    1.55194635717192, 1.16794085137783, 0.307259244920438, 0.0917818684587265, 
    5591203.2006302, 5591203.2006302, 4461242.90159191, 2450812.47183489, 
    415767.810808691, 513835.595380373, 513835.595380373, 409958.899391008, 
    225741.699323441, 38256.6858804121, 7.81640796870867, 7.95177108553967, 
    6.23624761860029, 3.43395676228969, 0.58195630481901, 10.2346153846154, 
    3263986.41362229, 3263986.41362229, 2606427.46536244, 1395162.77765283, 
    234023.625666007, 292015.367997185, 292015.367997185, 233173.322579575, 
    125060.28652364, 20966.1750211287, 3.95526795988633, 4.02252581595344, 
    3.1594788523658, 1.67682164154727, 0.278730142773863, 0.188555740688587, 
    464051.167173066, 464051.167173066, 373972.220852227, 206878.494039255, 
    41184.6112170779, 47352.159915619, 47352.159915619, 38160.4306992069, 
    21110.0504121689, 4202.51134868141, 3.90141192222677, 3.94601850150485, 
    3.14409225582309, 1.73928713080051, 0.346250897704687, 10.1714285714286, 
    464051.167173066, 464051.167173066, 373972.220852227, 206878.494039255, 
    41184.6112170779, 47352.159915619, 47352.159915619, 38160.4306992069, 
    21110.0504121689, 4202.51134868141, 2.65620920227888, 2.69856297145222, 
    2.140601133439, 1.18416372696187, 0.235738968126077, 0.23183754765102, 
    12056872.5431165, 10504847.2895747, 9686392.6804005, 6837985.75202198, 
    1079609.11661782, 1135761.82970609, 983052.482234695, 914434.263123612, 
    648604.15346396, 102153.681839915, 8.17191505849157, 7.18338571075784, 
    6.57944203561963, 4.66676895636116, 0.73500551706689, 10.2387755102041, 
    5326305.36831959, 5260029.15128078, 4127754.24341356, 2730780.77346503, 
    417150.273425643, 479773.046706308, 472407.32594957, 373289.498064991, 
    249477.987977412, 38025.8837634889, 3.02945100278541, 3.07873073820423, 
    2.3478472116823, 1.56272235553614, 0.231908902510731, 0.114742556824326, 
    8464818.85561442, 7943110.33106802, 6759294.49922447, 3747566.69399095, 
    645040.317032796, 785766.158955236, 738765.390978083, 627477.842921933, 
    348159.626944708, 59984.3863752916, 20.1484739243683, 19.2387968477078, 
    16.0896735143714, 8.92744627019863, 1.53810880117153, 10.2470588235294, 
    6674899.05847254, 6167539.13840372, 5324569.1207039, 2939801.52327145, 
    498269.458531088, 604597.890663534, 559175.656426817, 482317.582108871, 
    266362.63698104, 45193.0902157909, 15.1434401827283, 14.2314992191456, 
    12.0818254294549, 6.66573939695014, 1.13208590352289, 0.208396948519345, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.3904761904762, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.154575838359364, 
    10801491.3045329, 9944258.99832883, 8780093.19994687, 5425423.7536145, 
    857130.231747946, 1004561.63909293, 924985.746682997, 816320.071728021, 
    505255.273297406, 79968.9640403576, 10.286018847364, 9.628647062082, 
    8.35855493233622, 5.17346578011864, 0.818827077715238, 10.206862745098, 
    7270102.14467825, 6737339.7779402, 5863289.84461987, 3398483.31425396, 
    545984.139607516, 658565.883153585, 610433.136198259, 531189.873532452, 
    308273.110664417, 49553.5758644572, 6.53083617961947, 6.16696526833783, 
    5.26638362124291, 3.03373891776977, 0.488747265139006, 0.108225369829015, 
    18843904.3230351, 18843904.3230351, 15223537.2937802, 8314536.92488478, 
    1194855.66639551, 1918927.08821896, 1918927.08821896, 1550434.53172084, 
    846549.271224177, 121553.314049653, 40.2549557873257, 41.1248210220442, 
    32.5247759066726, 17.7587797338101, 2.54992662978834, 10.2159090909091, 
    8176516.76242755, 8176516.76242755, 6623032.91197933, 3594767.79262831, 
    507914.636833248, 835850.678999055, 835850.678999055, 677153.020577589, 
    367392.461187735, 51848.4236120221, 13.2425421492359, 13.6243891237529, 
    10.7607091220359, 5.79470566171786, 0.801157814004203, 0.156719652845951, 
    764283.27355432, 764283.27355432, 616160.813071066, 340365.877157523, 
    40013.3818143072, 78792.0900571463, 78792.0900571463, 63521.7333062955, 
    35089.2656863426, 4125.09090869146, 10.022572320857, 10.2375255341605, 
    8.08014060227098, 4.46345188675749, 0.524723001160194, 10.3333333333333, 
    764283.27355432, 764283.27355432, 616160.813071066, 340365.877157523, 
    40013.3818143072, 78792.0900571463, 78792.0900571463, 63521.7333062955, 
    35089.2656863426, 4125.09090869146, 11.3545974606372, 11.6043761314169, 
    9.15401166756484, 5.05665589996154, 0.594460011439658, 0.233560362002187, 
    25652842.8406981, 25652842.8406981, 20921132.3561297, 12467146.579295, 
    1684095.62749385, 2581786.6515366, 2581786.6515366, 2104970.21985432, 
    1249466.59392733, 169095.856040362, 23.499161180126, 23.9710278430385, 
    19.1592262072786, 11.3725186635411, 1.53909339240672, 10.3923076923077, 
    9032232.38118244, 9032232.38118244, 7342952.304122, 4173469.93427044, 
    563745.588163163, 919110.315102391, 919110.315102391, 747107.184554568, 
    422269.480824121, 57172.5038953593, 7.08986392599753, 7.25754454418935, 
    5.76766682858863, 3.19412457835572, 0.43304547702117, 0.104075187955749, 
    1969179.1411734, 1969179.1411734, 1563945.18665685, 914778.14027611, 
    152603.837553518, 191652.994552115, 191652.994552115, 152213.649706653, 
    89038.6438760315, 14852.9853458013, 5.24715289552306, 5.34946711806289, 
    4.16736662353173, 2.43773586277318, 0.406651016575638, 10.3884615384615, 
    1550724.63806205, 1550724.63806205, 1231206.78631976, 715987.271740255, 
    119766.923891639, 150701.944386618, 150701.944386618, 119651.12983515, 
    69585.9371985169, 11639.6145787301, 4.03071759337013, 4.10328142428489, 
    3.20014424817828, 1.86027893092245, 0.311234521438319, 0.172173106914613, 
    1924604.20462904, 1924604.20462904, 1514722.88695666, 844891.677104744, 
    116961.014916617, 187138.783239225, 187138.783239225, 147355.765588592, 
    82191.5243490775, 11352.4069055221, 10.951826871071, 11.0998983855126, 
    8.62362576717941, 4.81005235451289, 0.664371077160925, 10.6809523809524, 
    1438908.38838907, 1438908.38838907, 1135439.18898834, 633269.546362997, 
    86643.0514527502, 142434.134550776, 142434.134550776, 112465.089357095, 
    62723.7912312583, 8556.02711147953, 2.72127398795791, 2.77060085363962, 
    2.15642840090835, 1.20250875277776, 0.161862725921364, 0.213119273434663, 
    8869455.49117714, 8573003.46052918, 7315780.32444924, 5096601.14639465, 
    658001.596073002, 854947.822370975, 826166.07182263, 705063.848824, 
    490818.349655869, 63515.3954178124, 7.03510925473383, 6.91542488853039, 
    5.8017589825355, 4.03879701626854, 0.522649142356714, 10.4318681318681, 
    3403664.85675822, 3265752.15265299, 2825903.78888071, 2016194.48194219, 
    262675.161712247, 325463.833218503, 311854.373739531, 269807.084347168, 
    191794.533107603, 25291.8938673379, 2.38194269111161, 2.31241603714349, 
    1.97421133945149, 1.43080785676764, 0.193713309837856, 0.120332588829022, 
    5120553.68367697, 4893277.42154055, 4091818.29794087, 2346370.5758646, 
    384689.19144206, 557848.058244527, 532595.14022937, 445767.111236132, 
    255895.952792378, 41883.8730628981, 24.2328289703265, 23.5425695375299, 
    19.364050851364, 11.1160785926734, 1.81942863750755, 10.3461538461538, 
    4230920.77815256, 4010432.20864657, 3380411.56735934, 1957429.29436269, 
    316169.637805549, 467714.557436624, 443077.433433556, 373689.620953534, 
    216526.134992798, 34938.1612289092, 11.6589586408757, 11.068122448334, 
    9.31280331994432, 5.4836000567328, 0.863020327850254, 0.287430014839727, 
    462298.293446694, 462298.293446694, 369898.535003438, 204639.384088542, 
    39701.6232445038, 44028.4088996851, 44028.4088996851, 35228.4319050893, 
    19489.4651512897, 3781.10697566703, 3.87009923887816, 3.95507957412803, 
    3.09658084200568, 1.71312491487032, 0.332359483214269, 10.7, 
    462298.293446694, 462298.293446694, 369898.535003438, 204639.384088542, 
    39701.6232445038, 44028.4088996852, 44028.4088996852, 35228.4319050893, 
    19489.4651512897, 3781.10697566703, 4.328303792701, 4.42141951846015, 
    3.46320385488192, 1.91595217815478, 0.371709541007393, 0.206949952472293, 
    12370283.5120675, 12143007.2499311, 10283233.7358845, 6819695.44010743, 
    769784.768349877, 1291031.74152678, 1265778.82351162, 1070386.08674622, 
    707825.622254195, 80901.1066413332, 17.1908330044321, 17.1601010283131, 
    14.2528087231697, 9.42510681731192, 1.07724494248313, 10.3383333333333, 
    6624108.14301116, 6488063.75248891, 5698236.33664519, 3851780.621818, 
    392306.260684762, 691931.593994635, 675798.843226555, 591610.389222623, 
    396245.636519271, 41964.3878720295, 8.074675968873, 8.05940780149058, 
    7.00881083237119, 4.77785199309853, 0.46930176982302, 0.185379775709354, 
    3288271.71441901, 3288271.71441901, 2616499.35842912, 1620545.11061402, 
    276903.218262934, 308398.799469652, 308398.799469652, 245417.008052878, 
    151940.24468011, 25946.3987740724, 72.4535243987641, 74.4760002884039, 
    57.6569273661542, 35.6960086875041, 6.09570478182848, 10.4363636363636, 
    2741790.68377683, 2741790.68377683, 2172257.12648271, 1371571.69376414, 
    241551.85922975, 256474.219835878, 256474.219835878, 203210.04974162, 
    128277.637178125, 22584.9889935499, 7.71097539976315, 8.22152734486148, 
    5.86003466953577, 4.4339512737365, 0.995756610880111, 0.155339571388783, 
    574409.82901765, 574409.82901765, 452974.271323369, 256774.709326448, 
    38284.2685980138, 54705.6980016809, 54705.6980016809, 43140.4067927018, 
    24454.7342215665, 3646.12081885845, 33.9590861172372, 34.3471597755634, 
    26.7798208033282, 15.180510545333, 2.26336442828425, 10.4, 
    574409.82901765, 574409.82901765, 452974.271323369, 256774.709326448, 
    38284.2685980138, 54705.6980016809, 54705.6980016809, 43140.4067927018, 
    24454.7342215665, 3646.12081885845, 1.22819016987644e-07, 
    NaN, 4.75705293983453e-07, 1.70943285511227e-07, NaN, 0.0710669054518391, 
    11448726.6061251, 11448726.6061251, 9927376.45409594, 6937177.01562801, 
    724172.320593143, 1106572.44530414, 1106572.44530414, 960706.528106754, 
    672133.893070651, 69645.419500295, 28.0407075890654, 28.6378553221123, 
    24.3444439158647, 17.0319711432126, 1.76482511507759, 10.3607843137255, 
    4824031.67636305, 4824031.67636305, 4182681.40857481, 2936981.96169443, 
    319963.077714357, 464621.442663565, 464621.442663565, 403882.356765614, 
    284006.816763047, 30418.0022988892, 9.28110849865813, 9.52313049184992, 
    7.99021761260502, 5.56465462143434, 0.644527215303013, 0.150610963646878, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    117821.379340104, 123052.920608688, 123052.920608688, 97308.0161224128, 
    62485.8206726489, 11011.3438635611, 44.6678852217276, 45.762303441233, 
    35.3225528805782, 22.6821878910713, 3.99708874361976, 10.4363636363636, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    117821.379340104, 123052.920608688, 123052.920608688, 97308.0161224128, 
    62485.8206726489, 11011.3438635611, 26.5306835300096, 27.4720880065798, 
    20.9799829854224, 13.4721835546741, 2.37408813898259, 0.155339571388783, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.5, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.91771055403855e-07, 
    6723079.35345837, 6723079.35345837, 5678171.86000741, 4182982.52884115, 
    461060.354163779, 623646.726436967, 623646.726436967, 526657.653853672, 
    387891.769528557, 42792.7304213088, 21.0911899998696, 21.4585721363328, 
    17.8111039013624, 13.1181623565201, 1.44721293268946, 10.5457142857143, 
    5551495.81216955, 5551495.81216955, 4742162.00916957, 3570777.42056449, 
    361770.484702407, 514287.608987023, 514287.608987023, 439278.884033358, 
    330730.610091939, 33529.6348259428, 16.0854770049392, 16.4165628478359, 
    13.7393378427446, 10.3462538821149, 1.05001447012503, 0.164298155380745
    ), .Dim = c(16L, 2L, 3L, 9L, 1L)))
  result[["Log"]] <- NULL
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
              result <- f(
                          get_data("baeume.23"), get_data("baeume.3"),
                          list(
                               bagr.lab = c("Fichte", "Tanne"),
                               ba.grupp = list(c(10), c(30))
                               ),
                          list(A.ob = 160, A.b = 20), list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = T),
                          list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
                          )
  reference <- list(Log = list(Datum = structure(1524131539.36795, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = c(3, 5), Begehbar = 1), HBF = 884849.13, se_HBF = 26933.7163569886, 
    Attribute = c("V_DhmR", "V_DhmR_HB", "V_EoR", "oiB", "G", 
    "V_DhmR/J", "V_DhmR_HB/J", "V_EoR/J", "oiB/J", "G/J", "V_DhmR/ha/J", 
    "V_DhmR_HB/ha/J", "V_EoR/ha/J", "oiB/ha/J", "G/ha/J", "mBAF_mLK", 
    "mBAFoLK", "mPL", "nT"), Größen = c("Wert", "Standardfehler"
    ), BAGR = c("Fichte", "Tanne", "Alle BA"), AKL = c("1-20", 
    "21-40", "41-60", "61-80", "81-100", "101-120", "121-140", 
    "141-160", ">160"), DKL = c("-400--0.1", ">=400", "400-799.9"
    ), iVB.bagr.akl.dkl = structure(c(120942.0591476, 120942.0591476, 
    84666.5397415973, 80995.757804819, 10924.0602934086, 12094.20591476, 
    12094.20591476, 8466.65397415973, 8099.5757804819, 1092.40602934086, 
    0.27389670121169, 0.27790960082329, 0.191743766409091, 0.183430570235343, 
    0.0247396488805489, 44156.0846160489, 43518.48903, 10.0414414414414, 
    30, 120942.0591476, 120942.0591476, 84666.5397415973, 80995.757804819, 
    10924.0602934086, 12094.20591476, 12094.20591476, 8466.65397415973, 
    8099.5757804819, 1092.40602934086, 0.27052166344941, 0.274151460899187, 
    0.189381041887585, 0.181170283424432, 0.0244347994653204, 
    14418.5699408664, 14200.1649072563, 0.124225966679478, NA, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2670.86871782609, 
    2634.4371825, 10.1217391304348, 13, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 1432.56903617288, 1403.79426999032, 
    0.199081211015896, NA, 1191547.36107349, 1040679.06832287, 
    797606.681359249, 1099896.14350127, 100622.693622525, 121996.852846925, 
    105233.709207967, 81614.5565877568, 113395.660134571, 10252.3609304359, 
    1.02184131023495, 0.891196857755318, 0.683600629784447, 0.94979802530036, 
    0.0858734113354826, 119389.235515321, 118081.3288245, 10.255593220339, 
    84, 451731.419914202, 429501.876299327, 299811.075992769, 
    423191.178103864, 37676.0466318096, 45960.7074696454, 43209.0381216913, 
    30543.196758901, 43667.1354365377, 3811.29023982075, 0.350037560742362, 
    0.321587060861316, 0.231408316970727, 0.33627078061723, 0.0278529330168181, 
    24174.8607995919, 23856.344110231, 0.0720779834991265, NA, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7863.38258478261, 
    7615.06524, 10.1777777777778, 7, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 4168.8485908471, 4037.20074060982, 0.151396405413029, 
    NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4089.97416953804, 
    3960.8170905, 10.1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 2969.61718577744, 2875.83980096342, 0.0710669054518611, 
    NA, 163108.773684582, 87838.1083514882, 114152.651336056, 
    138850.054246725, 12379.6950197063, 15753.3168845094, 8783.81083514882, 
    11010.1274577561, 13374.8471342786, 1197.80549254652, 0.878391702391983, 
    0.504887400205497, 0.613915448541572, 0.745770229193065, 
    0.0667886270203201, 17934.2733334239, 17397.563955, 10.2, 
    18, 115098.383993454, 87838.1083514881, 80380.7889494952, 
    97687.8582899328, 8777.53109699666, 11157.6253506636, 8783.81083514882, 
    7771.21787358576, 9419.89913369474, 853.857842053198, 0.541029952522173, 
    0.407088420237678, 0.380850789365572, 0.466493490462663, 
    0.0408463180083053, 6748.33013692569, 6554.53062510229, 0.129857604599857, 
    NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2204.42362720109, 
    2134.8102495, 10.6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 2204.42362720109, 2134.8102495, 1.92132546875292e-07, 
    NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 367.788492961957, 
    356.1741195, 11, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 367.788492961957, 356.1741195, NaN, NA, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3538.06069703804, 3426.3324645, 
    10.7333333333333, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 2420.95995698881, 2344.50858992601, 0.109414658648304, 
    NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, 10.8, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, 10.4571428571429, 
    2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0.278466241770615, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 
    0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 
    NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 
    0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 
    0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, 
    NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 
    NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 
    0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, 
    NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, 
    NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, NA, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0, 0, NaN, 
    NA, 2270132.61634507, 2270132.61634507, 1601834.94324831, 
    1172582.63635265, 338637.478586626, 217630.560106935, 217630.560106935, 
    153472.593625639, 112095.353840856, 32436.9170004255, 27.2713943372622, 
    27.2713943372622, 19.231727468195, 14.0467248554929, 4.06468629299576, 
    7980.1772295, 7980.1772295, 10.36, 4, 1258404.41414485, 1258404.41414485, 
    915684.251738356, 652531.114180691, 181619.665378442, 119976.618278518, 
    119976.618278518, 87188.9580000077, 62006.7504096132, 17325.7698487083, 
    4.32709579631021, 4.32709579631021, 2.98827820669614, 1.81447154851701, 
    0.594039114312108, 4685.55266981241, 4685.55266981241, 0.198255013820724, 
    NA, 242794.59892886, 242794.59892886, 183889.431937306, 107160.601065544, 
    26330.5648912416, 24279.459892886, 24279.459892886, 18388.9431937306, 
    10716.0601065544, 2633.05648912416, 157.021414277461, 157.021414277461, 
    118.925951404443, 69.3034738349547, 17.0286429607054, 154.625151, 
    154.625151, 10, 1, 242794.59892886, 242794.59892886, 183889.431937306, 
    107160.601065544, 26330.5648912416, 24279.459892886, 24279.459892886, 
    18388.9431937306, 10716.0601065544, 2633.05648912416, NaN, 
    NaN, NaN, 0, NaN, 154.625151, 154.625151, 0, NA, 5560796.52001896, 
    5560796.52001896, 3963938.90538683, 3522922.23087574, 783281.676561122, 
    541053.203156695, 541053.203156695, 386017.940775751, 343292.114329273, 
    76247.7363336768, 25.9792808317524, 25.991247620871, 18.5350875496132, 
    16.4835587211251, 3.66112120479272, 20826.3349035978, 20816.7461235, 
    10.1621621621622, 9, 1866205.67764585, 1866205.67764585, 
    1330580.08195735, 1199721.4478482, 257223.532820158, 179775.520784821, 
    179775.520784821, 128351.204016138, 116073.728294894, 24756.5980616592, 
    3.92696066602398, 3.93489056695645, 2.91409296318549, 2.82615765645372, 
    0.547133474073697, 7681.99901629079, 7681.18038147842, 0.100169215037742, 
    NA, 17047467.688815, 16105733.334322, 13764151.107228, 7666028.95559144, 
    1447836.29342588, 1746991.12886251, 1652584.11217009, 1411475.45472157, 
    785081.803667861, 147808.688913825, 25.1978074472248, 24.1994177874016, 
    20.3584815841141, 11.3236637509564, 2.13192546930812, 69331.0770201522, 
    68290.2426285, 10, 13, 5388393.2192747, 5095319.80109243, 
    4392040.5684367, 2414898.26188865, 446149.826446617, 553281.762466594, 
    523833.163505411, 451212.560977387, 247779.376512843, 45557.9218417422, 
    3.57647013071798, 3.18235199089521, 2.9554816023054, 1.58504745127457, 
    0.281481132679492, 21119.379702206, 20798.1789379261, 0.183369092544011, 
    NA, 3312244.3897663, 3245650.11241295, 2629231.25085388, 
    1456109.30299663, 274235.816280284, 326237.283919724, 319577.856184389, 
    258909.469891421, 143389.159873193, 27016.2374775538, 24.8971784923698, 
    24.824162670702, 19.7589779065158, 10.9429108296287, 2.06177564559548, 
    13103.3837436522, 12873.6610545, 10.0333333333333, 3, 2595091.29833061, 
    2584794.90654957, 2084051.85083017, 1153085.61335636, 212300.832620285, 
    254638.353070441, 253587.615106834, 204475.891466778, 113132.450961877, 
    20832.9617767758, 9.56395434913746, 9.63462525308261, 7.85089139389289, 
    4.28240920434293, 0.741841354530754, 8235.14138895063, 8097.10538736698, 
    0.036185497070948, NA, 25632772.8840425, 23507174.7884289, 
    20471006.775764, 12657789.5183761, 2226726.13415542, 2596794.61813021, 
    2386262.22006015, 2075840.35139632, 1279183.15830419, 224875.822949727, 
    22.5591259319631, 21.0072563388718, 18.0334415262763, 11.1126439329302, 
    1.95356304790461, 115110.60428325, 113592.283617, 10.1711340206186, 
    30, 6267471.92471815, 5931474.17732587, 5093169.99839821, 
    2930652.88925351, 514853.262877061, 639486.185934888, 605392.401154499, 
    519983.826022665, 298726.856834461, 52296.2632086099, 2.91966902996767, 
    2.61392571090036, 2.41128511225552, 1.4138036915024, 0.234731627297895, 
    25146.7662843355, 24786.4900385757, 0.113997866622618, NA, 
    12834082.1172679, 12558754.7843982, 10328173.2133269, 5601265.33681743, 
    795496.353960922, 1233795.74974101, 1208028.21690215, 992373.429245042, 
    539014.339970322, 76742.3101329607, 19.4195637673381, 19.3333382341425, 
    15.6196510599761, 8.48391911607784, 1.2079002424775, 63533.6490831033, 
    62484.2022765, 10.2846153846154, 15, 4496456.98677789, 4437307.96245157, 
    3617410.34050788, 1950590.57097274, 277373.121640257, 426015.241567852, 
    420690.599604195, 342484.980068859, 184944.656352995, 26349.3826678969, 
    2.36133721063387, 2.32502184051793, 1.87589637315186, 0.989516461020108, 
    0.152339645233078, 20678.2380179165, 20330.6755027111, 0.206080721824215, 
    NA, 2332255.5562827, 2332255.5562827, 1889425.5213581, 1034065.33935132, 
    162663.812676846, 229079.451283324, 229079.451283324, 185556.838256645, 
    101528.251355242, 15992.8462833436, 19.4639923035019, 19.6739253285471, 
    15.7660447126817, 8.62646165728047, 1.35885010735902, 11769.3969310761, 
    11643.8101425, 10.2, 4, 1453076.4109285, 1453076.4109285, 
    1168915.72535814, 643939.32812627, 96321.8062498305, 139978.802990954, 
    139978.802990954, 112608.389827966, 62006.6036308391, 9321.29557891174, 
    8.85863621117205, 8.88867394366375, 7.01987975380814, 3.91703303243494, 
    0.578865117662834, 6444.06395714889, 6360.0536959788, 0.360946555596131, 
    NA, 22518334.2886302, 21664383.3863359, 18056144.4281781, 
    11053289.454655, 1462783.97582768, 2177040.3738076, 2096092.6699746, 
    1742685.00905546, 1068612.49866518, 141583.376013527, 16.0731838172911, 
    15.7099505937077, 12.8663192576425, 7.88961258006424, 1.04531622633985, 
    135445.497205451, 133424.52336, 10.3040816326531, 30, 5306158.54096391, 
    5247118.69745806, 4197586.22667146, 2451643.14738752, 330254.526347647, 
    507255.986322036, 501953.72913485, 399912.688193291, 234816.140049002, 
    31569.6575616312, 1.83193937177633, 1.86584385285183, 1.41350269228266, 
    0.785953419365409, 0.108039566687451, 29081.5698293097, 28612.9360977658, 
    0.133549995318539, NA, 6306364.65303104, 6219021.63974456, 
    5092553.13847073, 2797129.21014564, 375672.570303302, 618576.43396997, 
    610636.160034835, 499499.929905253, 274978.413784691, 37002.5904799456, 
    15.8614251937804, 15.9020782162264, 12.8080869839205, 7.05094682019848, 
    0.948813741750534, 38998.7927574457, 38399.770881, 10.2882352941176, 
    10, 2626065.75821748, 2597580.31087454, 2132652.64176113, 
    1150872.01972439, 149857.10033714, 255338.675483107, 252933.521618649, 
    207268.698347338, 112479.505787164, 14739.3150821994, 1.64087206382882, 
    1.59203177517802, 1.34405873125147, 0.691100666909126, 0.0906350832039918, 
    16373.0836427549, 16108.4520763466, 0.2382078979313, NA, 
    1558863.99908778, 1515076.56976929, 1194119.7791402, 673330.075899648, 
    68037.9995161064, 149036.754050813, 144982.362447249, 114070.913195356, 
    64332.0535405488, 6429.82007368989, 15.5922344055912, 15.4486964372889, 
    11.9341059776129, 6.73042341122973, 0.672688172882288, 9558.39619736413, 
    9384.7635, 10.5428571428571, 6, 1009419.52952343, 1009133.62646663, 
    770994.191857809, 430945.912664431, 49723.8907232717, 96026.4869744781, 
    96002.7247811445, 73271.246196565, 40973.3475726345, 4689.24037243382, 
    10.5219679658196, 10.4870150807235, 8.01815130101226, 4.50301614406146, 
    0.493679223018473, 5357.95554833856, 5224.2979815171, 0.15417075730525, 
    NA, 14091541.7789773, 13690314.4695151, 11567991.183824, 
    7576252.11295067, 864770.906291539, 1379500.57431819, 1339886.36265193, 
    1131309.3425593, 742470.925642112, 84643.6587193913, 14.1251351387445, 
    13.9475585818877, 11.5838279772173, 7.60239057273824, 0.866692729461238, 
    97662.8230999565, 96066.014334, 10.2549019607843, 28, 3583491.24081569, 
    3541154.48984026, 2960314.69058977, 1922374.49595581, 208051.554600287, 
    346368.365486296, 342667.347172916, 285710.801524555, 186031.845893899, 
    20223.8454893618, 1.73193887748288, 1.73358321499726, 1.42023859088297, 
    0.953611180998547, 0.0919661468663043, 22793.1933694342, 
    22404.6746491643, 0.121174654329416, NA, 7419292.64263111, 
    6165560.51374081, 6043638.75221566, 3392205.70081125, 448386.823307874, 
    734017.292332615, 607037.917422527, 597789.113096563, 335499.480284842, 
    44338.2373267707, 15.3981012782548, 13.0095228009764, 12.5403275953448, 
    7.03805622863564, 0.930120687875482, 47669.3378662989, 46661.044122, 
    10.2545454545455, 12, 2322931.95807485, 2069678.37892225, 
    1893852.94386554, 1064690.45622364, 141674.06685857, 228214.968774715, 
    201515.394902323, 185871.74687851, 104600.264966278, 13923.1502650246, 
    2.58516979621238, 2.76826226640314, 2.1083441768668, 1.15536420636211, 
    0.147286458327446, 13896.4802403142, 13603.8626890217, 0.165851785071856, 
    NA, 1422266.43342572, 1422266.43342572, 1126232.7899378, 
    636832.089839481, 82695.3906922505, 137110.487370652, 137110.487370652, 
    108653.809796828, 61379.0592397385, 7947.74936377981, 17.4408341576373, 
    17.814886169921, 13.8210658688649, 7.80758652004626, 1.01097575567237, 
    7861.46385725544, 7696.399857, 10.1733333333333, 5, 937510.718978186, 
    937510.718978186, 736338.49977741, 419453.820291701, 55682.1280993357, 
    89140.7835749428, 89140.7835749428, 70060.8607709948, 39873.6284376269, 
    5284.71399533562, 2.26875119968563, 2.31465480916265, 1.6602063560395, 
    1.05507066583916, 0.161860860542385, 5054.59243246139, 4947.04176670475, 
    0.254658161854144, NA, 16300794.8957923, 15013519.4117563, 
    13419073.6758353, 8820015.28668942, 929793.745436776, 1591629.66652546, 
    1461114.01938099, 1310564.74953242, 859074.392237619, 90537.766927494, 
    14.4868523704278, 13.5659562805433, 11.9286279011182, 7.8192082978257, 
    0.824065604588824, 109867.183417598, 107704.4617545, 10.4175824175824, 
    27, 5349013.8971585, 5138196.00628317, 4476568.59837624, 
    3218691.87456312, 250409.153110003, 512037.661324223, 491113.575856246, 
    428111.053670103, 306824.484485802, 24067.3807009312, 3.18428722264291, 
    3.1899954771984, 2.71525617374063, 2.04144527286228, 0.122760259766991, 
    22606.2855174831, 22177.396573067, 0.106313611932145, NA, 
    2263867.68703122, 2263867.68703122, 1843617.73046542, 967412.076626677, 
    119911.869411749, 220871.610517835, 220871.610517835, 179938.641480171, 
    94430.4518956204, 11676.6592822384, 6.04711193464995, 6.16502455669932, 
    4.92643261779257, 2.58535495491524, 0.319688281970324, 36525.1400841848, 
    35826.558108, 10.4, 8, 1082344.12507754, 1082344.12507754, 
    879930.797296785, 458298.588783317, 57559.0934514455, 104395.166816356, 
    104395.166816356, 84897.9730418228, 44299.223787751, 5575.01477675497, 
    1.68164287533841, 1.70113144950598, 1.35578831782543, 0.696483687663301, 
    0.0930913382994414, 15206.676639706, 14931.5716650656, 0.133010187577499, 
    NA, 2612919.61777649, 2612919.61777649, 2070923.41568407, 
    1121363.51042288, 144796.202582413, 255083.775953488, 255083.775953488, 
    202216.181885309, 109197.765452456, 14041.5736435248, 14.9281367737145, 
    15.1299690201422, 11.8341937261923, 6.39052472845431, 0.821747800639993, 
    17087.4490112283, 16859.504181, 10.6952380952381, 6, 1536089.06300151, 
    1536089.06300151, 1219723.13375759, 641751.70236586, 81535.0088487146, 
    153704.778610226, 153704.778610226, 122076.499053129, 63993.4235353725, 
    8054.86161839425, 2.17600694650223, 2.21033341220392, 1.72714532222123, 
    0.944229121699134, 0.156321767443304, 10114.2760500498, 9966.60405400827, 
    0.208064342034062, NA, 9902428.59712367, 10017551.9659907, 
    8326700.88959859, 5261489.0499212, 539515.838886495, 957977.582864072, 
    969186.839747563, 806359.866122682, 509609.64202284, 52203.7611682038, 
    7.88291025801362, 8.1125805353398, 6.63529353297081, 4.19342492615978, 
    0.429569096167585, 121525.877056663, 119467.145568, 10.4571428571429, 
    26, 2430604.54106388, 2458370.20142995, 2030194.23549468, 
    1293576.95980312, 133669.915810852, 235675.987742046, 238384.881001432, 
    196642.859975242, 124076.757678088, 12848.5004241554, 1.13981087572573, 
    1.17133244993447, 0.940146494698205, 0.589353781842704, 0.0624152898235024, 
    26033.4828077344, 25603.7890076916, 0.132277517216761, NA, 
    2614961.40900453, 2611095.00326527, 2143853.01782398, 1130288.0524537, 
    138996.678595767, 267872.875410827, 267443.274773132, 219625.944123802, 
    115859.322158839, 14229.8656481912, 11.6363541643355, 11.8219289251862, 
    9.54051531190535, 5.03291012131195, 0.618143050651598, 23020.3439692337, 
    22622.642757, 10.4769230769231, 7, 1419430.79503076, 1416906.86505603, 
    1157705.05561355, 610632.586274042, 74311.638316429, 148128.229208792, 
    147828.942488189, 121002.936164541, 63918.3107714946, 7783.19399596327, 
    1.73800682651279, 1.75742663412788, 1.45066385870739, 0.744183795726878, 
    0.0876586893674529, 12285.3332952831, 12080.7415290415, 0.312410096618915, 
    NA, 1629663.01498817, 1629663.01498817, 1286736.78422315, 
    731573.500471668, 90530.1790775896, 149773.686422614, 149773.686422614, 
    118291.698750316, 67219.5887713737, 8321.00536298831, 13.1651141686449, 
    13.4541961137318, 10.397845953104, 5.90860505394408, 0.731416767645955, 
    11376.5581144239, 11132.117085, 10.92, 5, 1070183.63800976, 
    1070183.63800976, 852274.50071877, 483011.132362123, 62325.9169709117, 
    98780.5063611661, 98780.5063611661, 78689.0021281181, 44579.8727396144, 
    5756.22573143095, 2.67586208917276, 2.71476697100547, 2.14635220770453, 
    1.22034842258843, 0.166746081879441, 6545.41032065837, 6403.56906951206, 
    0.146059348668036, NA, 6991302.32741352, 6987435.92167426, 
    6119375.70879499, 3601342.03697123, 411166.704518876, 688611.619078658, 
    688182.018440963, 603127.649857468, 354790.887041745, 40485.2292584537, 
    9.1692612719912, 9.3296496536047, 8.03099286838122, 4.72424549640902, 
    0.539084201373055, 75100.0106390381, 73762.9004295, 10.44, 
    17, 2271450.36838318, 2269949.31461198, 2016233.79482682, 
    1125887.21008469, 124906.298324661, 225381.738757468, 225193.258384243, 
    200270.118636889, 111613.778170307, 12377.0417413394, 1.38869389313149, 
    1.41266627420877, 1.48041720237766, 0.642127215462905, 0.058008115644283, 
    20276.0022077472, 19932.8453282484, 0.207168934573451, NA, 
    506298.067936819, 506298.067936819, 409140.059708364, 237633.744875857, 
    33564.0097018546, 47903.032968614, 47903.032968614, 38708.2308514995, 
    22489.613431582, 3176.18611790028, 11.2540761310837, 11.568223687385, 
    9.09389969498924, 5.28358657130325, 0.746195765949955, 4256.50514628261, 
    4140.915171, 10.5818181818182, 3, 341728.126624759, 341728.126624759, 
    272250.972377669, 167011.581612634, 25166.7720608238, 32261.1869087795, 
    32261.1869087795, 25700.3791759647, 15769.9424678525, 2375.99928762875, 
    1.8298369860437, 1.84330181257854, 1.60068600793599, 0.708142696025579, 
    0.0859859017522293, 3225.88398529191, 3127.47206252007, 0.220985909383427, 
    NA, 333724.800330302, 333724.800330302, 269356.452185785, 
    187660.585465569, 18471.0934132341, 30338.6182118456, 30338.6182118456, 
    24486.9501987077, 17060.0532241426, 1679.19031029401, 18.832987900134, 
    19.0482053087059, 15.2005089217738, 10.5901914748534, 1.04237347182285, 
    1610.92962904891, 1592.728434, 10.9, 2, 333724.800330302, 
    333724.800330302, 269356.452185785, 187660.585465569, 18471.0934132341, 
    30338.6182118456, 30338.6182118456, 24486.9501987077, 17060.0532241426, 
    1679.19031029401, NaN, NaN, 1.71055846383819e-07, 1.24094876557872e-07, 
    NaN, 1610.92962904891, 1592.728434, 0.0710669054518899, NA, 
    4741908.57968547, 4133610.40640992, 3821483.60503837, 2759565.92616467, 
    210612.589515778, 458844.120523291, 398014.303195736, 368261.816126762, 
    267354.075989416, 20358.3225116138, 11.6271771153847, 10.3005240004129, 
    9.33180827522826, 6.77479138340873, 0.515882869643616, 39463.0713861033, 
    38640.199584, 10.5294117647059, 13, 1920361.86885687, 1587947.38814699, 
    1442195.21374328, 1133257.85026994, 80229.3710289501, 188319.540102625, 
    154218.227870786, 140096.090202816, 111038.22262242, 7828.98217665414, 
    1.88117837339288, 1.22082589521115, 0.966499195348647, 1.05341203050788, 
    0.0713413077930795, 13444.2227848404, 13187.7278783247, 0.182141864454003, 
    NA, 324398.377039459, 324398.377039459, 267164.10717868, 
    131200.092117574, 19282.0262619474, 29934.7002382877, 29934.7002382877, 
    24639.3487019914, 12146.5535492077, 1789.16175221584, 10.866217134681, 
    11.1324528418398, 8.94401851101594, 4.40916686163786, 0.649460991220389, 
    2754.8409779837, 2688.9581895, 10.5818181818182, 3, 232933.245203445, 
    232933.245203445, 193072.194361287, 92333.6973546429, 13629.1072605723, 
    21421.8532220582, 21421.8532220582, 17738.277623815, 8545.64340660511, 
    1267.09328830496, 2.93890804987776, 2.93960737822178, 2.60297574255426, 
    0.695098110412408, 0.0651732259646401, 1835.44594362468, 
    1789.28616513626, 0.220985909383427, NA, 136578.837037062, 
    136578.837037062, 115677.081613538, 62440.8331235108, 4529.47620899025, 
    12416.2579124602, 12416.2579124602, 10516.0983285035, 5676.43937486462, 
    411.770564453659, 23.3010668034124, 23.5652950750519, 19.7351175685397, 
    10.6527340211342, 0.772752426508868, 532.862208293478, 526.8874365, 
    11, 1, 136578.837037062, 136578.837037062, 115677.081613538, 
    62440.8331235108, 4529.47620899025, 12416.2579124602, 12416.2579124602, 
    10516.0983285035, 5676.43937486462, 411.770564453659, NaN, 
    NaN, NaN, 1.52570186845145e-07, NaN, 532.862208293478, 526.8874365, 
    NaN, NA, 3295150.51524556, 3295150.51524556, 2766553.67981725, 
    1737745.54906136, 138244.427561578, 304069.214279263, 304069.214279263, 
    255560.81875241, 160206.805826934, 12706.2387612749, 10.2833564253835, 
    10.4624796258096, 8.6428446688465, 5.41805486621054, 0.429713946273464, 
    29569.0630277772, 29062.8249855, 10.6685714285714, 9, 1176899.02573341, 
    1176899.02573341, 1031487.35999045, 620275.595318577, 48217.0441855282, 
    106993.551297085, 106993.551297085, 94410.2745444025, 56317.9609898109, 
    4380.20981242287, 1.66734969020068, 1.69310789773542, 1.69826531788661, 
    0.765677118713801, 0.061970667675652, 10675.2359338299, 10490.9288786009, 
    0.189435659534734, NA), .Dim = c(19L, 2L, 3L, 9L, 2L)), VB.A.bagr.akl.dkl = structure(c(0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.0405405405405, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.106771598748818, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.195652173913, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.179347242746652, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.2077966101695, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0630605930800826, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.1074074074074, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.135275549441539, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.25, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.319801074533426, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.1228070175439, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0952441634831384, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.8, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.5, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 1.91771055403855e-07, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.7, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0820609939862446, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 10.3, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 8.89400868588189e-08, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 10.1714285714286, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, 0.104424840663999, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NaN, NaN, NaN, NaN, NaN, NaN, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.3466666666667, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.185837504294078, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 199984.832941677, 
    199984.832941677, 140330.268358303, 249136.508166555, 59099.376430081, 
    20200.488175927, 20200.488175927, 14174.7745816468, 25165.3038552076, 
    5969.63398283646, 0.969949262288934, 0.970396048262446, 0.680617816205291, 
    1.20834049638087, 0.286638720181398, 10.1297297297297, 199984.832941677, 
    199984.832941677, 140330.268358303, 249136.508166555, 59099.376430081, 
    20200.488175927, 20200.488175927, 14174.7745816468, 25165.3038552076, 
    5969.63398283646, 1.00455012833462, 1.00547578969404, 0.704897401542828, 
    1.25144545998915, 0.296863943650405, 0.0950339768928249, 
    7948342.27569383, 7948342.27569383, 6108128.0122294, 4322605.03693823, 
    1084210.12559878, 826531.221122707, 826531.221122707, 634734.549793608, 
    450249.444984214, 113391.533102899, 11.9215113430657, 12.1032110783242, 
    9.15512317238505, 6.4941937199871, 1.63550802867147, 10.0309523809524, 
    2981210.96975089, 2981210.96975089, 2285274.65469812, 1630310.68782677, 
    425711.898139759, 317808.299588429, 317808.299588429, 243105.290771265, 
    174791.624055141, 46018.7823780042, 3.36573859363778, 3.4278934234805, 
    2.56101353496058, 1.87991806938388, 0.516602254651707, 0.171557700782197, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.0833333333333, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.126649239748664, 
    9039578.62138326, 8321690.43974731, 7021541.55285696, 5134028.56923882, 
    1261811.7069763, 937803.916901873, 864550.020816572, 727874.450478063, 
    533104.197252204, 131516.63492575, 8.14698109475857, 7.61099251892481, 
    6.32326148412009, 4.63123445986268, 1.14252405974805, 10.120618556701, 
    3212380.39283811, 3047275.75154993, 2483544.76791203, 1839597.00401772, 
    462467.368386189, 340520.307568628, 324369.763704787, 262618.189907534, 
    195295.131860617, 49589.5589619303, 2.28324775839927, 2.25019925959427, 
    1.74701912153221, 1.3298876099195, 0.34984905825477, 0.095305708995023, 
    5591203.2006302, 5591203.2006302, 4461242.90159191, 2450812.47183489, 
    415767.810808691, 513835.595380373, 513835.595380373, 409958.899391008, 
    225741.699323441, 38256.6858804121, 8.08761345831507, 8.22344811423837, 
    6.4526263689777, 3.55310457657117, 0.602148411629428, 10.2346153846154, 
    3263986.41362229, 3263986.41362229, 2606427.46536244, 1395162.77765283, 
    234023.625666007, 292015.367997185, 292015.367997185, 233173.322579575, 
    125060.28652364, 20966.1750211287, 4.09285132318133, 4.16040072158989, 
    3.26939926040909, 1.73496395649647, 0.288340509131768, 0.188555740688587, 
    464051.167173066, 464051.167173066, 373972.220852227, 206878.494039255, 
    41184.6112170779, 47352.159915619, 47352.159915619, 38160.4306992069, 
    21110.0504121689, 4202.51134868141, 4.02332933394316, 4.06672380742307, 
    3.24234376006535, 1.79363909092314, 0.357071086419478, 10.1714285714286, 
    464051.167173066, 464051.167173066, 373972.220852227, 206878.494039255, 
    41184.6112170779, 47352.159915619, 47352.159915619, 38160.4306992069, 
    21110.0504121689, 4202.51134868141, 2.69365660269612, 2.73647913850421, 
    2.1707794596449, 1.20085813988879, 0.239062430572404, 0.23183754765102, 
    12056872.5431165, 10504847.2895747, 9686392.6804005, 6837985.75202198, 
    1079609.11661782, 1135761.82970609, 983052.482234695, 914434.263123612, 
    648604.15346396, 102153.681839915, 8.3853790132521, 7.36785455535987, 
    6.75130795774295, 4.7886726900941, 0.754205078408497, 10.2387755102041, 
    5326305.36831959, 5260029.15128078, 4127754.24341356, 2730780.77346503, 
    417150.273425643, 479773.046706308, 472407.32594957, 373289.498064991, 
    249477.987977412, 38025.8837634889, 3.10761777857077, 3.15726703200299, 
    2.4098950894524, 1.60843414312447, 0.239251430266594, 0.114742556824326, 
    8464818.85561442, 7943110.33106802, 6759294.49922447, 3747566.69399095, 
    645040.317032796, 785766.158955236, 738765.390978083, 627477.842921933, 
    348159.626944708, 59984.3863752916, 20.1484739243683, 19.2387968477078, 
    16.0896735143714, 8.92744627019863, 1.53810880117153, 10.2470588235294, 
    6674899.05847254, 6167539.13840372, 5324569.1207039, 2939801.52327145, 
    498269.458531088, 604597.890663534, 559175.656426817, 482317.582108871, 
    266362.63698104, 45193.0902157909, 15.1434401827283, 14.2314992191456, 
    12.0818254294549, 6.66573939695014, 1.13208590352289, 0.208396948519345, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.3904761904762, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.154575838359364, 
    10801491.3045329, 9944258.99832883, 8780093.19994687, 5425423.7536145, 
    857130.231747946, 1004561.63909293, 924985.746682997, 816320.071728021, 
    505255.273297406, 79968.9640403576, 10.286018847364, 9.628647062082, 
    8.35855493233622, 5.17346578011864, 0.818827077715238, 10.206862745098, 
    7270102.14467825, 6737339.7779402, 5863289.84461987, 3398483.31425396, 
    545984.139607516, 658565.883153585, 610433.136198259, 531189.873532452, 
    308273.110664417, 49553.5758644572, 6.53083617961947, 6.16696526833783, 
    5.26638362124291, 3.03373891776977, 0.488747265139006, 0.108225369829015, 
    18843904.3230351, 18843904.3230351, 15223537.2937802, 8314536.92488478, 
    1194855.66639551, 1918927.08821896, 1918927.08821896, 1550434.53172084, 
    846549.271224177, 121553.314049653, 40.2549557873257, 41.1248210220442, 
    32.5247759066726, 17.7587797338101, 2.54992662978834, 10.2159090909091, 
    8176516.76242755, 8176516.76242755, 6623032.91197933, 3594767.79262831, 
    507914.636833248, 835850.678999055, 835850.678999055, 677153.020577589, 
    367392.461187735, 51848.4236120221, 13.2425421492359, 13.6243891237529, 
    10.7607091220359, 5.79470566171786, 0.801157814004203, 0.156719652845951, 
    764283.27355432, 764283.27355432, 616160.813071066, 340365.877157523, 
    40013.3818143072, 78792.0900571463, 78792.0900571463, 63521.7333062955, 
    35089.2656863426, 4125.09090869146, 10.022572320857, 10.2375255341605, 
    8.08014060227098, 4.46345188675749, 0.524723001160194, 10.3333333333333, 
    764283.27355432, 764283.27355432, 616160.813071066, 340365.877157523, 
    40013.3818143072, 78792.0900571463, 78792.0900571463, 63521.7333062955, 
    35089.2656863426, 4125.09090869146, 11.3545974606372, 11.6043761314169, 
    9.15401166756484, 5.05665589996154, 0.594460011439658, 0.233560362002187, 
    25652842.8406981, 25652842.8406981, 20921132.3561297, 12467146.579295, 
    1684095.62749385, 2581786.6515366, 2581786.6515366, 2104970.21985432, 
    1249466.59392733, 169095.856040362, 23.499161180126, 23.9710278430385, 
    19.1592262072786, 11.3725186635411, 1.53909339240672, 10.3923076923077, 
    9032232.38118244, 9032232.38118244, 7342952.304122, 4173469.93427044, 
    563745.588163163, 919110.315102391, 919110.315102391, 747107.184554568, 
    422269.480824121, 57172.5038953593, 7.08986392599753, 7.25754454418935, 
    5.76766682858863, 3.19412457835572, 0.43304547702117, 0.104075187955749, 
    1969179.1411734, 1969179.1411734, 1563945.18665685, 914778.14027611, 
    152603.837553518, 191652.994552115, 191652.994552115, 152213.649706653, 
    89038.6438760315, 14852.9853458013, 5.24715289552306, 5.34946711806289, 
    4.16736662353173, 2.43773586277318, 0.406651016575638, 10.3884615384615, 
    1550724.63806205, 1550724.63806205, 1231206.78631976, 715987.271740255, 
    119766.923891639, 150701.944386618, 150701.944386618, 119651.12983515, 
    69585.9371985169, 11639.6145787301, 4.03071759337013, 4.10328142428489, 
    3.20014424817828, 1.86027893092245, 0.311234521438319, 0.172173106914613, 
    1924604.20462904, 1924604.20462904, 1514722.88695666, 844891.677104744, 
    116961.014916617, 187138.783239225, 187138.783239225, 147355.765588592, 
    82191.5243490775, 11352.4069055221, 10.951826871071, 11.0998983855126, 
    8.62362576717941, 4.81005235451289, 0.664371077160925, 10.6809523809524, 
    1438908.38838907, 1438908.38838907, 1135439.18898834, 633269.546362997, 
    86643.0514527502, 142434.134550776, 142434.134550776, 112465.089357095, 
    62723.7912312583, 8556.02711147953, 2.72127398795791, 2.77060085363962, 
    2.15642840090835, 1.20250875277776, 0.161862725921364, 0.213119273434663, 
    8869455.49117714, 8573003.46052918, 7315780.32444924, 5096601.14639465, 
    658001.596073002, 854947.822370975, 826166.07182263, 705063.848824, 
    490818.349655869, 63515.3954178124, 7.03510925473383, 6.91542488853039, 
    5.8017589825355, 4.03879701626854, 0.522649142356714, 10.4318681318681, 
    3403664.85675822, 3265752.15265299, 2825903.78888071, 2016194.48194219, 
    262675.161712247, 325463.833218503, 311854.373739531, 269807.084347168, 
    191794.533107603, 25291.8938673379, 2.38194269111161, 2.31241603714349, 
    1.97421133945149, 1.43080785676764, 0.193713309837856, 0.120332588829022, 
    5120553.68367697, 4893277.42154055, 4091818.29794087, 2346370.5758646, 
    384689.19144206, 557848.058244527, 532595.14022937, 445767.111236132, 
    255895.952792378, 41883.8730628981, 24.2328289703265, 23.5425695375299, 
    19.364050851364, 11.1160785926734, 1.81942863750755, 10.3461538461538, 
    4230920.77815256, 4010432.20864657, 3380411.56735934, 1957429.29436269, 
    316169.637805549, 467714.557436624, 443077.433433556, 373689.620953534, 
    216526.134992798, 34938.1612289092, 11.6589586408757, 11.068122448334, 
    9.31280331994432, 5.4836000567328, 0.863020327850254, 0.287430014839727, 
    462298.293446694, 462298.293446694, 369898.535003438, 204639.384088542, 
    39701.6232445038, 44028.4088996851, 44028.4088996851, 35228.4319050893, 
    19489.4651512897, 3781.10697566703, 3.87009923887816, 3.95507957412803, 
    3.09658084200568, 1.71312491487032, 0.332359483214269, 10.7, 
    462298.293446694, 462298.293446694, 369898.535003438, 204639.384088542, 
    39701.6232445038, 44028.4088996852, 44028.4088996852, 35228.4319050893, 
    19489.4651512897, 3781.10697566703, 4.328303792701, 4.42141951846015, 
    3.46320385488192, 1.91595217815478, 0.371709541007393, 0.206949952472293, 
    12370283.5120675, 12143007.2499311, 10283233.7358845, 6819695.44010743, 
    769784.768349877, 1291031.74152678, 1265778.82351162, 1070386.08674622, 
    707825.622254195, 80901.1066413332, 17.1908330044321, 17.1601010283131, 
    14.2528087231697, 9.42510681731192, 1.07724494248313, 10.3383333333333, 
    6624108.14301116, 6488063.75248891, 5698236.33664519, 3851780.621818, 
    392306.260684762, 691931.593994635, 675798.843226555, 591610.389222623, 
    396245.636519271, 41964.3878720295, 8.074675968873, 8.05940780149058, 
    7.00881083237119, 4.77785199309853, 0.46930176982302, 0.185379775709354, 
    3288271.71441901, 3288271.71441901, 2616499.35842912, 1620545.11061402, 
    276903.218262934, 308398.799469652, 308398.799469652, 245417.008052878, 
    151940.24468011, 25946.3987740724, 72.4535243987641, 74.4760002884039, 
    57.6569273661542, 35.6960086875041, 6.09570478182848, 10.4363636363636, 
    2741790.68377683, 2741790.68377683, 2172257.12648271, 1371571.69376414, 
    241551.85922975, 256474.219835878, 256474.219835878, 203210.04974162, 
    128277.637178125, 22584.9889935499, 7.71097539976315, 8.22152734486148, 
    5.86003466953577, 4.4339512737365, 0.995756610880111, 0.155339571388783, 
    574409.82901765, 574409.82901765, 452974.271323369, 256774.709326448, 
    38284.2685980138, 54705.6980016809, 54705.6980016809, 43140.4067927018, 
    24454.7342215665, 3646.12081885845, 33.9590861172372, 34.3471597755634, 
    26.7798208033282, 15.180510545333, 2.26336442828425, 10.4, 
    574409.82901765, 574409.82901765, 452974.271323369, 256774.709326448, 
    38284.2685980138, 54705.6980016809, 54705.6980016809, 43140.4067927018, 
    24454.7342215665, 3646.12081885845, 1.22819016987644e-07, 
    NaN, 4.75705293983453e-07, 1.70943285511227e-07, NaN, 0.0710669054518391, 
    11448726.6061251, 11448726.6061251, 9927376.45409594, 6937177.01562801, 
    724172.320593143, 1106572.44530414, 1106572.44530414, 960706.528106754, 
    672133.893070651, 69645.419500295, 28.0407075890654, 28.6378553221123, 
    24.3444439158647, 17.0319711432126, 1.76482511507759, 10.3607843137255, 
    4824031.67636305, 4824031.67636305, 4182681.40857481, 2936981.96169443, 
    319963.077714357, 464621.442663565, 464621.442663565, 403882.356765614, 
    284006.816763047, 30418.0022988892, 9.28110849865813, 9.52313049184992, 
    7.99021761260502, 5.56465462143434, 0.644527215303013, 0.150610963646878, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    117821.379340104, 123052.920608688, 123052.920608688, 97308.0161224128, 
    62485.8206726489, 11011.3438635611, 44.6678852217276, 45.762303441233, 
    35.3225528805782, 22.6821878910713, 3.99708874361976, 10.4363636363636, 
    1316666.25051296, 1316666.25051296, 1041195.77250982, 668598.281197344, 
    117821.379340104, 123052.920608688, 123052.920608688, 97308.0161224128, 
    62485.8206726489, 11011.3438635611, 26.5306835300096, 27.4720880065798, 
    20.9799829854224, 13.4721835546741, 2.37408813898259, 0.155339571388783, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10.5, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.91771055403855e-07, 
    6723079.35345837, 6723079.35345837, 5678171.86000741, 4182982.52884115, 
    461060.354163779, 623646.726436967, 623646.726436967, 526657.653853672, 
    387891.769528557, 42792.7304213088, 21.0911899998696, 21.4585721363328, 
    17.8111039013624, 13.1181623565201, 1.44721293268946, 10.5457142857143, 
    5551495.81216955, 5551495.81216955, 4742162.00916957, 3570777.42056449, 
    361770.484702407, 514287.608987023, 514287.608987023, 439278.884033358, 
    330730.610091939, 33529.6348259428, 16.0854770049392, 16.4165628478359, 
    13.7393378427446, 10.3462538821149, 1.05001447012503, 0.164298155380745
    ), .Dim = c(16L, 2L, 3L, 9L, 2L)))
  result[["Log"]] <- NULL
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})



 
test_that("verbiss.bagr.fun", {
               result <- verbiss.bagr.fun(
                                          get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
                                          list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 2, get_design("a", 3)
                                          )
               reference <- list(Log = list(Datum = structure(1524131675.53322, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 
    HBF = 223446.75, se.HBF = 42845.6895644946, BAGR = c("FI", 
    "TA", "DGL", "KI", "LAE", "BU", "EI", "ALH", "ALN"), m.Verbissproz.BAGR = structure(c(99.4285714279395, 
    0.57142857206048, 0, 0.57142857206048, 0.531705263673321, 
    0.531705263672822, 0, 0.531705263672822, 8.33333332286136, 
    33.3333333333333, 58.3333333438053, 91.6666666771386, 6.83841615692508, 
    27.3536646620739, 24.6562601301221, 6.83841615692512, NaN, 
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 
    NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 74.6031746012908, 
    25.3968253987092, 0, 25.3968253987092, 13.1482542606987, 
    13.1482542606987, 0, 13.1482542606987, 12.5, 62.5, 25, 87.5, 
    10.8798534972311, 20.8333333333333, 21.7597069944622, 10.8798534972311, 
    13.5416666806293, 82.2916666439774, 4.16666667539331, 86.4583333193707, 
    7.74645909782772, 8.92951084509363, 3.62661784000594, 7.74645909782769, 
    16.6666666666667, 83.3333333333333, 0, 83.3333333333333, 
    11.8444842419784, 11.8444842419784, 0, 11.8444842419784, 
    60.9784659775416, 30.6286768746934, 8.39285714776508, 39.0215340224584, 
    9.53750442291882, 9.00821335672713, 4.01083641996292, 9.53750442291881
    ), .Dim = c(4L, 2L, 10L)))
               result[["Log"]] <- NULL
               result[["Log"]] <- NULL
               reference[["Log"]] <- NULL
               testthat::expect_equal(result, reference)


})

test_that("verbiss.bagrupp.fun", {
  result <- verbiss.bagrupp.fun(
    get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
    list(
      bagr.lab = c(
        "Fi/sNB", "Ta", "Dgl/Ki/Lae", "Bu", "Ei", "Es", "Ah",
        "sBLb", "WLb"
      ),
      ba.grupp = list(
        c(10:19, 90:99), c(30:39), c(20:29, 40, 50, 51), c(100),
        c(110, 111), c(120), c(140:144), c(112, 130, 150:199),
        c(200:299)
      )
    ),
    list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
  )
  reference <- list(Log = list(Datum = structure(1524131796.58253, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1), HBF = 902724.87, 
    se.HBF = 23749.5302613181, BAGR = c("Fi/sNB", "Ta", "Dgl/Ki/Lae", 
    "Bu", "Ei", "Es", "Ah", "sBLb", "WLb"), m.Verbissproz.BAGR = structure(c(94.7296351827845, 
    5.2703648172155, 0, 5.2703648172155, 4.10630139874941, 4.1063013987494, 
    0, 4.1063013987494, 58.3333333285337, 16.5674603217791, 25.0992063496872, 
    41.6666666714663, 11.8855397703512, 9.06224900597043, 9.73599453628848, 
    11.8855397703511, 100, 0, 0, 0, 0, 0, 0, 0, 82.2239028016804, 
    17.7760971983196, 0, 17.7760971983196, 5.72055697993913, 
    5.72055697993913, 0, 5.72055697993913, 50, 38.8888888888889, 
    11.1111111111111, 50, 15.7926456559711, 15.3476928520509, 
    10.5284304373141, 15.7926456559711, 60.3827751224016, 33.0622009548017, 
    6.55502392279671, 39.6172248775984, 9.75303813909605, 9.29260233129525, 
    5.18395016100723, 9.75303813909605, 51.6791600728808, 41.6971737454302, 
    6.62366618168899, 48.3208399271192, 9.5282514621596, 9.62674091472529, 
    3.19588818055081, 9.5282514621596, 64.2857142850731, 23.2142857149269, 
    12.5, 35.7142857149269, 16.4487923742403, 14.3436550476355, 
    11.7515848920368, 16.4487923742403, 70.68181818583, 28.668831164671, 
    0.649350649499013, 29.31818181417, 9.58123656595675, 9.52279303998682, 
    0.628882254632839, 9.58123656595674, 72.9678364766549, 21.2721492266094, 
    5.76001429673574, 27.0321635233451, 4.03938679611307, 3.64077373875554, 
    1.98442404860728, 4.03938679611307), .Dim = c(4L, 2L, 10L
    )))
  # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

})

test_that("verjg.bagr.fun", {
  result <- verjg.bagr.fun(
    get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
    list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 2, get_design("a", 3)
  )
  reference <- list(Log = list(Datum = structure(1524131849.61287, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1, EigArt = "StW"), 
    HBF = 223446.75, se.HBF = 42845.6895644946, BAGR = c("FI", 
    "TA", "DGL", "KI", "LAE", "BU", "EI", "ALH", "ALN"), n.Verjg.BAGR = structure(c(569002428.982486, 
    42.1052628734979, 276670235.889281, 13.1201771817822, 42675182.6907422, 
    3.15789475377364, 30023120.6726591, 2.11416868146277, 14225060.9207484, 
    1.05263158635491, 14225060.9207484, 1.08986476286475, 0, 
    0, 0, 0, 0, 0, 0, 0, 334288930.886806, 24.7368422237839, 
    138041145.917147, 8.84377615231753, 71125304.4249846, 5.26315791854681, 
    32757910.2128228, 2.36069372980017, 256051096.001448, 18.9473685120596, 
    131623068.335656, 8.76438595731755, 64012774.0539891, 4.73684213198323, 
    33673262.2389912, 2.11761207377883, 1351380777.9612, 100, 
    390944172.335699, 0), .Dim = c(2L, 2L, 10L)))

  # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("verjg.bagrupp.fun", {
  result <- verjg.bagrupp.fun(
    get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
    list(
      bagr.lab = c(
        "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es", "Ah",
        "sBLb", "WLb"
      ),
      ba.grupp = list(
        c(10), c(30), c(11:19, 20:29, 31:39, 40, 50, 51, 90:99), c(100),
        c(110, 111), c(120), c(140:144), c(112, 130, 150:199),
        c(200:299)
      )
    ),
    list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
  )
  reference <- list(Log = list(Datum = structure(1524131906.64083, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1), HBF = 902724.87, 
    se.HBF = 23749.5302613181, BAGR = c("Fi", "Ta", "Dgl/Ki/La/sNB", 
    "Bu", "Ei", "Es", "Ah", "sBLb", "WLb"), n.Verjg.BAGR = structure(c(1913270680.3981, 
    20.3018866672957, 588661862.279751, 6.18922892555576, 320063870.055437, 
    3.39622641100081, 118488278.995953, 1.35786389626359, 85350365.417236, 
    0.905660377000316, 32412915.4843194, 0.387981484210826, 2340022524.44836, 
    24.8301887323046, 848778524.506043, 7.55875744986596, 440976887.256147, 
    4.67924527339137, 287676947.389454, 2.99890450969405, 1266030421.57122, 
    13.4339622717363, 492830705.658388, 4.57682078723699, 2119534082.16097, 
    22.490566109835, 824140121.287359, 7.13107565656234, 227600974.088448, 
    2.41509433487389, 91476692.928936, 0.910628756658204, 711253046.484313, 
    7.54716982256204, 254545937.900883, 2.76835716877179, 9424102851.88023, 
    100, 1511041838.20528, 0), .Dim = c(2L, 2L, 10L)))

  # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("verjg.kl4.bagr.fun", {
  bagr.vj <- list(
    bagr.lab = c(
      "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es",
      "Ah", "sBLb", "Bi", "Er/Pa/Wei", "sWLb"
    ),
    ba.grupp = list(
      c(10:19), c(30:39), c(20:29, 40, 50, 51, 90:99),
      c(100), c(110, 111), c(120), c(140:144),
      c(112, 130, 150:199), c(200, 201), c(210:224, 240),
      c(230, 250:299)
    )
  )

  result <- verjg.kl4.bagr.fun(
    verj.kl4 = get_data("verj.kl4m.3"), ecken = get_data("ecken.3"), 
    trakte = get_data("trakte.3"),
    auswahl = list(Wa = c(3, 5), Begehbar = 1), A= get_design("a", 3), 
    bacode = get_data("bacode")
    )
  reference <- list(Log = list(Datum = structure(1524134062.93953, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1), HBF = 902724.87, 
    se.HBF = 23749.5302613181, BAGR = c("FI", "TA", "DGL", "KI", 
    "LAE", "BU", "EI", "ALH", "ALN"), VjgArt = c("Naturverjüngung", 
    "Pflanzung", "Saat", "Stockausschlag", "nicht zuzuordnen"
    ), Verjg.kl4m.BAF.VArt.BAGR = structure(c(58274.9124, 14181.3065993142, 
    1966.3314, 1522.22345226895, 0, 0, 0, 0, 0, 0, 60241.2438, 
    14181.3862598902, 17160.7104, 5690.76294876649, 6435.2664, 
    4777.14500586999, 0, 0, 0, 0, 0, 0, 23595.9768, 7278.38667826454, 
    4647.6924, 2681.30081164771, 8312.2191, 6212.18498711475, 
    0, 0, 0, 0, 0, 0, 12959.9115, 6708.21578608444, 5273.3433, 
    4431.93796976931, 0, 0, 0, 0, 0, 0, 0, 0, 5273.3433, 4431.93796976931, 
    0, 0, 715.0296, 715.0296, 0, 0, 0, 0, 0, 0, 715.0296, 715.0296, 
    83747.8419, 17948.1143712783, 1340.6805, 855.735902360214, 
    0, 0, 1787.574, 1787.574, 0, 0, 86876.0964, 17908.6984819562, 
    4826.4498, 2494.01210867448, 9116.6274, 6109.6646466227, 
    0, 0, 0, 0, 0, 0, 13943.0772, 6531.40034930358, 103143.0198, 
    20257.7460329441, 6614.0238, 3565.2484682627, 0, 0, 0, 0, 
    0, 0, 109757.0436, 20231.3036401646, 15194.379, 4740.55332385256, 
    3038.8758, 2230.29259377725, 0, 0, 0, 0, 0, 0, 18233.2548, 
    5149.19859888613, 292268.349, 31372.1821972904, 37539.054, 
    14770.2435042169, 0, 0, 1787.574, 1787.574, 0, 0, 331594.977, 
    31177.1249187457), .Dim = c(2L, 6L, 10L)))

   # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})
test_that("verjg.kl4.bagrupp.fun", {
  bagr.vj <- list(
    bagr.lab = c(
      "Fi", "Ta", "Dgl/Ki/La/sNB", "Bu", "Ei", "Es",
      "Ah", "sBLb", "Bi", "Er/Pa/Wei", "sWLb"
    ),
    ba.grupp = list(
      c(10:19), c(30:39), c(20:29, 40, 50, 51, 90:99),
      c(100), c(110, 111), c(120), c(140:144),
      c(112, 130, 150:199), c(200, 201), c(210:224, 240),
      c(230, 250:299)
    )
  )

  result <- verjg.kl4.bagrupp.fun(
    get_data("verj.kl4m.3"), get_data("ecken.3"), get_data("trakte.3"),
    bagr.vj, list(Wa = c(3, 5), Begehbar = 1), get_design("a", 3)
  )
  reference <- list(Log = list(Datum = structure(1524134440.10349, class = c("POSIXct", 
"POSIXt"))), Stratum = list(Wa = c(3, 5), Begehbar = 1), HBF = 902724.87, 
    se.HBF = 23749.5302613181, BAGR = c("Fi", "Ta", "Dgl/Ki/La/sNB", 
    "Bu", "Ei", "Es", "Ah", "sBLb", "Bi", "Er/Pa/Wei", "sWLb"
    ), VjgArt = c("Naturverjüngung", "Pflanzung", "Saat", "Stockausschlag", 
    "nicht zuzuordnen"), Verjg.kl4m.BAF.VArt.BAGR = structure(c(57559.8828, 
    13972.5611374545, 1966.3314, 1522.22345226895, 0, 0, 0, 0, 
    0, 0, 59526.2142, 13973.6583566668, 17160.7104, 5690.76294876649, 
    6435.2664, 4777.14500586999, 0, 0, 0, 0, 0, 0, 23595.9768, 
    7278.38667826454, 10636.0653, 5266.60613758254, 9027.2487, 
    6243.59185769465, 0, 0, 0, 0, 0, 0, 19663.314, 8048.59580989215, 
    83747.8419, 17948.1143712783, 1340.6805, 855.735902360214, 
    0, 0, 1787.574, 1787.574, 0, 0, 86876.0964, 17908.6984819562, 
    4379.5563, 2108.57131823035, 9116.6274, 6109.6646466227, 
    0, 0, 0, 0, 0, 0, 13496.1837, 6400.58383447995, 35215.2078, 
    10416.1488112416, 2860.1184, 2860.1184, 0, 0, 0, 0, 0, 0, 
    38075.3262, 10707.0860946081, 44778.7287, 13589.1345837447, 
    0, 0, 0, 0, 0, 0, 0, 0, 44778.7287, 13589.1345837447, 23595.9768, 
    7636.54060879109, 3753.9054, 2178.903547537, 0, 0, 0, 0, 
    0, 0, 27349.8822, 7827.83095679244, 9116.6274, 4192.19413438114, 
    1430.0592, 1430.0592, 0, 0, 0, 0, 0, 0, 10546.6866, 4399.56598276765, 
    625.6509, 444.721465270415, 715.0296, 715.0296, 0, 0, 0, 
    0, 0, 0, 1340.6805, 836.664183980143, 5452.1007, 1675.23208247176, 
    893.787, 641.507184193528, 0, 0, 0, 0, 0, 0, 6345.8877, 1766.20757985115, 
    292268.349, 31372.1821972904, 37539.054, 14770.2435042169, 
    0, 0, 1787.574, 1787.574, 0, 0, 331594.977, 31177.1249187457
    ), .Dim = c(2L, 6L, 12L)))

  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("ntns.stratum.fun", {
  result <- ntns.stratum.fun(
    get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), list(
      Wa = c(3, 5), Begehbar = 1,
      WLT = c(9410)
    ), 3, 3
  )
  reference <- list(Datum = structure(1524132089.86945, class = c("POSIXct", 
"POSIXt")), HBF = 8937.87, se.HBF = 8937.87, NTNS = c("sehr naturnah", 
"naturnah", "bedingt naturnah", "kulturbetont", "kulturbestimmt", 
"keine Angabe"), NTNS.Flaeche.Anteil = structure(c(0, 0, 0, 0, 
8937.87, 100, 8937.87, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0), .Dim = c(2L, 2L, 6L)))
  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)

  result <- ntns.stratum.fun(
    get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), list(
      Wa = c(3, 5), Begehbar = 1,
      WLT = c(9410)
    ), bwi = 2, 3
  )
  reference <- list(Datum = structure(1524137112.90263, class = c("POSIXct", 
"POSIXt")), HBF = 8937.87, se.HBF = 8937.87, NTNS = c("sehr naturnah", 
"naturnah", "bedingt naturnah", "kulturbetont", "kulturbestimmt", 
"keine Angabe"), NTNS.Flaeche.Anteil = structure(c(0, 0, 0, 0, 
8937.87, 100, 8937.87, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0), .Dim = c(2L, 2L, 6L)))
  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)


  result <- ntns.stratum.fun(
    get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3), list(
      Wa = c(3, 5), Begehbar = 1,
      WLT = c(9410)
    ), bwi = 2, natwg = 2
  )
  reference <- list(Datum = structure(1524137410.62393, class = c("POSIXct", 
"POSIXt")), HBF = 8937.87, se.HBF = 8937.87, NTNS = c("sehr naturnah", 
"naturnah", "bedingt naturnah", "kulturbetont", "kulturbestimmt", 
"keine Angabe"), NTNS.Flaeche.Anteil = structure(c(0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8937.87, 100, 8937.87, 0, 
0, 0, 0, 0), .Dim = c(2L, 2L, 6L)))
  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)

})

test_that("ntns.stratum.fun.2", {
  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), 3, 3,
    schicht = 1
  )
  reference <- list(Datum = structure(1524132147.05436, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 3 Schicht < 4m", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(223446.75, 
    23.7113402061856, 42845.6895644946, 4.49524243895616, 232384.62, 
    26.8041237113402, 39402.0638262981, 4.55402341460267, 205571.01, 
    23.7113402061856, 37802.9521804859, 4.36787355562883, 26813.61, 
    2.06185567010309, 15323.6749422499, 1.43540269902528, 53627.22, 
    5.15463917525773, 21333.1991845241, 2.23423043145531, 160881.66, 
    18.5567010309278, 34511.1645998951, 3.98570678296389), .Dim = c(2L, 
    2L, 6L)))

  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)

  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), 3, 3,
    schicht = 2
  )
  reference <- list(Datum = structure(1524137217.90121, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 3 Schicht > 4m", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(178757.4, 
    19.5876288659794, 35931.5893514834, 4.01823718784089, 268136.1, 
    28.8659793814433, 41164.8070108105, 4.52776595359339, 259198.23, 
    29.8969072164948, 40760.9793056835, 4.71263611404902, 26813.61, 
    3.09278350515464, 15323.6749422499, 1.76780741132599, 125130.18, 
    13.4020618556701, 31169.4888115932, 3.44602483647758, 44689.35, 
    5.15463917525773, 19577.7708579898, 2.25886268710105), .Dim = c(2L, 
    2L, 6L)))
  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)


  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), bwi = 2, natwg = 3,
    schicht = 1
  )
  reference <- list(Datum = structure(1524137545.44201, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 2 Schicht < 4 m mit nat. WG der BWI 3", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(134068.05, 
    13.4020618556701, 36764.0918119934, 3.70599885073797, 160881.66, 
    18.5567010309278, 34511.1645998951, 3.98570678296389, 205571.01, 
    23.7113402061856, 37802.9521804859, 4.36787355562883, 8937.87, 
    1.03092783505155, 8937.87, 1.03098815117209, 35751.48, 3.09278350515464, 
    17602.8119116712, 1.7489248218655, 357514.8, 40.2061855670103, 
    44007.029779178, 4.98654148436969), .Dim = c(2L, 2L, 6L)))
  # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)

  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), bwi = 2, natwg = 3,
    schicht = 2
  )
  reference <- list(Datum = structure(1524137893.62529, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 2 Schicht > 4 m mit nat. WG der BWI 3", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(134068.05, 
    14.4329896907216, 32075.3592096764, 3.55527774972206, 259198.23, 
    27.8350515463918, 40760.9793056835, 4.47828068685861, 250260.36, 
    28.8659793814433, 40333.1090146517, 4.66264139044455, 71502.96, 
    8.24742268041237, 24369.9895799911, 2.81234250804433, 134068.05, 
    14.4329896907216, 32075.3592096764, 3.55527774972206, 53627.22, 
    6.18556701030928, 21333.1991845241, 2.46156172113968), .Dim = c(2L, 
    2L, 6L)))
      # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)




  ##########
  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), bwi = 2, natwg = 2, schicht = 1)
  reference <- list(Datum = structure(1524138075.95694, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 2 Schicht < 4 m mit nat. WG der BWI 2", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(134068.05, 
    13.4020618556701, 36764.0918119934, 3.70599885073797, 169819.53, 
    19.5876288659794, 35239.9875443816, 4.07023281489224, 187695.27, 
    21.6494845360825, 36588.0807863359, 4.22670104487121, 8937.87, 
    1.03092783505155, 8937.87, 1.03098815117209, 44689.35, 4.12371134020619, 
    19577.7708579898, 2.00894821652888, 357514.8, 40.2061855670103, 
    44007.029779178, 4.98654148436969), .Dim = c(2L, 2L, 6L)))
      # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)

  result <- ntns.stratum.fun.2(get_data("ntns.te"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(3, 5), Begehbar = 1), bwi = 2, natwg = 2, schicht = 2)
  reference <-
result <-
list(Datum = structure(1524138176.72712, class = c("POSIXct", 
"POSIXt")), HBF = 902724.87, se.HBF = 23749.5302613181, NTNS_Kollektiv = "BWI 2 Schicht > 4 m mit nat. WG der BWI 2", 
    NTNS = c("sehr naturnah", "naturnah", "bedingt naturnah", 
    "kulturbetont", "kulturbestimmt", "keine Angabe"), NTNS.Flaeche.Anteil = structure(c(151943.79, 
    16.4948453608247, 33742.7087392563, 3.7558166389925, 250260.36, 
    26.8041237113402, 40333.1090146517, 4.42584557684192, 232384.62, 
    26.8041237113402, 39402.0638262981, 4.55402341460267, 80440.83, 
    9.27835051546392, 25707.4137386968, 2.96688880653172, 134068.05, 
    14.4329896907216, 32075.3592096764, 3.55527774972206, 53627.22, 
    6.18556701030928, 21333.1991845241, 2.46156172113968), .Dim = c(2L, 
    2L, 6L)))
      # clean Log items
  result[["Datum"]] <- NULL
  reference[["Datum"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fba.stratum.fun", {
  result <- fba.stratum.fun(
    "alle", get_data("fba.3"), list(Wa = c(3, 5), Begehbar = 1),
    get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3)
  )
  reference <- list(Stratum = list(Wa = c(3, 5), Begehbar = 1), HBF = 902724.87, 
    se.HBF = 23749.5302613181, FBA = c("Adlerfarn", "Brennessel", 
    "Riedgras", "Honiggras", "Reitgras", "Heidekraut", "Heidelbeere", 
    "Brombeere", "Riesenbärenklau", "Riesenknöterich", "Drüsiges Springkraut", 
    "Kleinblütiges Springkraut", "Kermesbeere"), Dichtestufen = c("nicht vorhanden", 
    "selten, bis 10%", "häufig, > 10 bis 50%", "flächig, > 50%"
    ), FBA.Dichtevertlg = structure(c(0.9588, 0.02031, 0.0309, 
    0.01768, 0.0103, 0.01031, 0, 0, 0.732, 0.0449, 0.1856, 0.03935, 
    0.0722, 0.02645, 0.0103, 0.01031, 0.9072, 0.02967, 0.0206, 
    0.01451, 0.0309, 0.01768, 0.0412, 0.02031, 0.9897, 0.01031, 
    0, 0, 0.0103, 0.01031, 0, 0, 0.9381, 0.02434, 0.0412, 0.02031, 
    0.0103, 0.0102, 0.0103, 0.01031, 0.9794, 0.01451, 0.0103, 
    0.01031, 0, 0, 0.0103, 0.01031, 0.7732, 0.04299, 0.1031, 
    0.0311, 0.0825, 0.02812, 0.0412, 0.02031, 0.4021, 0.04987, 
    0.299, 0.04644, 0.1856, 0.04152, 0.1134, 0.03244, 1, 0, 0, 
    0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0.9897, 0.01031, 0.0103, 
    0.01031, 0, 0, 0, 0, 0.9485, 0.02259, 0.0309, 0.01768, 0.0103, 
    0.01031, 0.0103, 0.01031, 0.9897, 0.01031, 0.0103, 0.01031, 
    0, 0, 0, 0), .Dim = c(2L, 4L, 13L)), FBA.Fläche = structure(c(4022, 
    2775.63, 32515.8, 8899.3, 30578.4, 11576.96, 2681.4, 2681.36, 
    13406.8, 7283.91, 4915.8, 4486.73, 49117.7, 13209.95, 132726.4, 
    20168.71, 0, 0, 0, 0, 446.9, 446.89, 10237.9, 6805.37, 446.9, 
    446.89, 0.0046, 0.0032, 0.037, 0.0103, 0.0353, 0.0134, 0.0031, 
    0.0031, 0.0124, 0.0078, 0.0057, 0.0052, 0.0567, 0.0152, 0.1464, 
    0.0225, 0, 0, 0, 0, 5e-04, 5e-04, 0.0118, 0.0079, 5e-04, 
    5e-04), .Dim = c(2L, 13L, 2L)))

  testthat::expect_equal(result, reference)
})
test_that("biotop.baeume.fun", {
  result <- biotop.baeume.fun(
    get_data("wzp4.merkmale.3"), get_data("baeume.3"), get_data("ecken.3"), get_data("trakte.3"), get_design("a", 3),
    list(Wa = c(5), Begehbar = 1)
  )
  reference <- list(Log = list(Datum = structure(1524138926.72354, class = c("POSIXct", 
"POSIXt")), Version.baeume.b = NA_character_), Stratum = list(
    Wa = 5, Begehbar = 1), nTE = 97L, HBF = 902724.87, se.HBF = 23749.5302613181, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Biotopbaumkennwerte = structure(list(Attribute = structure(c(1L, 
    11L, 8L, 7L, 4L, 5L, 6L, 9L, 10L, 2L, 3L), .Label = c("Gesamtzahl", 
    "oi_Biom_t", "oi_Biom_t_je_ha", "Stueckvolumen_m3", "Vorrat_LB_m3", 
    "Vorrat_LB_m3_je_ha", "Vorrat_m3_je_ha", "Vorrat_m3_mR", 
    "Vorrat_NB_m3", "Vorrat_NB_m3_je_ha", "Zahl_je_ha"), class = "factor"), 
        Wert = c(4183653.4376956, 4.63447233673267, 12570792.9057349, 
        13.9253867080618, 3.00474049606245, 11447741.2267996, 
        12.6813180928533, 1123051.67893524, 1.24406861520858, 
        7483862.81468777, 8.29030312933305), SE = c(1198004.54850135, 
        1.31275682428163, 3661124.58475695, 3.94330443460432, 
        0.670200517435292, 3610453.77274485, 3.89406034062188, 
        792579.417860472, 0.878771581458272, 2189670.61088702, 
        2.35617553805427)), class = "data.frame", row.names = c(NA, 
    -11L)))
      # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)

})

test_that("stamm.merkmale.bagr.fun", {
  result <- stamm.merkmale.bagr.fun(
    wzp4.merkmale = get_data("wzp4.merkmale.3"), 
    baeume = get_data("baeume.3"), 
    ecken = get_data("ecken.3"),
    trakte = get_data("trakte.3"), 
    trakte.3 = get_data("trakte.3"), 
    A = get_design("a", 3), 
    auswahl = list(Wa = c(3, 5), Begehbar = 1), 
    merkmale = c("tot", "jschael", "aeschael", "ruecke", "pilz", "harz", 
                 "kaefer", "sstamm", "faulkon", "hoehle", "bizarr", "uralt", 
                 "horst", "mbiotop", "Ast"),
    ba.grupp = list(
      bagr.lab = c("FiTa", "DglKiLae", "Bu", "Ei", "BLb", "WLb"),
      ba.grupp = list(
        c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51), c(100),
        c(110, 111), c(112:199), c(200:299)
      )
    )
  )

  reference  <- structure(list(Stratum = structure(list(Wa = c(3, 5), Begehbar = 1), .Names = c("Wa", 
"Begehbar")), nTE = 97L, HBF = 902724.87, se.HBF = 23749.5302613181, 
    BL = 0, se.BL = 0, iBL = 0, se.iBL = 0, LK = 1, se.LK = 0, 
    Merkmale = c("tot", "jschael", "aeschael", "ruecke", "pilz", 
    "harz", "kaefer", "sstamm", "faulkon", "hoehle", "bizarr", 
    "uralt", "horst", "mbiotop", "Ast"), BAGR = c("FiTa", "DglKiLae", 
    "Bu", "Ei", "BLb", "WLb", "Alle BA"), Kennwerte = c("Gesamtzahl", 
    "Zahl_je_ha", "Vorrat_m3_mR", "Vorrat_m3_mR_je_ha", "Stueckvolumen_m3_mR", 
    "oi_Biom_t", "oi_Biom_t_je_ha", "Anteil_Gesamtzahl_Proz", 
    "Anteil_Gesamtvorrat_Proz"), Kennwert_Tabelle_BAGR = structure(c(90066395.8185684, 
    99.7717010040594, 56330529.5536398, 62.4005512927098, 0.625433371033445, 
    26102470.3670392, 28.9152002282148, 31.8978191146094, 30.2906487637712, 
    22386647.518274, 23.7442857188446, 9161176.51469068, 9.83030500060655, 
    0.12419065420543, 4250750.10127602, 4.54957696800952, 5.59056315603334, 
    3.40903622753805, 2796371.38403632, 3.0977006139604, 6550498.46619459, 
    7.25636202555779, 2.34249946326497, 3423951.68619041, 3.79290723007377, 
    10.2784568509959, 42.0660595824338, 923750.085106156, 1.02746540346984, 
    2144333.417495, 2.38526856085782, 0.439321079834722, 1135209.50288889, 
    1.26262939745272, 5.45530124854267, 7.79311769268705, 31221822.5520047, 
    34.5861996158416, 32376547.3695936, 35.86535437934, 1.03698454232342, 
    22534366.7183404, 24.9626076196841, 25.6038371282509, 44.2830892685505, 
    7671004.55159941, 8.3270150990078, 6893502.21564437, 7.42006090489805, 
    0.237210459315093, 4761721.5545936, 5.12464780193712, 4.31388203856272, 
    4.94303463527091, 3119876.75147604, 3.45606602316832, 10798956.3075092, 
    11.9626219088317, 3.46134067712777, 6293107.393015, 6.97123520371717, 
    7.7627068723688, 35.0375432008279, 1324927.94876988, 1.44358854666675, 
    4868055.073319, 5.29216733433787, 0.738609534076845, 2836762.10486871, 
    3.08415635259322, 4.94387632686263, 7.02030098030468, 17865143.1728431, 
    19.7902414861386, 10706758.2727913, 11.8604888694285, 0.599309961818091, 
    7192761.76888697, 7.96783384165208, 13.8623886018391, 27.2341576673462, 
    7946222.59016682, 8.82231104808785, 4785862.38527169, 5.31339680251266, 
    0.251291541602665, 3200656.63669555, 3.55352910006562, 5.7769569826445, 
    6.03569589448172, 2826488.77838208, 3.13106337524752, 3472758.3412675, 
    3.84697315502951, 1.22864748936147, 1754864.92204677, 1.94396430226496, 
    14.0743579857108, 56.4021859168551, 1710771.59079763, 1.89742581076188, 
    2339551.68824887, 2.59420133054802, 0.8576048701095, 1133773.9561211, 
    1.25728779465141, 10.4178566432934, 11.9144835284346, 147896098.457311, 
    163.832972118416, 120236048.310996, 133.192351630897, 0.812976471760691, 
    67301522.8555187, 74.553748425607, 23.8290253838451, 34.2608210690134, 
    23743317.0368748, 24.3843221002909, 12751051.8645837, 12.8312177992552, 
    0.119800440523324, 7437441.4861657, 7.51291384889697, 3.46048304964746, 
    2.59134914732459), .Dim = c(9L, 2L, 7L))), .Names = c("Stratum", 
"nTE", "HBF", "se.HBF", "BL", "se.BL", "iBL", "se.iBL", "LK", 
"se.LK", "Merkmale", "BAGR", "Kennwerte", "Kennwert_Tabelle_BAGR"
))

      # clean Log items
  result[["Log"]] <- NULL
  reference[["Log"]] <- NULL
  testthat::expect_equal(result, reference)
})

test_that("fl.stratum.fun", {
  result <- fl.stratum.fun(
    list(Wa = c(3, 4, 5), Kreis = 317), get_data("ecken.3"),
    get_data("trakte.3"), get_design("a", 3)
  )

  reference <- 
structure(list(Flaeche = 80440.83, SE_Flaeche = 25707.4137386968), .Names = c("Flaeche", 
"SE_Flaeche"))
      testthat::expect_equal(result, reference)
})
#  
#  test_that("fl.proz.stratum.fun", {
#    stratum <- list(Wa = c(3:5), Kreis = 317)
#    substratum <- list(EigArt2 = "MPW")
#  
#    result <- fl.proz.stratum.fun(stratum, substratum, get_data("ecken.3"))
#  
#    reference <- structure(list(
#      Fl_Proz = 41.6965352449223,
#      SE_Fl_Proz = 2.86767974355858
#    ), .Names = c("Fl_Proz", "SE_Fl_Proz"))
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("stratum.fun", {
#    result <- stratum.fun(list(Wa = c(1:5), EigArt = "BW"), get_data("ecken.3"))
#  
#    reference <-
#      structure(list(
#        TNr = c(
#          1985, 2180, 2180, 2329, 2747, 2747, 3610,
#          3855, 3855, 3855, 3855, 3856, 3999, 3999, 3999, 4000, 4000, 4000,
#          4001, 4001, 4001, 5778, 5882, 5882, 5882, 5882, 5884, 5884, 5884,
#          5885, 5885, 5885, 6030, 6077, 6136, 6136, 6136, 6136, 6137, 6139,
#          6153, 6377, 6377, 6377, 6377, 6754, 7113, 7674, 7674, 8362, 10711,
#          10711, 10711, 10711, 10857, 11801, 11934, 12878, 12878, 12928,
#          12928, 15157
#        ),
#        ENr = c(
#          4, 2, 3, 1, 3, 4, 1, 1, 2, 3, 4, 1, 1,
#          3, 4, 1, 2, 3, 1, 2, 4, 4, 1, 2, 3, 4, 1, 2, 4, 1, 3, 4, 4, 2,
#          1, 2, 3, 4, 3, 4, 2, 1, 2, 3, 4, 4, 3, 1, 3, 4, 1, 2, 3, 4, 3,
#          3, 1, 1, 2, 1, 4, 4
#        ), Wa = c(
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
#          5, 5, 4, 4, 5, 5, 5, 5, 5
#        ),
#        EigArt = c(
#          1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
#          1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
#        )
#      ),
#      .Names = c("TNr", "ENr", "Wa", "EigArt"),
#      row.names = c(NA, -62L), class = "data.frame"
#      )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("r.variance.fun", {
#    result <- r.variance.fun(
#      cbind(get_data("trakte.1")$m, get_data("trakte.1")$m_Wa),
#      length(get_data("trakte.1")[, 1])
#    )
#  
#    reference <- structure(list(
#      R.xy = 0.380382172733123,
#      V.R.xy = 2.02873178828728e-05
#    ), .Names = c("R.xy", "V.R.xy"))
#  
#    expect_equal(result, reference)
#  })
#  
#  
#  context("made up examples")
#  
#  
#  
#  
#  test_that("ba.klass.fun", {
#    result <- ba.klass.fun(100, list(
#      c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51),
#      c(100), c(110, 111), c(112, 120:199), c(200:299)
#    ))
#  
#    expect_equal(result, 3)
#  })
#  
#  test_that("ba.klass.lab.tab.fun", {
#    result <- ba.klass.lab.tab.fun(list(bagr.lab = c(
#      "FiTa", "DglKiLae", "Bu", "Ei",
#      "BLb", "WLb"
#    ), bacode = list(
#      c(10:19, 30:39, 90:99),
#      c(20:29, 40, 50, 51), c(100), c(110, 111), c(112:199), c(200:299)
#    )))
#  
#    reference <- structure(list(
#      ICode = structure(c(
#        10L, 11L, 12L, 13L, 14L, 15L,
#        16L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 27L, 29L, 30L, 31L,
#        32L, 33L, 34L, 35L, 36L, 39L, 40L, 50L, 51L, 90L, 91L, 92L, 93L,
#        94L, 95L, 99L, 100L, 110L, 111L, 112L, 113L, 114L, 120L, 121L,
#        130L, 140L, 141L, 142L, 143L, 144L, 150L, 160L, 170L, 180L, 181L,
#        190L, 191L, 192L, 193L, 194L, 195L, 196L, 199L, 200L, 201L, 210L,
#        211L, 212L, 213L, 220L, 221L, 222L, 223L, 224L, 230L, 240L, 250L,
#        251L, 252L, 290L, 291L, 292L, 293L, 294L, 295L, 296L, 299L, 998L,
#        999L
#      ), label = "ICode", class = c("labelled", "integer")),
#      bagr.nr = c(
#        1,
#        1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
#        1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 3, 4, 4, 5, 5, 5, 5, 5,
#        5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6,
#        6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,
#        6, NA, NA
#      ),
#      bagr = c(
#        "FiTa", "FiTa", "FiTa", "FiTa", "FiTa",
#        "FiTa", "FiTa", "FiTa", "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae",
#        "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae", "DglKiLae", "FiTa",
#        "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa", "DglKiLae",
#        "DglKiLae", "DglKiLae", "FiTa", "FiTa", "FiTa", "FiTa", "FiTa",
#        "FiTa", "FiTa", "Bu", "Ei", "Ei", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb", "BLb",
#        "BLb", "BLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb",
#        "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb",
#        "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", "WLb", NA, NA
#      )
#    ),
#    .Names = c("ICode", "bagr.nr", "bagr"),
#    row.names = c(NA, -88L), class = "data.frame"
#    )
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("dkl.lab.fun", {
#    result <- dkl.lab.fun(list(D.unt = 0, D.ob = 400, D.b = 400, Ndh = F), 5)
#  
#    reference <- c("0-399.9", "400-799.9", "800-1199.9", "1200-1599.9", ">=400")
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("akl.lab.fun", {
#    result <- akl.lab.fun(list(A.ob = 160, A.b = 20), 5)
#  
#    reference <- c("1-20", "21-40", "41-60", "61-80", ">160")
#  
#    expect_equal(result, reference)
#  })
#  
#  test_that("verjg.tab.fun", {
#    vj.tab <- verjg.bagrupp.fun(
#      get_data("verj.3"), get_data("ecken.3"), get_data("trakte.3"),
#      list(
#        bagr.lab = c("FiTa", "DglKiLae", "Bu", "Ei", "BLb", "WLb"),
#        bacode = list(
#          c(10:19, 30:39, 90:99), c(20:29, 40, 50, 51), c(100),
#          c(110, 111), c(112:199), c(200:299)
#        )
#      ),
#      list(Wa = c(3, 5), Begehbar = 1), 2, get_design("a", 3)
#    )
#  
#    result <- verjg.tab.fun(vj.tab)
#  
#    reference <- structure(list(
#      BAGR = structure(c(6L, 4L, 3L, 5L, 2L, 7L, 1L),
#        .Label = c(
#          "Alle",
#          "BLb", "Bu", "DglKiLae", "Ei", "FiTa", "WLb"
#        ), class = "factor"
#      ),
#      Stückzahl_Verj_Mio = c(
#        5163.795, 190.618, 5601.324, 429.646,
#        6839.543, 917.337, 19142.264
#      ), SE_Stückzahl_Verj_Mio = c(
#        215.931,
#        30.584, 197.399, 55.582, 248.897, 54.089, 443.47
#      ), Anteil_Proz = c(
#        27,
#        1, 29.3, 2.2, 35.7, 4.8, 100
#      ), SE_Anteil_Proz = c(
#        0.98, 0.16,
#        0.78, 0.28, 0.89, 0.28, 0
#      )
#    ), .Names = c(
#      "BAGR", "Stückzahl_Verj_Mio",
#      "SE_Stückzahl_Verj_Mio", "Anteil_Proz", "SE_Anteil_Proz"
#    ), row.names = c(
#      NA,
#      -7L
#    ), class = "data.frame")
#  
#    expect_equal(result, reference)
#  })
